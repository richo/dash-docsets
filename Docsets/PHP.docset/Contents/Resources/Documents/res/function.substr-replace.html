<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Replace text within a portion of a string</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.substr-count.html">substr_count</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.substr.html">substr</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.substr-replace" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">substr_replace</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">substr_replace</span> &mdash; <span class="dc-title">Replace text within a portion of a string</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.substr-replace-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <span class="methodname"><b>substr_replace</b></span>
    ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$string</tt></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$replacement</tt></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$start</tt></span>
   [, <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$length</tt></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><b>substr_replace()</b></span> replaces a copy of
   <i><tt class="parameter">string</tt></i> delimited by the
   <i><tt class="parameter">start</tt></i> and (optionally)
   <i><tt class="parameter">length</tt></i> parameters with the string given in
   <i><tt class="parameter">replacement</tt></i>. 
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.substr-replace-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">string</tt></i></span>
     <dd>

      <p class="para">
       The input string.
      </p>
      <p class="para">
       An <span class="type"><a href="language.types.array.html" class="type array">array</a></span> of <span class="type"><a href="language.types.string.html" class="type string">string</a></span>s can be provided, in which
       case the replacements will occur on each string in turn. In this case,
       the <i><tt class="parameter">replacement</tt></i>, <i><tt class="parameter">start</tt></i>
       and <i><tt class="parameter">length</tt></i> parameters may be provided either as
       scalar values to be applied to each input string in turn, or as
       <span class="type"><a href="language.types.array.html" class="type array">array</a></span>s, in which case the corresponding array element will
       be used for each input string.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">replacement</tt></i></span>
     <dd>

      <p class="para">
       The replacement string.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">start</tt></i></span>
     <dd>

      <p class="para">
       If <i><tt class="parameter">start</tt></i> is positive, the replacing will
       begin at the <i><tt class="parameter">start</tt></i>&#039;th offset into
       <i><tt class="parameter">string</tt></i>.
      </p>
      <p class="para">
       If <i><tt class="parameter">start</tt></i> is negative, the replacing will
       begin at the <i><tt class="parameter">start</tt></i>&#039;th character from the
       end of <i><tt class="parameter">string</tt></i>.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">length</tt></i></span>
     <dd>

      <p class="para">
       If given and is positive, it represents the length of the portion of
       <i><tt class="parameter">string</tt></i> which is to be replaced. If it is
       negative, it represents the number of characters from the end of
       <i><tt class="parameter">string</tt></i> at which to stop replacing. If it
       is not given, then it will default to strlen(
       <i><tt class="parameter">string</tt></i> ); i.e. end the replacing at the
       end of <i><tt class="parameter">string</tt></i>. Of course, if
       <i><tt class="parameter">length</tt></i> is zero then this function will have the
       effect of inserting <i><tt class="parameter">replacement</tt></i> into
       <i><tt class="parameter">string</tt></i> at the given
       <i><tt class="parameter">start</tt></i> offset.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.substr-replace-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   The result string is returned. If <i><tt class="parameter">string</tt></i> is an
   array then array is returned.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.substr-replace-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">4.3.3</td>
       <td align="left">
        All parameters now accept <span class="type"><a href="language.types.array.html" class="type array">array</a></span>s.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.substr-replace-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-4462">
    <p><b>Example #1 Simple <span class="function"><b>substr_replace()</b></span> examples</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'ABCDEFGH:/MNRPQR/'</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #DD0000">"Original:&nbsp;</span><span style="color: #0000BB">$var</span><span style="color: #DD0000">&lt;hr&nbsp;/&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;These&nbsp;two&nbsp;examples&nbsp;replace&nbsp;all&nbsp;of&nbsp;$var&nbsp;with&nbsp;'bob'.&nbsp;*/<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bob'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bob'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">))&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;Insert&nbsp;'bob'&nbsp;right&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;$var.&nbsp;*/<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bob'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;These&nbsp;next&nbsp;two&nbsp;replace&nbsp;'MNRPQR'&nbsp;in&nbsp;$var&nbsp;with&nbsp;'bob'.&nbsp;*/<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bob'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bob'</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">7</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;Delete&nbsp;'MNRPQR'&nbsp;from&nbsp;$var.&nbsp;*/<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-4463">
    <p><b>Example #2 
     Using <span class="function"><b>substr_replace()</b></span> to replace multiple strings at
     once
    </b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$input&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'A:&nbsp;XXX'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'B:&nbsp;XXX'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'C:&nbsp;XXX'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;A&nbsp;simple&nbsp;case:&nbsp;replace&nbsp;XXX&nbsp;in&nbsp;each&nbsp;string&nbsp;with&nbsp;YYY.<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">';&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$input</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'YYY'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">)).</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;A&nbsp;more&nbsp;complicated&nbsp;case&nbsp;where&nbsp;each&nbsp;replacement&nbsp;is&nbsp;different.<br /></span><span style="color: #0000BB">$replace&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'AAA'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'BBB'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'CCC'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">';&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$input</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replace</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">)).</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;Replace&nbsp;a&nbsp;different&nbsp;number&nbsp;of&nbsp;characters&nbsp;each&nbsp;time.<br /></span><span style="color: #0000BB">$length&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">';&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$input</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replace</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$length</span><span style="color: #007700">)).</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
A: YYY; B: YYY; C: YYY
A: AAA; B: BBB; C: CCC
A: AAAXX; B: BBBX; C: CCC
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.substr-replace-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">This function is
binary-safe.</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.substr-replace-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.str-replace.html" class="function" rel="rdfs-seeAlso">str_replace()</a> - Replace all occurrences of the search string with the replacement string</span></li>
    <li class="member"><span class="function"><a href="function.substr.html" class="function" rel="rdfs-seeAlso">substr()</a> - Return part of a string</span></li>
    <li class="member"><a href="language.types.string.html#language.types.string.substr" class="link">String access and modification by character</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="97401""></a>
  <div class="note">
   <strong class="user">elloromtz at gmail dot com</strong>
   <a href="#97401" class="date">17-Apr-2010 11:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's worth noting that when start and length are both negative -and- the length is less than or equal to start, the length will have the effect of being set as 0.<br />
<br />
<span class="default">&lt;?php<br />
substr_replace</span><span class="keyword">(</span><span class="string">'eggs'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">); </span><span class="comment">//eggxs<br />
</span><span class="default">substr_replace</span><span class="keyword">(</span><span class="string">'eggs'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,-</span><span class="default">2</span><span class="keyword">); </span><span class="comment">//eggxs<br />
</span><span class="default">substr_replace</span><span class="keyword">(</span><span class="string">'eggs'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,-</span><span class="default">2</span><span class="keyword">); </span><span class="comment">//eggxs<br />
</span><span class="default">?&gt;<br />
</span><br />
Same as: <br />
<span class="default">&lt;?php<br />
substr_replace</span><span class="keyword">(</span><span class="string">'eggs'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">); </span><span class="comment">//eggxs<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
substr_replace</span><span class="keyword">(</span><span class="string">'huevos'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,-</span><span class="default">2</span><span class="keyword">,-</span><span class="default">2</span><span class="keyword">); </span><span class="comment">//huevxos<br />
</span><span class="default">substr_replace</span><span class="keyword">(</span><span class="string">'huevos'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,-</span><span class="default">2</span><span class="keyword">,-</span><span class="default">3</span><span class="keyword">); </span><span class="comment">//huevxos<br />
</span><span class="default">substr_replace</span><span class="keyword">(</span><span class="string">'huevos'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,-</span><span class="default">2</span><span class="keyword">,-</span><span class="default">3</span><span class="keyword">); </span><span class="comment">//huevxos<br />
</span><span class="default">?&gt;<br />
</span><br />
Same as: <br />
<span class="default">&lt;?php<br />
substr_replace</span><span class="keyword">(</span><span class="string">'huevos'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,-</span><span class="default">2</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">); </span><span class="comment">//huevxos<br />
</span><span class="default">?&gt;<br />
</span><br />
Another note, if length is negative and start offsets the same position as length, length (yet again) will have the effect as being set as 0. (Of course, as mentioned in the manual, when length is negative it actually represents the position before it)<br />
<br />
<span class="default">&lt;?php<br />
substr_replace</span><span class="keyword">(</span><span class="string">'abcd'</span><span class="keyword">, </span><span class="string">'x'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">4</span><span class="keyword">); </span><span class="comment">//xabcd<br />
</span><span class="default">?&gt;<br />
</span><br />
Same as: <br />
<span class="default">&lt;?php<br />
substr_replace</span><span class="keyword">(</span><span class="string">'abcd'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">); </span><span class="comment">//xabcd<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
substr_replace</span><span class="keyword">(</span><span class="string">'abcd'</span><span class="keyword">, </span><span class="string">'x'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, -</span><span class="default">3</span><span class="keyword">); </span><span class="comment">//axbcd<br />
</span><span class="default">?&gt;<br />
</span><br />
Same as:<br />
<span class="default">&lt;?php<br />
substr_replace</span><span class="keyword">(</span><span class="string">'abcd'</span><span class="keyword">, </span><span class="string">'x'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">); </span><span class="comment">//axbcd<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96308""></a>
  <div class="note">
   <strong class="user">den dot gierling at web dot de</strong>
   <a href="#96308" class="date">19-Feb-2010 10:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My problem was that substr_replace() always added $replacement, so i wrote my own function.<br />
This function only adds $replacement, if substr() took action.<br />
The parameter $length is optional - like substr()'s.<br />
Or I was too stupid using $start and $length...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">substr_replace_provided</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$replacement</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$length</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tmp</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$length</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$string</span><span class="keyword">!==</span><span class="default">$tmp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">$tmp</span><span class="keyword">.</span><span class="default">$replacement</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93993""></a>
  <div class="note">
   <strong class="user">kalim dot fleet at gmail dot com</strong>
   <a href="#93993" class="date">10-Oct-2009 09:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This will truncate a longer string to a smaller string of specified length while replacing the middle portion with a separator exactly in the middle.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$longString </span><span class="keyword">= </span><span class="string">'abcdefghijklmnopqrstuvwxyz0123456789z.jpg'</span><span class="keyword">;<br />
</span><span class="default">$separator </span><span class="keyword">= </span><span class="string">'/.../'</span><span class="keyword">;<br />
</span><span class="default">$separatorlength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$separator</span><span class="keyword">) ;<br />
</span><span class="default">$maxlength </span><span class="keyword">= </span><span class="default">25 </span><span class="keyword">- </span><span class="default">$separatorlength</span><span class="keyword">;<br />
</span><span class="default">$start </span><span class="keyword">= </span><span class="default">$maxlength </span><span class="keyword">/ </span><span class="default">2 </span><span class="keyword">;<br />
</span><span class="default">$trunc </span><span class="keyword">=&nbsp; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$longString</span><span class="keyword">) - </span><span class="default">$maxlength</span><span class="keyword">;<br />
<br />
echo </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$longString</span><span class="keyword">, </span><span class="default">$separator</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$trunc</span><span class="keyword">);<br />
<br />
</span><span class="comment">//prints "abcdefghij/.../56789z.jpg"<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93913""></a>
  <div class="note">
   <strong class="user">admiral at nuclearpixel dot com</strong>
   <a href="#93913" class="date">06-Oct-2009 11:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hey everyone, I was noticing that there are a lot of ways below that people are using to write their own string truncation functions, but it kinda seemed like a lot of them went a bit too far out to make any sense to a n00b. Not that I am one anymore, but I though I'd add a note on this topic myself, in hopes that it might help others understand things a little better.<br />
<br />
Here's a concept that some people don't know about, or remember to use often enough; You can actually pull individual characters out of a string by referencing that string as though it were an array. Example: If I have the string $s = 'cat', I can use $s[0] to actually get out only the first character of that string, 'c'. I use that same principle below, but I just use a loop to iterate through a string and add the characters to the output variable one by one until the $lenth param has been reached, or until the end of the string.<br />
<br />
I hope this can help someone out!<br />
<br />
-Admiral Potato<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">admiralsTruncate</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$length</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">settype</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="string">'string'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">settype</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">, </span><span class="string">'integer'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$a </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$a </span><span class="keyword">&lt; </span><span class="default">$length </span><span class="keyword">AND </span><span class="default">$a </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">); </span><span class="default">$a</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">$string</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">$output</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$my_string </span><span class="keyword">= </span><span class="string">'cfcd208495d565ef66e7dff9f98764da'</span><span class="keyword">;<br />
<br />
echo </span><span class="default">admiralsTruncate</span><span class="keyword">(</span><span class="default">$my_string</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// outputs: cfcd20<br />
<br />
</span><span class="keyword">echo </span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
<br />
echo </span><span class="default">admiralsTruncate</span><span class="keyword">(</span><span class="default">$my_string</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// outputs: cfcd20849<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90280""></a>
  <div class="note">
   <strong class="user">gcdreak at farfaraway dot com</strong>
   <a href="#90280" class="date">14-Apr-2009 07:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a good method to check file chmod value:<br />
<span class="default">&lt;?php<br />
<br />
$file </span><span class="keyword">= </span><span class="string">"../files/sample.txt"</span><span class="keyword">;<br />
</span><span class="default">$rights </span><span class="keyword">= </span><span class="default">decoct</span><span class="keyword">(</span><span class="default">fileperms</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">));<br />
echo </span><span class="string">"File rights: "</span><span class="keyword">.</span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$rights</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90146""></a>
  <div class="note">
   <strong class="user">billg AT microsoft.com</strong>
   <a href="#90146" class="date">07-Apr-2009 07:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Forget all of the mb_substr_replace() implementations mentioned in this page, they're all buggy.<br />
<br />
Here is a version that mimics the behavior of substr_replace() exactly:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'mb_substr_replace'</span><span class="keyword">) === </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">mb_substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$replacement</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$length </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">extension_loaded</span><span class="keyword">(</span><span class="string">'mbstring'</span><span class="keyword">) === </span><span class="default">true</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string_length </span><span class="keyword">= (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$encoding</span><span class="keyword">) === </span><span class="default">true</span><span class="keyword">) ? </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) : </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$start </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$start </span><span class="keyword">= </span><span class="default">max</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$string_length </span><span class="keyword">+ </span><span class="default">$start</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$start </span><span class="keyword">&gt; </span><span class="default">$string_length</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$start </span><span class="keyword">= </span><span class="default">$string_length</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$length </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">max</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$string_length </span><span class="keyword">- </span><span class="default">$start </span><span class="keyword">+ </span><span class="default">$length</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if ((</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">) === </span><span class="default">true</span><span class="keyword">) || (</span><span class="default">$length </span><span class="keyword">&gt; </span><span class="default">$string_length</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">$string_length</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$start </span><span class="keyword">+ </span><span class="default">$length</span><span class="keyword">) &gt; </span><span class="default">$string_length</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">$string_length </span><span class="keyword">- </span><span class="default">$start</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$encoding</span><span class="keyword">) === </span><span class="default">true</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">) . </span><span class="default">$replacement </span><span class="keyword">. </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$start </span><span class="keyword">+ </span><span class="default">$length</span><span class="keyword">, </span><span class="default">$string_length </span><span class="keyword">- </span><span class="default">$start </span><span class="keyword">- </span><span class="default">$length</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">) . </span><span class="default">$replacement </span><span class="keyword">. </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$start </span><span class="keyword">+ </span><span class="default">$length</span><span class="keyword">, </span><span class="default">$string_length </span><span class="keyword">- </span><span class="default">$start </span><span class="keyword">- </span><span class="default">$length</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">) === </span><span class="default">true</span><span class="keyword">) ? </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$replacement</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">) : </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$replacement</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$length</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89848""></a>
  <div class="note">
   <strong class="user">juichenieder-phnet at yahoo dot co dot uk</strong>
   <a href="#89848" class="date">25-Mar-2009 10:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've just taken a look at the post by ntoniazzi and I have a very small correction to make.<br />
<br />
In the second if statement, it should be a triple equals, so:<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">if (</span><span class="default">$length </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) </span><span class="default">?&gt;<br />
</span><br />
It requires the triple equals, for the case of pure insertion, where $length = 0, the double equals, will catch this, causing the string to be cut short.&nbsp; I hope this helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86254""></a>
  <div class="note">
   <strong class="user">NiX0n at fragfest dot cx</strong>
   <a href="#86254" class="date">09-Oct-2008 09:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The preemptive test to see if $string is "too long" shouldn't add strlen($replacement) to $max.&nbsp; $max should represent the absolute maximum length of string returned.&nbsp; The size of the $replacement is irrelevant in that determination.<br />
<br />
The rest of the function (unchanged below) operates as defined above.&nbsp; Meaning, the size of the $replacement is subtracted from the $max, so that the returned string is exactly the length of $max.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">truncate</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$max </span><span class="keyword">= </span><span class="default">20</span><span class="keyword">, </span><span class="default">$replacement </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) &lt;= </span><span class="default">$max</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$leave </span><span class="keyword">= </span><span class="default">$max </span><span class="keyword">- </span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$replacement</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$replacement</span><span class="keyword">, </span><span class="default">$leave</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84728""></a>
  <div class="note">
   <strong class="user">spcl dot delivery at gmail dot com</strong>
   <a href="#84728" class="date">27-Jul-2008 04:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
the version of my predecessor will add $rep even if the string is shorter than max. fixed version:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">truncate</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$max </span><span class="keyword">= </span><span class="default">20</span><span class="keyword">, </span><span class="default">$rep </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) &lt;= (</span><span class="default">$max </span><span class="keyword">+ </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$rep</span><span class="keyword">)))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$leave </span><span class="keyword">= </span><span class="default">$max </span><span class="keyword">- </span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$rep</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$rep</span><span class="keyword">, </span><span class="default">$leave</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
To preserve the filename extension you can call it like this:<br />
<br />
truncate([filename], 30, '...' . end(explode('.', [filename])))</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83614""></a>
  <div class="note">
   <strong class="user">eblejr AT phrebh DOT com</strong>
   <a href="#83614" class="date">04-Jun-2008 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP version of Java's removeCharAt() function:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">removeCharAt</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$int</span><span class="keyword">){<br />
&nbsp; return </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">$int</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82733""></a>
  <div class="note">
   <strong class="user">William Barry</strong>
   <a href="#82733" class="date">23-Apr-2008 12:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I recently ran across a situation where I need to strip a heavily nested html list such that only the top level was preserved.&nbsp; I started with a regular expression solution, but found that I kept matching the wrong closing ul with an outer opening ul.<br />
<br />
This was my alternative solution, and it seems to work well:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">stripNestedLists</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str2 </span><span class="keyword">= </span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lastStr </span><span class="keyword">= </span><span class="default">$str2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; do<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Find the first closing ul<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cul </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">, </span><span class="string">'&lt;/ul&gt;'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ul </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastUL </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; do<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Find the next opening ul<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastUL </span><span class="keyword">= </span><span class="default">$ul</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ul </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">, </span><span class="string">'&lt;ul'</span><span class="keyword">, </span><span class="default">$ul</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$ul </span><span class="keyword">!== </span><span class="default">false </span><span class="keyword">&amp;&amp; </span><span class="default">$ul </span><span class="keyword">&lt; </span><span class="default">$cul</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastStr </span><span class="keyword">= </span><span class="default">$str2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str2 </span><span class="keyword">= </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$lastUL</span><span class="keyword">, </span><span class="default">$cul</span><span class="keyword">-</span><span class="default">$lastUL</span><span class="keyword">+</span><span class="default">5</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str2 </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$lastStr</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope this helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82056""></a>
  <div class="note">
   <strong class="user">jaimthorn at yahoo dot com</strong>
   <a href="#82056" class="date">25-Mar-2008 10:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I recently needed a routine that would remove the characters in one string from another, like the regex<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $result </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/[</span><span class="default">$chars</span><span class="string">]/"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
and I needed it to be fast, and accept pretty much all input.&nbsp; The regex above won't work when strlen($chars) == 0.&nbsp; I came up with this, admittedly pretty horrible-looking code, that is quite fast:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">RemoveChars</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$chars</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; return isset(</span><span class="default">$chars</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">}) ? </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">}, </span><span class="string">""</span><span class="keyword">, </span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$chars</span><span class="keyword">, </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">}, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">), </span><span class="default">$chars</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">}))) : </span><span class="default">$string</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
According to my own measurements, the regex in ONLY faster for when strlen($chars) == 1; for longer strings, my routine is faster.&nbsp; What does it do?&nbsp; Let's say you want to remove the period, the comma and the exclamation mark from a string, like so:<br />
$result = RemoveChars("Isn't this, like, totally neat..!?", ".?!");<br />
The str_pad function creates a string equal in length to the string that contains the character to be removed, but consisting only of the first character of that string:<br />
The input is ".,!"<br />
The output is "..."<br />
The strtr function translates all characters in the string-to-be-processed ("Isn't this...") that also occur in the input (".,!") to the characters in the same position in the output ("...").&nbsp; In other words:<br />
Isn't this, like, totally neat..!?<br />
becomes<br />
Isn't this. like. totally neat....<br />
Finally, the first character from the input (".,!") which happens to be, again, the period, is removed from that string by the str_replace call:<br />
Isn't this like totally neat?<br />
The function needs to check is $chars has at least one character, or else the str_pad function will fail.&nbsp; If it's empty, then the unprocessed string is returned.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81104""></a>
  <div class="note">
   <strong class="user">ntoniazzi at sqli dot com</strong>
   <a href="#81104" class="date">14-Feb-2008 01:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Almost... In the previous note, change this :<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">mb_substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$replacement</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$length</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$encoding </span><span class="keyword">== </span><span class="default">null</span><span class="keyword">) </span><span class="default">$encoding </span><span class="keyword">= </span><span class="default">mb_internal_encoding</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$start </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) </span><span class="default">$start </span><span class="keyword">= </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) + </span><span class="default">$start</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; [...]<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81086""></a>
  <div class="note">
   <strong class="user">ntoniazzi at sqli dot com</strong>
   <a href="#81086" class="date">13-Feb-2008 09:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is a mistake in the mb_substr_replace function below, when the $length parameter is given negative. Here is a working version.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//Check to see if it exists in case PHP has this function later<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">"mb_substr_replace"</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Same parameters as substr_replace with the extra encoding parameter.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">mb_substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$replacement</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$length</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$encoding </span><span class="keyword">== </span><span class="default">null</span><span class="keyword">) </span><span class="default">$encoding </span><span class="keyword">= </span><span class="default">mb_internal_encoding</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$length </span><span class="keyword">== </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">) . </span><span class="default">$replacement</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$length </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) </span><span class="default">$length </span><span class="keyword">= </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">) - </span><span class="default">$start </span><span class="keyword">+ </span><span class="default">$length</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">) .<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$replacement </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$start </span><span class="keyword">+ </span><span class="default">$length</span><span class="keyword">, </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">), </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76951""></a>
  <div class="note">
   <strong class="user">alishahnovin at hotmail dot com</strong>
   <a href="#76951" class="date">07-Aug-2007 12:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I like the truncate function below...however, I found a few issues. Particularly if you have content that may have any kind of punctuation in it (?, !, ?!?, --, ..., .., ;, etc.)<br />
<br />
The older function would end up looking like "blah blah?..." or "blah blah,..." which doesn't look so nice to me...<br />
<br />
Here's my fix. It removes all trailing punctuation (that you include in the $punctuation string below) and then adds an ellipse. So even if it has an ellipse with 3 dots, 2 dots, 4 dots, it'll be removed, then re-added.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">truncate</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$numb</span><span class="keyword">,</span><span class="default">$etc </span><span class="keyword">= </span><span class="string">"..."</span><span class="keyword">) {<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">html_entity_decode</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">ENT_QUOTES</span><span class="keyword">);<br />
if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) &gt; </span><span class="default">$numb</span><span class="keyword">) {<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$numb</span><span class="keyword">);<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="string">" "</span><span class="keyword">));<br />
<br />
</span><span class="default">$punctuation </span><span class="keyword">= </span><span class="string">".!?:;,-"</span><span class="keyword">; </span><span class="comment">//punctuation you want removed<br />
<br />
</span><span class="default">$text </span><span class="keyword">= (</span><span class="default">strspn</span><span class="keyword">(</span><span class="default">strrev</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">),&nbsp; </span><span class="default">$punctuation</span><span class="keyword">)!=</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ?<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">strspn</span><span class="keyword">(</span><span class="default">strrev</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">),&nbsp; </span><span class="default">$punctuation</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; :<br />
</span><span class="default">$text</span><span class="keyword">;<br />
<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">$text</span><span class="keyword">.</span><span class="default">$etc</span><span class="keyword">;<br />
}<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">ENT_QUOTES</span><span class="keyword">);<br />
return </span><span class="default">$text</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
I also needed a sort of "middle" truncate. The above function truncates around the end, but if you want to truncate around the middle (ie "Hello this is a long string." --&gt; "Hello this ... long string.") you can use this (requires the truncate function):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mtruncate</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$numb</span><span class="keyword">, </span><span class="default">$etc </span><span class="keyword">= </span><span class="string">" ... "</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$first_part </span><span class="keyword">= </span><span class="default">truncate</span><span class="keyword">(</span><span class="default">truncate</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)/</span><span class="default">2</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">), </span><span class="default">$numb</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$second_part </span><span class="keyword">= </span><span class="default">truncate</span><span class="keyword">(</span><span class="default">strrev</span><span class="keyword">(</span><span class="default">truncate</span><span class="keyword">(</span><span class="default">strrev</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">), </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)/</span><span class="default">2</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">)), </span><span class="default">$numb</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$first_part</span><span class="keyword">.</span><span class="default">$etc</span><span class="keyword">.</span><span class="default">$second_part</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76945""></a>
  <div class="note">
   <strong class="user">joecorcoran at gmail dot com</strong>
   <a href="#76945" class="date">07-Aug-2007 06:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've made a minor amendment to the function in the post below, to strip away the full stop (period) if the truncation occurs at the exact end of a sentence (the full stop spoils the ellipsis):<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">truncate</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$numb</span><span class="keyword">) {<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">html_entity_decode</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">ENT_QUOTES</span><span class="keyword">);<br />
if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) &gt; </span><span class="default">$numb</span><span class="keyword">) {<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$numb</span><span class="keyword">);<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="string">" "</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//This strips the full stop:<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if ((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">)) == </span><span class="string">"."</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,(</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">$etc </span><span class="keyword">= </span><span class="string">"..."</span><span class="keyword">; <br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">$text</span><span class="keyword">.</span><span class="default">$etc</span><span class="keyword">;<br />
} <br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">ENT_QUOTES</span><span class="keyword">); <br />
return </span><span class="default">$text</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">//Call function<br />
</span><span class="default">truncate</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">75</span><span class="keyword">);</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74024""></a>
  <div class="note">
   <strong class="user">www.kigoobe.com</strong>
   <a href="#74024" class="date">21-Mar-2007 02:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The two truncate functions provided below, have some major short comings.<br />
<br />
1. They may cut a word in half<br />
2. In case you are using htmlentities to get user input or are using wysiwyg editors to get user input, you can get truncated text like "he told C&amp;eac..." instead of "he told Ccile" or "he told".<br />
<br />
Here is what I use -<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">truncate</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$numb</span><span class="keyword">) {<br />
</span><span class="comment">// source: www.kigoobe.com, please keep this if you are using the function<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">html_entity_decode</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">ENT_QUOTES</span><span class="keyword">); <br />
if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) &gt; </span><span class="default">$numb</span><span class="keyword">) { <br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$numb</span><span class="keyword">); <br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="string">" "</span><span class="keyword">)); <br />
</span><span class="default">$etc </span><span class="keyword">= </span><span class="string">" ..."</span><span class="keyword">;&nbsp; <br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">$text</span><span class="keyword">.</span><span class="default">$etc</span><span class="keyword">; <br />
}&nbsp; <br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">ENT_QUOTES</span><span class="keyword">);&nbsp; <br />
return </span><span class="default">$text</span><span class="keyword">; <br />
}<br />
<br />
</span><span class="comment">// Now, to use this function, you can call that as -<br />
</span><span class="default">truncate</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">75</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59544""></a>
  <div class="note">
   <strong class="user">chuayw2000 at hotmail dot com</strong>
   <a href="#59544" class="date">09-Dec-2005 03:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I don't know if this function is multibyte safe but I've written a function that will do the same in multibyte mode.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//Check to see if it exists in case PHP has this function later<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">"mb_substr_replace"</span><span class="keyword">)){<br />
&nbsp;&nbsp; </span><span class="comment">//Same parameters as substr_replace with the extra encoding parameter.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">mb_substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$replacement</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$length</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">,</span><span class="default">$encoding </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$encoding </span><span class="keyword">== </span><span class="default">null</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$length </span><span class="keyword">== </span><span class="default">null</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">).</span><span class="default">$replacement</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">).</span><span class="default">$replacement</span><span class="keyword">.</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$start </span><span class="keyword">+ </span><span class="default">$length</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$length </span><span class="keyword">== </span><span class="default">null</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$encoding</span><span class="keyword">).</span><span class="default">$replacement</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$encoding</span><span class="keyword">). </span><span class="default">$replacement</span><span class="keyword">. </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$start </span><span class="keyword">+ </span><span class="default">$length</span><span class="keyword">,</span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$encoding</span><span class="keyword">),</span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59403""></a>
  <div class="note">
   <strong class="user">michael(at)webstaa(dot)com</strong>
   <a href="#59403" class="date">05-Dec-2005 08:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I created this because of the need to mask a credit-card number like **** **** **** 8862<br />
<br />
string mask ( string str, int start [, int length] )<br />
<br />
mask() masks a copy of str delimited by the start and (optionally) length parameters with asterisks (*) in place of non-whitespace characters<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">mask </span><span class="keyword">( </span><span class="default">$str</span><span class="keyword">, </span><span class="default">$start </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$length </span><span class="keyword">= </span><span class="default">null </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mask </span><span class="keyword">= </span><span class="default">preg_replace </span><span class="keyword">( </span><span class="string">"/\S/"</span><span class="keyword">, </span><span class="string">"*"</span><span class="keyword">, </span><span class="default">$str </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">is_null </span><span class="keyword">( </span><span class="default">$length </span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mask </span><span class="keyword">= </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$mask</span><span class="keyword">, </span><span class="default">$start </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">substr_replace </span><span class="keyword">( </span><span class="default">$str</span><span class="keyword">, </span><span class="default">$mask</span><span class="keyword">, </span><span class="default">$start </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mask </span><span class="keyword">= </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$mask</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$length </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">substr_replace </span><span class="keyword">( </span><span class="default">$str</span><span class="keyword">, </span><span class="default">$mask</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$length </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56223""></a>
  <div class="note">
   <strong class="user">hermes at andycostell dot com</strong>
   <a href="#56223" class="date">27-Aug-2005 11:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I suggest changing the function suggested by Guru Evi slightly. I found that it doesn't work as written here.<br />
<br />
Original:<br />
function add_3dots($string,$repl,$start,$limit) {<br />
&nbsp;&nbsp; if(strlen($string) &gt; $limit) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; return substr_replace(strip_tags($string),$repl,$start,$limit);<br />
&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; return $string;<br />
&nbsp;&nbsp; };<br />
};<br />
<br />
I suggest:<br />
function add_3dots($string,$repl,$limit) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; if(strlen($string) &gt; $limit) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return substr_replace(strip_tags($string),$repl,$limit-strlen($repl));<br />
&nbsp;&nbsp; &nbsp; &nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $string;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
Usage:<br />
<br />
$max_length=10;//the max number of characters you want to display<br />
$too_long_string="BLAH BLAH BLAH BLAH BLAH etc.";//the string you want to shorten (if it's longer than the $limit)<br />
$shorter_string=add_3_dots($too_long_string,"...",$max_length);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54703""></a>
  <div class="note">
   <strong class="user">Guru Evi</strong>
   <a href="#54703" class="date">13-Jul-2005 12:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your string is not long enough to meet what you specify in start and length then the replacement string is added towards the end of the string.<br />
<br />
I wanted to replace the end of the string with ... if the string was too long to display (for instance article preview on a website). The problem was that my string was sometimes not that long and it still added the replacement string. So I wrote a function to replace substr_replace in my website:<br />
<br />
function add_3dots($string,$repl,$start,$limit) {<br />
&nbsp;&nbsp;&nbsp; if(strlen($string) &gt; $limit) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return substr_replace(strip_tags($string),$repl,$start,$limit);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $string;<br />
&nbsp;&nbsp;&nbsp; };<br />
};<br />
<br />
I use strip_tags to strip out the HTML otherwise you might get a screwed up HTML (when a tags open in the string, but because you cut-off it doesn't)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48773""></a>
  <div class="note">
   <strong class="user">tekrat at 2d dot com</strong>
   <a href="#48773" class="date">06-Jan-2005 08:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a slightly revised version of the truncation function above.<br />
<br />
Theres isn't much of a reason to&nbsp; add in the $rep at the end of the original string is less then the truncation break point.<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">truncate</span><span class="keyword">(</span><span class="default">$substring</span><span class="keyword">, </span><span class="default">$max </span><span class="keyword">= </span><span class="default">50</span><span class="keyword">, </span><span class="default">$rep </span><span class="keyword">= </span><span class="string">'...'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$substring</span><span class="keyword">) &gt;= </span><span class="default">1</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">$substring</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$leave </span><span class="keyword">= </span><span class="default">$max </span><span class="keyword">- </span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$rep</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) &gt; </span><span class="default">$max</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$rep</span><span class="keyword">, </span><span class="default">$leave</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
[EDIT BY danbrown AT php DOT net: Contains a bugfix by (ogt AT parasane DOT com) (which was me ;-P) from 21-JAN-05 at 11:02 EST.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48066""></a>
  <div class="note">
   <strong class="user">danieldoorduin at hotmail dot com</strong>
   <a href="#48066" class="date">10-Dec-2004 02:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using substr_replace() can be avoided by using substr() instead:<br />
<br />
&lt;?<br />
$string = substr($string, 0, $position_needle).$replace.substr($string, $position_needle+$length_needle);<br />
?&gt;<br />
<br />
This can be useful when you need to replace parts of multibyte strings like strings encoded with utf-8. There isn't a multibute variant for substr_replace(), but for php substr() there is mb_substr(). For more information on multibyte strings see <a href="http://nl3.php.net/manual/en/ref.mbstring.php" rel="nofollow" target="_blank">http://nl3.php.net/manual/en/ref.mbstring.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44399""></a>
  <div class="note">
   <strong class="user">titbits at nospam-4logical dot co dot uk</strong>
   <a href="#44399" class="date">04-Aug-2004 02:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple but useful 'pluralize' function using substr_replace:<br />
<br />
&nbsp; function pluralize($noun) {<br />
&nbsp;&nbsp;&nbsp; if ($noun{strlen($noun) -1} == "y") <br />
&nbsp;&nbsp; &nbsp;&nbsp; $noun = substr_replace($noun, "ies", strlen($noun) -1);<br />
&nbsp;&nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp;&nbsp; $noun .= "s";<br />
<br />
&nbsp;&nbsp;&nbsp; return $noun;<br />
&nbsp; }<br />
<br />
Handy when displaying dynamic text.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43338""></a>
  <div class="note">
   <strong class="user">dmron</strong>
   <a href="#43338" class="date">17-Jun-2004 04:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding "...", even the short functions are too long and complicated, and there's no need to use substr_replace. substr() works better and is&nbsp; way faster prior to 4.3.5 as the below poster stated.<br />
<br />
function shorten( $str, $num = 100 ) {<br />
&nbsp; if( strlen( $str ) &gt; $num ) $str = substr( $str, 0, $num ) . "...";<br />
&nbsp; return $str;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42367""></a>
  <div class="note">
   <strong class="user">philip</strong>
   <a href="#42367" class="date">13-May-2004 12:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The substr_replace() function is extremely slow in PHP versions prior to 4.3.5 and 5.0.0 so consider using an alternative before this time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42260""></a>
  <div class="note">
   <strong class="user">tony at outshine dot com</strong>
   <a href="#42260" class="date">10-May-2004 02:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The comment by geniusdex is a good one.&nbsp; Short, simple functions are the best.&nbsp; But if the string is not longer than the limit set, NOTHING is returned.&nbsp; Here is the function re-done to always return a string:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">dot</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$len</span><span class="keyword">, </span><span class="default">$dots </span><span class="keyword">= </span><span class="string">"..."</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) &gt; </span><span class="default">$len</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dotlen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dots</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$dots</span><span class="keyword">, </span><span class="default">$len </span><span class="keyword">- </span><span class="default">$dotlen</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40141""></a>
  <div class="note">
   <strong class="user">geniusdex ( at ) brz ( dot ) nu</strong>
   <a href="#40141" class="date">23-Feb-2004 07:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is my version of making dotted strings:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">dot</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$len</span><span class="keyword">, </span><span class="default">$dots </span><span class="keyword">= </span><span class="string">"..."</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) &gt; </span><span class="default">$len</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dotlen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dots</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$dots</span><span class="keyword">, </span><span class="default">$len </span><span class="keyword">- </span><span class="default">$dotlen</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39200""></a>
  <div class="note">
   <strong class="user">Thijs Wijnmaalen (thijs[at]nllinux.nl)</strong>
   <a href="#39200" class="date">20-Jan-2004 11:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote a function that you can use for example in combination with a search script to cut off the articles that are too long.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">substr_index</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$maxChars </span><span class="keyword">= </span><span class="default">20</span><span class="keyword">, </span><span class="default">$splitter<br />
</span><span class="keyword">= </span><span class="string">'...'</span><span class="keyword">) {<br />
<br />
</span><span class="default">$theReturn </span><span class="keyword">= </span><span class="default">$text</span><span class="keyword">;<br />
</span><span class="default">$lastSpace </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
<br />
if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) &gt; </span><span class="default">$maxChars</span><span class="keyword">) {<br />
</span><span class="default">$theReturn </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$maxChars </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
<br />
if (</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$maxChars </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">),<br />
array(</span><span class="string">' '</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">, </span><span class="string">'!'</span><span class="keyword">, </span><span class="string">'?'</span><span class="keyword">))) {<br />
</span><span class="default">$theReturn </span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$maxChars</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
} else {<br />
</span><span class="default">$theReturn </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$theReturn</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$maxChars </span><span class="keyword">-<br />
</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$splitter</span><span class="keyword">));<br />
</span><span class="default">$lastSpace </span><span class="keyword">= </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$theReturn</span><span class="keyword">, </span><span class="string">' '</span><span class="keyword">);<br />
<br />
if (</span><span class="default">$lastSpace </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) {<br />
</span><span class="default">$theReturn </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$theReturn</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$lastSpace</span><span class="keyword">);<br />
}<br />
<br />
if (</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$theReturn</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">), array(</span><span class="string">','</span><span class="keyword">))) {<br />
</span><span class="default">$theReturn </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$theReturn</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);<br />
}<br />
</span><span class="default">$theReturn </span><span class="keyword">.= </span><span class="default">$splitter</span><span class="keyword">;<br />
}<br />
}<br />
return </span><span class="default">$theReturn</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37156""></a>
  <div class="note">
   <strong class="user">neon at lordneon dot com</strong>
   <a href="#37156" class="date">05-Nov-2003 04:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The easiest way (I think) to add trailing dots after a string which in my case are too long is:<br />
<br />
&lt;?<br />
function dots($num, $string) {<br />
&nbsp;&nbsp;&nbsp; if (strlen($string) &lt; $num) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $string = substr_replace($string, '...', '-10', $num);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $string;<br />
}<br />
<br />
Then on your page do something like:<br />
&lt;? echo dots("30" $row['title']); ?&gt;<br />
<br />
if the string is greater than the specific number it'll replace 3 dots.<br />
<br />
I hope this helps =)<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33736""></a>
  <div class="note">
   <strong class="user">david at ethinkn dot com</strong>
   <a href="#33736" class="date">05-Jul-2003 05:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a simple function to shorten a string and add an ellipsis<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* truncate() Simple function to shorten a string and add an ellipsis<br />
&nbsp;* <br />
&nbsp;* @param string $string Origonal string<br />
&nbsp;* @param integer $max Maximum length<br />
&nbsp;* @param string $rep Replace with... (Default = '' - No elipsis -)<br />
&nbsp;* @return string<br />
&nbsp;* @author David Duong<br />
&nbsp;**/<br />
</span><span class="keyword">function </span><span class="default">truncate </span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$max </span><span class="keyword">= </span><span class="default">50</span><span class="keyword">, </span><span class="default">$rep </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$leave </span><span class="keyword">= </span><span class="default">$max </span><span class="keyword">- </span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$rep</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$rep</span><span class="keyword">, </span><span class="default">$leave</span><span class="keyword">);<br />
} <br />
<br />
echo </span><span class="default">truncate </span><span class="keyword">(</span><span class="string">'akfhslakdhglksjdgh'</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">, </span><span class="string">'...'</span><span class="keyword">);<br />
</span><span class="comment">// Returns akfhsla... (10 chrs)<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25843""></a>
  <div class="note">
   <strong class="user">thomasNOSPAM at sportentranceNOSPAM dot com</strong>
   <a href="#25843" class="date">08-Oct-2002 03:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To abbreviate links into '...' if they outreach a certain amount of space; use the preg_replace function instead.<br />
<br />
For instance you grabbed the headlines of a news site for use on your own page and the lines are to long:<br />
<br />
asuming the raw material is stored in $unedited;<br />
<br />
$edited = preg_replace("/(&gt;)([[:print:]]{52,})(&lt;)/e", "'\\1'.substr_replace('\\2 ', '...', '48').'\\3'", $unedited);<br />
echo $edited;<br />
<br />
This will shorten strings longer than 52 characters into 51 characters, with the last being three dots...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19015""></a>
  <div class="note">
   <strong class="user">klaas at group94 dot com</strong>
   <a href="#19015" class="date">13-Feb-2002 10:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
THE DOT DOT DOT ISSUE<br />
<br />
PROBLEM:<br />
You want to abbreviate a string.<br />
E.g. You want "BritneySpears" to show as "BritneySpe...", being only the ten first characters followed by "..."<br />
<br />
SOLUTION:<br />
&lt;?<br />
$oRIGINAL = "BritneySpears";<br />
$sHORTER = substr_replace($oRIGINAL, '...', 10);<br />
echo ($sHORTER);<br />
?&gt;<br />
<br />
This will result in BritneySpe...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15744""></a>
  <div class="note">
   
   <a href="#15744" class="date">28-Sep-2001 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you would like to remove characters from the start or end of a string, try the substr() function.<br />
<br />
For example, to remove the last three characters from a string:<br />
$string = "To be or not to be.";<br />
$string = substr ($string, 0, -3);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="12483""></a>
  <div class="note">
   <strong class="user">mrbrown8 at juno dot com</strong>
   <a href="#12483" class="date">16-Apr-2001 12:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just to add to the examples, if replacement is longer than length, only the length number of chars are removed from string and all of replacement is put in its place, and therefor strlen($string) is inreased.<br />
<br />
$var = 'ABCDEFGH:/MNRPQR/';<br />
/*&nbsp; Should return ABCDEFGH:/testingRPQR/&nbsp;&nbsp; */<br />
echo substr_replace ($var, 'testing', 10, 2);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="11924""></a>
  <div class="note">
   <strong class="user">jgainey at infoave dot net</strong>
   <a href="#11924" class="date">13-Mar-2001 06:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor's note: for a much simpler solution, use number_format()]<br />
<br />
I had a situation in which I needed to add a comma to the third position of a number(the price of something).<br />
<br />
<span class="default">&lt;?php<br />
$price </span><span class="keyword">= </span><span class="string">"12000"</span><span class="keyword">;<br />
</span><span class="default">$price </span><span class="keyword">= </span><span class="default">substr_replace </span><span class="keyword">(</span><span class="default">$price</span><span class="keyword">, </span><span class="string">','</span><span class="keyword">, -</span><span class="default">3</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">)</span><span class="string">";<br />
?&gt;<br />
<br />
the result would be 12,000<br />
the -3 counts from right to left. a regular 3 would count from left to right<br />
I hope this helps...</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.substr-count.html">substr_count</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.substr.html">substr</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

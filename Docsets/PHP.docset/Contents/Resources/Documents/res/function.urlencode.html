<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>URL-encodes string</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.urldecode.html">urldecode</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="book.v8js.html">V8js</a></div>
 <div class="up"><a href="ref.url.html">URL Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.urlencode" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">urlencode</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">urlencode</span> &mdash; <span class="dc-title">URL-encodes string</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.urlencode-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><b>urlencode</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$str</tt></span>
   )</div>

  <p class="para rdfs-comment">
   This function is convenient when encoding a string to be used in a query
   part of a URL, as a convenient way to pass variables to the next page.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.urlencode-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">str</tt></i></span>
     <dd>

      <p class="para">
       The string to be encoded.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.urlencode-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns a string in which all non-alphanumeric characters except
   <i>-_.</i> have been replaced with a percent
   (<i>%</i>) sign followed by two hex digits and spaces encoded
   as plus (<i>+</i>) signs.  It is encoded the same way that the
   posted data from a WWW form is encoded, that is the same way as in
   <i>application/x-www-form-urlencoded</i> media type. This
   differs from the <a href="http://www.faqs.org/rfcs/rfc3986" class="link external" title="Link : http://www.faqs.org/rfcs/rfc3986">&raquo;&nbsp;RFC 3986</a> encoding (see
   <span class="function"><a href="function.rawurlencode.html" class="function">rawurlencode()</a></span>) in that for historical reasons, spaces
   are encoded as plus (+) signs.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.urlencode-examples">
  <h3 class="title">Examples</h3> 
  <p class="para">  
   <div class="example" id="example-3732">
    <p><b>Example #1 <span class="function"><b>urlencode()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'&lt;a&nbsp;href="mycgi?foo='</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">urlencode</span><span style="color: #007700">(</span><span style="color: #0000BB">$userinput</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">'"&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3733">
    <p><b>Example #2 <span class="function"><b>urlencode()</b></span> and <span class="function"><a href="function.htmlentities.html" class="function">htmlentities()</a></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$query_string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'foo='&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">urlencode</span><span style="color: #007700">(</span><span style="color: #0000BB">$foo</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">'&amp;bar='&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">urlencode</span><span style="color: #007700">(</span><span style="color: #0000BB">$bar</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">'&lt;a&nbsp;href="mycgi?'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$query_string</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">'"&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.urlencode-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    Be careful about variables that may match HTML entities. Things like
    &amp;amp, &amp;copy and &amp;pound are parsed by the browser and the
    actual entity is used instead of the desired variable name.  This is an
    obvious hassle that the W3C has been telling people about for years.
    The reference is here: <a href="http://www.w3.org/TR/html4/appendix/notes.html#h-B.2.2" class="link external" title="Link : http://www.w3.org/TR/html4/appendix/notes.html#h-B.2.2">&raquo;&nbsp;http://www.w3.org/TR/html4/appendix/notes.html#h-B.2.2</a>.
   </p>
   <p class="para">
    PHP supports changing the argument separator to the W3C-suggested
    semi-colon through the arg_separator .ini directive.  Unfortunately most
    user agents do not send form data in this semi-colon separated format.
    A more portable way around this is to use &amp;amp; instead of &amp; as
    the separator.  You don&#039;t need to change PHP&#039;s arg_separator for this.
    Leave it as &amp;, but simply encode your URLs using
    <span class="function"><a href="function.htmlentities.html" class="function">htmlentities()</a></span> or 
    <span class="function"><a href="function.htmlspecialchars.html" class="function">htmlspecialchars()</a></span>.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.urlencode-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.urldecode.html" class="function" rel="rdfs-seeAlso">urldecode()</a> - Decodes URL-encoded string</span></li>
    <li class="member"><span class="function"><a href="function.htmlentities.html" class="function" rel="rdfs-seeAlso">htmlentities()</a> - Convert all applicable characters to HTML entities</span></li>
    <li class="member"><span class="function"><a href="function.rawurlencode.html" class="function" rel="rdfs-seeAlso">rawurlencode()</a> - URL-encode according to RFC 3986</span></li>
    <li class="member"><span class="function"><a href="function.rawurldecode.html" class="function" rel="rdfs-seeAlso">rawurldecode()</a> - Decode URL-encoded strings</span></li>
    <li class="member"><a href="http://www.faqs.org/rfcs/rfc3986" class="link external" title="Link : http://www.faqs.org/rfcs/rfc3986">&raquo;&nbsp;RFC 3986</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="104344""></a>
  <div class="note">
   <strong class="user">sroolig at gmail dot com</strong>
   <a href="#104344" class="date">09-Jun-2011 01:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I write this code, to full protect from XSS:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $url </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">.= </span><span class="default">strpos</span><span class="keyword">(</span><span class="string">"/:@&amp;%=?.#"</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) === </span><span class="default">False </span><span class="keyword">? </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) : </span><span class="default">$value</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">$url</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103324""></a>
  <div class="note">
   <strong class="user">php at rijkvanwel dot nl</strong>
   <a href="#103324" class="date">07-Apr-2011 12:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to encode an array or object to URL, just use the built in http_build_query() function:<br />
<br />
<span class="default">&lt;?php<br />
$params </span><span class="keyword">= array( </span><span class="string">'one' </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">, </span><span class="string">'two' </span><span class="keyword">=&gt; </span><span class="default">2 </span><span class="keyword">);<br />
echo </span><span class="string">'index.php?' </span><span class="keyword">. </span><span class="default">http_build_query</span><span class="keyword">( </span><span class="default">$params </span><span class="keyword">); </span><span class="comment">// index.php?one=1&amp;two=2<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100894""></a>
  <div class="note">
   <strong class="user">Whitenis</strong>
   <a href="#100894" class="date">13-Nov-2010 06:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To encode using RFC3986, use rawurlencode.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98020""></a>
  <div class="note">
   <strong class="user">tk at example dot com</strong>
   <a href="#98020" class="date">20-May-2010 12:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To easily encode an array to an url :<br />
<span class="default">&lt;?php<br />
$y</span><span class="keyword">= (</span><span class="string">"I"</span><span class="keyword">=&gt;</span><span class="string">"like"</span><span class="keyword">,</span><span class="string">"she"</span><span class="keyword">=&gt;</span><span class="string">"likes"</span><span class="keyword">);<br />
</span><span class="default">array_walk</span><span class="keyword">(</span><span class="default">$y </span><span class="keyword">, </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'&amp;$v,$k'</span><span class="keyword">, </span><span class="string">'$v = $k."=".$v ;'</span><span class="keyword">));<br />
</span><span class="string">"index.php?"</span><span class="keyword">.</span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">implode</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">)), </span><span class="default">ENT_QUOTES</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>returns :<br />
"index.php?I=like&amp;amp;she=likes"<br />
=)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97969""></a>
  <div class="note">
   <strong class="user">davis dot peixoto at gmail dot com</strong>
   <a href="#97969" class="date">18-May-2010 06:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
urlencode function and rawurlencode are mostly based on RFC 1738.<br />
<br />
However, since 2005 the current RFC in use for URIs standard is RFC 3986.<br />
<br />
Here is a function to encode URLs according to RFC 3986.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">myUrlEncode</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$entities </span><span class="keyword">= array(</span><span class="string">'%21'</span><span class="keyword">, </span><span class="string">'%2A'</span><span class="keyword">, </span><span class="string">'%27'</span><span class="keyword">, </span><span class="string">'%28'</span><span class="keyword">, </span><span class="string">'%29'</span><span class="keyword">, </span><span class="string">'%3B'</span><span class="keyword">, </span><span class="string">'%3A'</span><span class="keyword">, </span><span class="string">'%40'</span><span class="keyword">, </span><span class="string">'%26'</span><span class="keyword">, </span><span class="string">'%3D'</span><span class="keyword">, </span><span class="string">'%2B'</span><span class="keyword">, </span><span class="string">'%24'</span><span class="keyword">, </span><span class="string">'%2C'</span><span class="keyword">, </span><span class="string">'%2F'</span><span class="keyword">, </span><span class="string">'%3F'</span><span class="keyword">, </span><span class="string">'%25'</span><span class="keyword">, </span><span class="string">'%23'</span><span class="keyword">, </span><span class="string">'%5B'</span><span class="keyword">, </span><span class="string">'%5D'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$replacements </span><span class="keyword">= array(</span><span class="string">'!'</span><span class="keyword">, </span><span class="string">'*'</span><span class="keyword">, </span><span class="string">"'"</span><span class="keyword">, </span><span class="string">"("</span><span class="keyword">, </span><span class="string">")"</span><span class="keyword">, </span><span class="string">";"</span><span class="keyword">, </span><span class="string">":"</span><span class="keyword">, </span><span class="string">"@"</span><span class="keyword">, </span><span class="string">"&amp;"</span><span class="keyword">, </span><span class="string">"="</span><span class="keyword">, </span><span class="string">"+"</span><span class="keyword">, </span><span class="string">"$"</span><span class="keyword">, </span><span class="string">","</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="string">"?"</span><span class="keyword">, </span><span class="string">"%"</span><span class="keyword">, </span><span class="string">"#"</span><span class="keyword">, </span><span class="string">"["</span><span class="keyword">, </span><span class="string">"]"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$entities</span><span class="keyword">, </span><span class="default">$replacements</span><span class="keyword">, </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97191""></a>
  <div class="note">
   <strong class="user">frx dot apps at gmail dot com</strong>
   <a href="#97191" class="date">07-Apr-2010 08:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote this simple function that creates a GET query (for URLS) from an array:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">encode_array</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">)<br />
{<br />
&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp; foreach(</span><span class="default">$args </span><span class="keyword">as </span><span class="default">$name </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$c</span><span class="keyword">++ != </span><span class="default">0</span><span class="keyword">) </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">'&amp;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">urlencode</span><span class="keyword">(</span><span class="string">"</span><span class="default">$name</span><span class="string">"</span><span class="keyword">).</span><span class="string">'='</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">urlencode</span><span class="keyword">(</span><span class="string">"</span><span class="default">$value</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$out </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
If there are arrays within the $args array, they will be serialized before being urlencoded.<br />
<br />
Some examples:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="default">encode_array</span><span class="keyword">(array(</span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="string">'bar'</span><span class="keyword">));&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// foo=bar<br />
</span><span class="keyword">echo </span><span class="default">encode_array</span><span class="keyword">(array(</span><span class="string">'foo&amp;bar' </span><span class="keyword">=&gt; </span><span class="string">'some=weird/value'</span><span class="keyword">));&nbsp;&nbsp; </span><span class="comment">// foo%26bar=some%3Dweird%2Fvalue<br />
</span><span class="keyword">echo </span><span class="default">encode_array</span><span class="keyword">(array(</span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">, </span><span class="string">'bar' </span><span class="keyword">=&gt;&nbsp; </span><span class="string">'two'</span><span class="keyword">));&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// foo=1&amp;bar=two<br />
</span><span class="keyword">echo </span><span class="default">encode_array</span><span class="keyword">(array(</span><span class="string">'args' </span><span class="keyword">=&gt; array(</span><span class="string">'key' </span><span class="keyword">=&gt; </span><span class="string">'value'</span><span class="keyword">))); </span><span class="comment">// args=a%3A1%3A%7Bs%3A3%3A%22key%22%3Bs%3A5%3A%22value%22%3B%7D<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96394""></a>
  <div class="note">
   <strong class="user">omid at omidsakhi dot com</strong>
   <a href="#96394" class="date">24-Feb-2010 11:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed a function in PHP to do the same job as the complete escape function in Javascript. It took me some time not to find it. But findaly I decided to write my own code. So just to save time:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">fullescape</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hex </span><span class="keyword">= </span><span class="default">dechex</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]));<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$hex</span><span class="keyword">==</span><span class="string">''</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="default">$out</span><span class="keyword">.</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="default">$out </span><span class="keyword">.</span><span class="string">'%'</span><span class="keyword">.((</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$hex</span><span class="keyword">)==</span><span class="default">1</span><span class="keyword">) ? (</span><span class="string">'0'</span><span class="keyword">.</span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$hex</span><span class="keyword">)):(</span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$hex</span><span class="keyword">)));<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'+'</span><span class="keyword">,</span><span class="string">'%20'</span><span class="keyword">,</span><span class="default">$out</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'_'</span><span class="keyword">,</span><span class="string">'%5F'</span><span class="keyword">,</span><span class="default">$out</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">'%2E'</span><span class="keyword">,</span><span class="default">$out</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'-'</span><span class="keyword">,</span><span class="string">'%2D'</span><span class="keyword">,</span><span class="default">$out</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$out</span><span class="keyword">;<br />
&nbsp;}<br />
</span><span class="default">?&gt;<br />
</span><br />
It can be fully decoded using the unscape function in Javascript.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96256""></a>
  <div class="note">
   <strong class="user">liorbenkereth at gmail dot com</strong>
   <a href="#96256" class="date">17-Feb-2010 07:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if one wants to encode a url that contains unicode characters, he can se this code:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">encode_full_url</span><span class="keyword">(&amp;</span><span class="default">$url</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%2F"</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%3A"</span><span class="keyword">, </span><span class="string">":"</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$url</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
a little stupid, but gets the work done.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92424""></a>
  <div class="note">
   <strong class="user">temu92 at gmail dot com</strong>
   <a href="#92424" class="date">23-Jul-2009 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed encoding and decoding for UTF8 urls, I came up with these very simple fuctions. Hope this helps!<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">url_encode</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">url_decode</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">utf8_decode</span><span class="keyword">(</span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91855""></a>
  <div class="note">
   <strong class="user">daniel+php at danielnorton dot com</strong>
   <a href="#91855" class="date">29-Jun-2009 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't use urlencode() or urldecode() if the text includes an email address, as it destroys the "+" character, a perfectly valid email address character.<br />
<br />
Unless you're certain that you won't be encoding email addresses AND you need the readability provided by the non-standard "+" usage, instead always use use rawurlencode() or rawurldecode().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89051""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#89051" class="date">19-Feb-2009 05:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
What about this one? A bit more complex but very practically,...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">static function </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// safely cast back already encoded "&amp;" within the query<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">( </span><span class="string">"&amp;amp;"</span><span class="keyword">,</span><span class="string">"&amp;"</span><span class="keyword">,</span><span class="default">$url </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$phpsep </span><span class="keyword">= (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'arg_separator.input'</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">))<br />
?</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'arg_separator.output'</span><span class="keyword">)<br />
:</span><span class="string">"&amp;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// cut optionally anchor<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ancpos </span><span class="keyword">= </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="string">"#"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lasteq </span><span class="keyword">= </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="string">"="</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastsep </span><span class="keyword">= </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="string">"&amp;"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastqsep </span><span class="keyword">= </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="string">"?"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$firstsep </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="string">"?"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// recognize wrong positioned anchor example.php#anchor?asdasd<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$ancpos </span><span class="keyword">!== </span><span class="default">false<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">|| (</span><span class="default">$ancpos </span><span class="keyword">&gt; </span><span class="default">0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">&amp;&amp; (</span><span class="default">$lasteq </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$lasteq </span><span class="keyword">&lt; </span><span class="default">$ancpos </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &amp;&amp; (</span><span class="default">$lastsep </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$lastsep </span><span class="keyword">&lt; </span><span class="default">$ancpos </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &amp;&amp; (</span><span class="default">$lastqsep </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$lastqsep </span><span class="keyword">&lt; </span><span class="default">$ancpos </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$anc </span><span class="keyword">= </span><span class="string">"#" </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$url</span><span class="keyword">,</span><span class="default">$ancpos</span><span class="keyword">+</span><span class="default">1 </span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$url</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$ancpos </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$anc </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// separate uri and query string<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$firstsep </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$qry </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;&nbsp; &nbsp; </span><span class="comment">// no query<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$urlenc </span><span class="keyword">= </span><span class="default">$url</span><span class="keyword">.</span><span class="default">$anc</span><span class="keyword">;&nbsp; </span><span class="comment">// anchor<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$qry </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$url</span><span class="keyword">, </span><span class="default">$firstsep </span><span class="keyword">+ </span><span class="default">1 </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vals </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="string">"&amp;"</span><span class="keyword">, </span><span class="default">$qry </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$valsenc </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$vals </span><span class="keyword">as </span><span class="default">$v </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$buf </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="string">"="</span><span class="keyword">, </span><span class="default">$v </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$buf</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]=</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$buf</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$buf</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]=</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$buf</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$valsenc</span><span class="keyword">[] = </span><span class="default">implode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">$buf</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$urlenc </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$url</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">, </span><span class="default">$firstsep&nbsp; </span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// encoded origin uri<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$urlenc</span><span class="keyword">.= </span><span class="string">"?" </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="default">$phpsep</span><span class="keyword">, </span><span class="default">$valsenc </span><span class="keyword">)&nbsp; &nbsp; </span><span class="comment">// encoded query string<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">. </span><span class="default">$anc</span><span class="keyword">; </span><span class="comment">// anchor<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$urlenc </span><span class="keyword">= </span><span class="default">htmlentities</span><span class="keyword">( </span><span class="default">$urlenc</span><span class="keyword">, </span><span class="default">ENT_QUOTES </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$urlenc</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88712""></a>
  <div class="note">
   <strong class="user">dominik dot hofer at gmx dot net</strong>
   <a href="#88712" class="date">04-Feb-2009 05:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I read a UTF-8 encoded string form a mysql database and wanted to use it as a parameter for<br />
a javascript function which opens a popup window (the HTML site also encoded as UTF-8).<br />
Somehow I had serious trouble with strings containing special characters like ' and especially german umlaute.<br />
When using urlencode(), the umlaute weren't correctly displayed in the popup with IE.<br />
I tried many variations with urlencode(), rawurlencode(), addslashes(), ...,<br />
but none of them was working in all browsers (Safari, FF, IE).<br />
<br />
If someone is experiencing the same problem:<br />
Here is the code I got it finally working with very well in all browsers...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">'&lt;a href="javascript: popup_textanswer(\''</span><span class="keyword">.<br />
</span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$act_question</span><span class="keyword">[</span><span class="string">'questiontext'</span><span class="keyword">]),<br />
</span><span class="default">ENT_QUOTES</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">).<br />
</span><span class="string">'\');"&gt;question&lt;/a&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
the javascript function:<br />
<br />
<span class="default">&lt;?php </span><span class="comment">// actually javascript<br />
</span><span class="keyword">function </span><span class="default">popup_textanswer</span><span class="keyword">(</span><span class="default">questiontext</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">win </span><span class="keyword">= </span><span class="default">window</span><span class="keyword">.</span><span class="default">open</span><span class="keyword">(</span><span class="string">'popup.php?id=1&amp;questiontext=' </span><span class="keyword">+<br />
</span><span class="default">questiontext</span><span class="keyword">, </span><span class="string">'popup'</span><span class="keyword">, </span><span class="string">'width=600,height=400'</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">win</span><span class="keyword">.</span><span class="default">focus</span><span class="keyword">();<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85903""></a>
  <div class="note">
   <strong class="user">Mark Seecof</strong>
   <a href="#85903" class="date">23-Sep-2008 04:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using XMLHttpRequest or another AJAX technique to submit data to a PHP script using GET (or POST with content-type header set to 'x-www-form-urlencoded') you must urlencode your data before you upload it.&nbsp; (In fact, if you don't urlencode POST data MS Internet Explorer may pop a "syntax error" dialog when you call XMLHttpRequest.send().)&nbsp; But, you can't call PHP's urlencode() function in Javascript!&nbsp; In fact, NO native Javascript function will urlencode data correctly for form submission.&nbsp; So here is a function to do the job fairly efficiently:<br />
<br />
<span class="default">&lt;?php </span><span class="comment">/******<br />
<br />
&lt;script type="text/javascript" language="javascript1.6"&gt;<br />
&nbsp;// PHP-compatible urlencode() for Javascript<br />
&nbsp;function urlencode(s) {<br />
&nbsp; s = encodeURIComponent(s);<br />
&nbsp; return s.replace(/~/g,'%7E').replace(/%20/g,'+');<br />
&nbsp;}<br />
<br />
&nbsp;// sample usage:&nbsp; suppose form has text input fields for<br />
&nbsp;// country, postcode, and city with id='country' and so-on.<br />
&nbsp;// We'll use GET to send values of country and postcode<br />
&nbsp;// to "city_lookup.php" asynchronously, then update city<br />
&nbsp;// field in form with the reply (from database lookup)<br />
<br />
&nbsp;function lookup_city() {<br />
&nbsp; var elm_country = document.getElementById('country');<br />
&nbsp; var elm_zip = document.getElementById('postcode');<br />
&nbsp; var elm_city = document.getElementById('city');<br />
&nbsp; var qry = '?country=' + urlencode(elm_country.value) +<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; '&amp;postcode=' + urlencode(elm_zip.value);<br />
&nbsp; var xhr;<br />
&nbsp; try {<br />
&nbsp;&nbsp; xhr = new XMLHttpRequest(); // recent browsers<br />
&nbsp; } catch (e) {<br />
&nbsp;&nbsp; alert('No XMLHttpRequest!');<br />
&nbsp;&nbsp; return;<br />
&nbsp; }<br />
&nbsp; xhr.open('GET',('city_lookup.php'+qry),true);<br />
&nbsp; xhr.onreadystatechange = function(){<br />
&nbsp;&nbsp;&nbsp; if ((xhr.readyState != 4) || (xhr.status != 200)) return;<br />
&nbsp;&nbsp;&nbsp; elm_city.value = xhr.responseText;<br />
&nbsp; }<br />
&nbsp; xhr.send(null);<br />
&nbsp;}<br />
&lt;/script&gt;<br />
<br />
******/ </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85806""></a>
  <div class="note">
   <strong class="user">todd at amiestreet dot com</strong>
   <a href="#85806" class="date">18-Sep-2008 10:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding issues with %2Fs for slashes in encoded URLs, you simply need to enable the AllowEncodedSlashes directive in Apache:<br />
<br />
<a href="http://httpd.apache.org/docs/2.2/mod/core.html#allowencodedslashes" rel="nofollow" target="_blank">http://httpd.apache.org/docs/2.2/mod/core.html#allowencodedslashes</a><br />
<br />
Hope that helps</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85055""></a>
  <div class="note">
   <strong class="user">root at jusme dot org</strong>
   <a href="#85055" class="date">12-Aug-2008 05:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm running PHP version 5.0.5 and urlencode() doesn't seem to encode the "#" character, although the function's description says it encodes "all non-alphanumeric" characters. This was a particular problem for me when trying to open local files with a "#" in the filename as Firefox will interpret this as an anchor target (for better or worse). It seems a manual str_replace is required unless this was fixed in a future PHP version.<br />
<br />
Example:<br />
<br />
$str = str_replace("#", "%23", $str);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83856""></a>
  <div class="note">
   <strong class="user">php dot net at unixen dot dk</strong>
   <a href="#83856" class="date">15-Jun-2008 12:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&gt;&gt; Hi muthuishere , i saw your excellent contribution, but couldnt make it work, so i corrected some bits and pieces and had the following done:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">SmartUrlEncode</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="string">'='</span><span class="keyword">) === </span><span class="default">false</span><span class="keyword">):<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$url</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startpos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="string">"?"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmpurl</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">, </span><span class="default">$startpos</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$qryStr</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$startpos</span><span class="keyword">+</span><span class="default">1 </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$qryvalues</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">, </span><span class="default">$qryStr</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$qryvalues </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">):<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$buffer</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$buffer</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]=</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$buffer</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endforeach;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$finalqrystr</span><span class="keyword">=</span><span class="default">implode</span><span class="keyword">(</span><span class="string">"&amp;amp;"</span><span class="keyword">, &amp;</span><span class="default">$qryvalues</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$finalURL</span><span class="keyword">=</span><span class="default">$tmpurl </span><span class="keyword">. </span><span class="default">$finalqrystr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$finalURL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; endif;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
As you see its very much yours, modfied primarily using '&amp;amp;' instead of '&amp;', and ofcourse an if test to see if anything in input is to be cursed... Thanks for great function !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83693""></a>
  <div class="note">
   <strong class="user">muthuishere at gmail dot com</strong>
   <a href="#83693" class="date">07-Jun-2008 09:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Most of us may need a function<br />
<br />
&nbsp;if they have entire URL but you need to be encoding only the query values&nbsp; , not the URL and not the parameters<br />
<br />
The below function takes an URL as input and applies url encoding only to the parameter values<br />
<br />
/******************************************<br />
<br />
For eg www.google.com/?q=alka rani&amp;start=100&nbsp; <br />
<br />
urlencode<br />
&nbsp;&nbsp; ==&gt;&nbsp; www.google.com/search?q=alka+rani&amp;start=100<br />
<br />
if you change it to rawurlencode<br />
&nbsp; ==&gt;&nbsp; www.google.com/search?q=alka%20rani&amp;start=100<br />
<br />
**************************************/<br />
function SmartUrlEncode($url){<br />
<br />
//Extract the Querystr pos after ? mark<br />
$startpos = stripos($url, "?");<br />
<br />
//Extract the URl alone<br />
$tmpurl=substr($url, 0 , $startpos+1) ;<br />
//echo $tmpurl . "&lt;br&gt;";<br />
<br />
//Extract the Querystr alone<br />
$qryStr=substr($url, $startpos+1 ) ;<br />
<br />
//echo $qryStr . "&lt;br&gt;";<br />
<br />
//Split the querystring into &amp; pairs<br />
&nbsp;$qryvalues=explode("&amp;", $qryStr);<br />
<br />
&nbsp; foreach($qryvalues as&nbsp; &amp;$value)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; //Split the single data into two i.e data&nbsp;&nbsp; |&nbsp; value<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $buffer=explode("=", $value);<br />
<br />
&nbsp;&nbsp;&nbsp; // Urlencode only the value now , Change it to rawurlencode if necessary<br />
&nbsp;&nbsp;&nbsp; $buffer[1]=urlencode($buffer[1]);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; //Join values back in the array<br />
&nbsp;&nbsp;&nbsp; $value = implode("=", $tmp);<br />
&nbsp; <br />
&nbsp; }<br />
&nbsp; //Output Querystr ,Join all the pairs with &amp; <br />
&nbsp; $finalqrystr=implode("&amp;", $qryvalues);<br />
//&nbsp; echo $finalqrystr . "&lt;br&gt;";<br />
<br />
$finalURL=$tmpurl . $finalqrystr;<br />
<br />
//echo $finalURL . "&lt;br&gt;";<br />
<br />
return finalURL;<br />
}<br />
<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82483""></a>
  <div class="note">
   <strong class="user">simon dot rupf at int-ag dot ch</strong>
   <a href="#82483" class="date">12-Apr-2008 03:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Kerdster's function works like a charm. It has only a minor beauty flaw in my humble opinion: It encodes every character, even the plain ascii ones. This just doesn't like nice in the browsers address bar. ;-)<br />
<br />
Inspired by Mkaganer's utf8_urldecode example in urldecode comments here's the enhanced code:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">utf16_urlencode </span><span class="keyword">( </span><span class="default">$str </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># convert characters &gt; 255 into HTML entities<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$convmap </span><span class="keyword">= array( </span><span class="default">0xFF</span><span class="keyword">, </span><span class="default">0x2FFFF</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0xFFFF </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">mb_encode_numericentity</span><span class="keyword">( </span><span class="default">$str</span><span class="keyword">, </span><span class="default">$convmap</span><span class="keyword">, </span><span class="string">"UTF-8"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># escape HTML entities, so they are not urlencoded<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">( </span><span class="string">'/&amp;#([0-9a-fA-F]{2,5});/i'</span><span class="keyword">, </span><span class="string">'mark\\1mark'</span><span class="keyword">, </span><span class="default">$str </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># now convert escaped entities into unicode url syntax<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">( </span><span class="string">'/mark([0-9a-fA-F]{2,5})mark/i'</span><span class="keyword">, </span><span class="string">'%u\\1'</span><span class="keyword">, </span><span class="default">$str </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Probably the above code could be optimized further, comments are highly appreciated!<br />
<br />
Thanks, Simon</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81442""></a>
  <div class="note">
   <strong class="user">kerdster at gmail dot com</strong>
   <a href="#81442" class="date">28-Feb-2008 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&gt; php dot net at samokhvalov dot com<br />
&nbsp;&gt; 12-Dec-2006 09:49<br />
<br />
Thanx for idea!<br />
I have wrote more simple function based on your function to simulate JS function escape (); It uses mb_string functions unstead of iconv.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">utf16urlencode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">'UTF-16'</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">'UTF-16'</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) <br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">'%u'</span><span class="keyword">.</span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="string">'UTF-16'</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$out</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81002""></a>
  <div class="note">
   <strong class="user">rezamilanx at yahoo</strong>
   <a href="#81002" class="date">10-Feb-2008 01:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some people have difficulties with all urlencode and so on solutions. So I decided to solve using base64_encode several times for more security from this way:<br />
<br />
//- First page:<br />
&lt;?<br />
$url='mypage.php';<br />
?&gt;<br />
&lt;a href="index.php?page=&lt;? echo encode($url,5); ?&gt;"&gt;My page&lt;/a&gt;<br />
<br />
//- Second page:<br />
&lt;?<br />
$mypage=$_GET['page'];<br />
$mypage=decode($mypage,5);<br />
echo file_get_contents($mypage);<br />
?&gt;<br />
<br />
*file_get_contents could not run your php scripts see same function<br />
-----------<br />
function encode($ss,$ntime){<br />
&nbsp;&nbsp;&nbsp; for($i=0;$i&lt;$ntime;$i++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $ss=base64_encode($ss);<br />
&nbsp;&nbsp;&nbsp; }<br />
retrun $ss;<br />
}<br />
<br />
function decode($ss,$ntime){<br />
&nbsp;&nbsp;&nbsp; for($i=0;$i&lt;$ntime;$i++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $ss=base64_decode($ss);<br />
&nbsp;&nbsp;&nbsp; }<br />
retrun $ss;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80947""></a>
  <div class="note">
   <strong class="user">randallgirard at hotmail dot com</strong>
   <a href="#80947" class="date">07-Feb-2008 04:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As a reply to: mmj48.com<br />
<br />
Your method of replacing just the slash would be BAD practice... UNLESS, it was used STRICTLY on the PATH part of the URL.<br />
<br />
You must account for the URLQUERIES, but also the scheme, user, password, and fragment characters (:, /, &amp;, #, etc)<br />
However, these may change depending on the environment (mainly refering to the &amp;, query var separator)<br />
<br />
Escaping each of these would also be a bad practice, and impractical. Rather, build a class / tool which will generate your URL's, and render escapes. You could also use the PHP routine: parse_url() for some interesting results.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77590""></a>
  <div class="note">
   <strong class="user">Thomas</strong>
   <a href="#77590" class="date">05-Sep-2007 02:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Reply to 'peter at mailinator dot com'<br />
<br />
If you are having problems using urldecode in PHP following the escape() function in Javascript, try to do a decodeURI() before the escape(). This fixed it for me at least.<br />
<br />
Thomas</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76946""></a>
  <div class="note">
   <strong class="user">mmj48.com</strong>
   <a href="#76946" class="date">07-Aug-2007 08:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
What I use instead:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">escape</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%2F"</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76907""></a>
  <div class="note">
   <strong class="user">ahrensberg at gmail dot com</strong>
   <a href="#76907" class="date">04-Aug-2007 05:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Like "Benjamin dot Bruno at web dot de" earlier has writen, you can have problems with encode strings with special characters to flash. Benjamin write that:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">flash_encode </span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">));<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
... could do the problem. Unfortunately flash still have problems with read some quotations, but with this one:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">flash_encode</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%C2%96"</span><span class="keyword">, </span><span class="string">"-"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%C2%91"</span><span class="keyword">, </span><span class="string">"%27"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%C2%92"</span><span class="keyword">, </span><span class="string">"%27"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%C2%82"</span><span class="keyword">, </span><span class="string">"%27"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%C2%93"</span><span class="keyword">, </span><span class="string">"%22"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%C2%94"</span><span class="keyword">, </span><span class="string">"%22"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%C2%84"</span><span class="keyword">, </span><span class="string">"%22"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%C2%8B"</span><span class="keyword">, </span><span class="string">"%C2%AB"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"%C2%9B"</span><span class="keyword">, </span><span class="string">"%C2%BB"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
... should solve this problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76689""></a>
  <div class="note">
   <strong class="user">mensonge</strong>
   <a href="#76689" class="date">26-Jul-2007 06:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had difficulties with all above solutions. So I applied a dirty simple solution by using:<br />
<br />
base64_encode($param)<br />
and<br />
base64_decode($param)<br />
<br />
The string's length is a bit longer but no more problem with encoding.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73641""></a>
  <div class="note">
   <strong class="user">sebastiaan at netomzet dot nl</strong>
   <a href="#73641" class="date">05-Mar-2007 09:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
quote: "Apache's mod_rewrite and mod_proxy are unable to handle urlencoded URLs properly - <a href="http://issues.apache.org/bugzilla/show_bug.cgi?id=34602" rel="nofollow" target="_blank">http://issues.apache.org/bugzilla/show_bug.cgi?id=34602</a>" <br />
<br />
The most simple solution is to use urlencode twice! <br />
<br />
echo urlencode(urlencode($var));<br />
<br />
Apache's mod_rewrite will handle it like a normal string using urlencode once.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73366""></a>
  <div class="note">
   <strong class="user">in reply to &quot;kL&quot;</strong>
   <a href="#73366" class="date">20-Feb-2007 01:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
kL's example is very bugged since it loops itself and the encode function is two-way.<br />
<br />
Why do you replace all %27 through '&nbsp; in the same string in that you replace all ' through %27?<br />
<br />
Lets say I have a string: Hello %27World%27. It's a nice day.<br />
I get: Hello Hello 'World'. It%27s a nice day.<br />
<br />
With other words that solution is pretty useless.<br />
<br />
Solution:<br />
Just replace ' through %27 when encoding<br />
Just replace %27 through ' when decoding. Or just use url_decode.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73246""></a>
  <div class="note">
   <strong class="user">rm&lt;at&gt;mindbench&lt;dot&gt;nl</strong>
   <a href="#73246" class="date">14-Feb-2007 05:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another thing to keep in mind is that urlencode is not unicode.<br />
<br />
For example, urlencoding enqute from an UTF-8 project will produce enqu%C3%AAte.<br />
<br />
However, urlencode(utf8_decode('enqute')) produces enqu%EAte, like expected.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71712""></a>
  <div class="note">
   <strong class="user">php dot net at samokhvalov dot com</strong>
   <a href="#71712" class="date">12-Dec-2006 05:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Addition to the previous note:<br />
<br />
to make it work on *nix systems (where big-endian byte order in UTF-16 is being used, in contrast to WIN32) add following lines right after the second iconv():<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (strtoupper(substr(PHP_OS, 0, 3)) !== 'WIN') {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $b = $a;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $a[1] = $b[0];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $a[0] = $b[1];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71706""></a>
  <div class="note">
   <strong class="user">php dot net at samokhvalov dot com</strong>
   <a href="#71706" class="date">12-Dec-2006 10:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In AJAX era you might need to use UCS-2 (UTF-16) url-encoding (chars represented in form '%uXXXX' - e.g. '%u043e' for Russian 'o'). But PHP is weak in working with multibyte encoded strings, so you cannot simply use urlencode() for the string in UCS-2. Here is simple function serving for this purpose.<br />
<br />
Note, that this function takes UTF8-encoded string as input and, then, for internal purposes use some 1-byte encoding (cp1251 in my case). If you have the string in some 1-byte encoding, you may remove the first iconv() and modify the second one and thus slightly simplify the function.<br />
<br />
function utf16urlencode($str)<br />
{<br />
&nbsp;&nbsp;&nbsp; $str = iconv("utf-8", "cp1251", $str);<br />
&nbsp;&nbsp;&nbsp; $res = "";<br />
&nbsp;&nbsp;&nbsp; for ($i = 0; $i &lt; strlen($str); $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $res .= "%u";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $a = iconv("cp1251", "ucs-2", $str[$i]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ($j = 0; $j &lt; strlen($a); $j++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $n = dechex(ord($a[$j]));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (strlen($n) == 1) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $n = "0$n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $res .= $n;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $res;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70107""></a>
  <div class="note">
   <strong class="user">Benjamin dot Bruno at web dot de</strong>
   <a href="#70107" class="date">03-Oct-2006 09:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need to prepare strings with special characters (like German Umlaut characters) in order to import them into flash files via GET, try using utf8_encode and rawurlencode sequentially, like this: <br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">function </span><span class="default">flash_encode </span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">) {<br />
&nbsp; return </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Thus, you can avoid having use encodeURI in JavaScript, which is only availabe in JavaScript 1.5.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69466""></a>
  <div class="note">
   <strong class="user">kL</strong>
   <a href="#69466" class="date">06-Sep-2006 05:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Apache's mod_rewrite and mod_proxy are unable to handle urlencoded URLs properly - <a href="http://issues.apache.org/bugzilla/show_bug.cgi?id=34602" rel="nofollow" target="_blank">http://issues.apache.org/bugzilla/show_bug.cgi?id=34602</a><br />
<br />
If you need to use any of these modules and handle paths that contain %2F or %3A (and few other encoded special url characters), you'll have use a different encoding scheme.<br />
<br />
My solution is to replace "%" with "'".<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$u</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">"'"</span><span class="keyword">,</span><span class="string">'%'</span><span class="keyword">),array(</span><span class="string">'%27'</span><span class="keyword">,</span><span class="string">"'"</span><span class="keyword">),</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$u</span><span class="keyword">));<br />
}<br />
<br />
function </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$u</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$u</span><span class="keyword">,</span><span class="string">"'"</span><span class="keyword">,</span><span class="string">'%'</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68668""></a>
  <div class="note">
   <strong class="user">peter at runempire dot com</strong>
   <a href="#68668" class="date">06-Aug-2006 02:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I think this was mentioned earlier but it was confusing.. But I had some problems with the urlencode eating my '/' so I did a simple str_replace like the following:<br />
<br />
$url = urlencode($img);<br />
$img2 = "$url";<br />
$img2 = str_replace('%2F54', '/', $img2);<br />
$img2 = str_replace('+' , '%20' , $img2);<br />
<br />
You don't need to replace the '+' but I just feel comfortable with my %20, although it may present a problem if whatever you're using the str_replace for has a '+' in it where it shouldn't be.<br />
<br />
But that fixed my problem.. all the other encodes like htmlentities and rawurlencode just ate my /'s</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68307""></a>
  <div class="note">
   <strong class="user">peter at mailinator dot com</strong>
   <a href="#68307" class="date">21-Jul-2006 11:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be carefull when using this function with JavaScript escape function.<br />
<br />
In JavaScript when you try to encode utf-8 data with escape function you will get some strange encoded string which you wont be able to decode with php url(de)encode funtions.<br />
<br />
I found a website which has some very good tool regarding this problem: <a href="http://www.webtoolkit.info/" rel="nofollow" target="_blank">http://www.webtoolkit.info/</a><br />
<br />
It has components which deal with url (en)decode.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61243""></a>
  <div class="note">
   <strong class="user">Roamy: info AT roamy DOT de</strong>
   <a href="#61243" class="date">28-Jan-2006 11:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&lt;?// urlencode + urldecode 4 Linux/Unix-Servers:=============<br />
//==================================================<br />
//=====This small script matches all encoded String for ========<br />
//=====Linux/Unix-Servers For IIS it got to be&nbsp; The Other Way&nbsp; ==<br />
//===== around...and remember in a propper Url =============<br />
//===== there shoudn't be the 'dirty Letter': %C3==============<br />
//==================================================<br />
function int2hex($intega){<br />
&nbsp;&nbsp;&nbsp; $Ziffer = "0123456789ABCDEF";<br />
return $Ziffer[($intega%256)/16].$Ziffer[$intega%16];<br />
}<br />
function url_decode($text){<br />
&nbsp;&nbsp;&nbsp; if(!strpos($text,"%C3"))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for($i=129;$i&lt;255;$i++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $in = "%".int2hex($i);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $out = "%C3%".int2hex($i-64);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $text = str_replace($in,$out,$text);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
return urldecode($text);<br />
}<br />
function url_encode($text){<br />
&nbsp;&nbsp;&nbsp; $text = urlencode($text);<br />
&nbsp;&nbsp;&nbsp; if(!strpos($text,"%C3"))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for($i=129;$i&lt;255;$i++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $in = "%".int2hex($i);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $out = "%C3%".int2hex($i-64);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $text = str_replace($in,$out,$text);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
return $text;<br />
}//==================================================<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60551""></a>
  <div class="note">
   <strong class="user">torecs at sfe dot uio dot no</strong>
   <a href="#60551" class="date">10-Jan-2006 03:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This very simple function makes an valid parameters part of an URL, to me it looks like several of the other versions here are decoding wrongly as they do not convert &amp; seperating the variables into &amp;amp;. <br />
<br />
&nbsp; $vars=array('name' =&gt; 'tore','action' =&gt; 'sell&amp;buy');<br />
&nbsp; echo MakeRequestUrl($vars);<br />
&nbsp; <br />
&nbsp; /* Makes an valid html request url by parsing the params array<br />
&nbsp;&nbsp; * @param $params The parameters to be converted into URL with key as name.<br />
&nbsp;&nbsp; */<br />
&nbsp; function MakeRequestUrl($params)<br />
&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $querystring=null;<br />
&nbsp;&nbsp;&nbsp; foreach ($params as $name =&gt; $value)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $querystring=$name.'='.urlencode($value).'&amp;'.$querystring;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; // Cut the last '&amp;'<br />
&nbsp;&nbsp; &nbsp;&nbsp; $querystring=substr($querystring,0,strlen($querystring)-1);<br />
&nbsp;&nbsp; &nbsp;&nbsp; return htmlentities($querystring);<br />
&nbsp; }<br />
<br />
&nbsp; Will output: action=sell%26buy&amp;amp;name=tore</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58964""></a>
  <div class="note">
   <strong class="user">roberlamerma at gmail dot com</strong>
   <a href="#58964" class="date">22-Nov-2005 07:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I rewrote inus at flowingcreativity dot net function to generate an encoded url string from the POST, or GET array. It handles properly POST/GET array vars.<br />
<br />
function _HTTPRequestToString($arr_request, $var_name, $separator='&amp;') {<br />
&nbsp;&nbsp;&nbsp; $ret = "";<br />
&nbsp;&nbsp;&nbsp; if (is_array($arr_request)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($arr_request as $key =&gt; $value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_array($value)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($var_name) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ret .= $this-&gt;_HTTPRequestToString($value, "{$var_name}[{$key}]", $separator);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ret .= $this-&gt;_HTTPRequestToString($value, "{$key}", $separator);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($var_name) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ret .= "{$var_name}[{$key}]=".urlencode($value)."&amp;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ret .= "{$key}=".urlencode($value)."&amp;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!$var_name) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $ret = substr($ret,0,-1);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $ret;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58326""></a>
  <div class="note">
   <strong class="user">Chris</strong>
   <a href="#58326" class="date">31-Oct-2005 08:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just remember that according to W3C standards, you must rawurlencode() the link that's provided at the end of a mailto.<br />
<br />
i.e.<br />
&lt;a href="<a href="mailto:jdoe@some.where.com?Subject=Simple testing(s" rel="nofollow" target="_blank">mailto:jdoe@some.where.com?Subject=Simple testing(s</a>)&amp;bcc=jane@some.where.com"&gt;Mail Me&lt;/a&gt;<br />
<br />
Needs to be escaped (which rawurlencode() does for us).<br />
The colon is OK after "mailto", as is the "@" after the e-mail name.<br />
However, the rest of the URL needs to be encoded, replacing the following:<br />
'?' =&gt; %3F<br />
'=' =&gt; %3D<br />
' ' =&gt; %20<br />
'(' =&gt; %28<br />
')' =&gt; %29<br />
'&amp;' =&gt; %26<br />
'@' =&gt; %40 (note this one is in 'jane@some.where.com'<br />
<br />
I tried to post the note with the correct text (that is the characters replaced in the note), but it said that there was a line that was too long, and so wouldn't let me add the note.<br />
<br />
As a secondary note, I noticed that the auto-conversion routines at this site itself stopped the link at the space after "Simple testing(s)' in the first entry shown above.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56426""></a>
  <div class="note">
   <strong class="user">bisqwit at iki dot fi</strong>
   <a href="#56426" class="date">02-Sep-2005 01:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Constructing hyperlinks safely HOW-TO:<br />
<br />
<span class="default">&lt;?php<br />
$path_component </span><span class="keyword">= </span><span class="string">'machine/generated/part'</span><span class="keyword">;<br />
</span><span class="default">$url_parameter1 </span><span class="keyword">= </span><span class="string">'this is a string'</span><span class="keyword">;<br />
</span><span class="default">$url_parameter2 </span><span class="keyword">= </span><span class="string">'special/weird "$characters"'</span><span class="keyword">;<br />
<br />
</span><span class="default">$url </span><span class="keyword">= </span><span class="string">'<a href="http://example.com/lab/cgi/test/" rel="nofollow" target="_blank">http://example.com/lab/cgi/test/</a>'</span><span class="keyword">. </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$path_component</span><span class="keyword">) . </span><span class="string">'?param1=' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$url_parameter1</span><span class="keyword">) . </span><span class="string">'&amp;param2=' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$url_parameter2</span><span class="keyword">);<br />
<br />
</span><span class="default">$link_label </span><span class="keyword">= </span><span class="string">"Click here &amp; you'll be &lt;happy&gt;"</span><span class="keyword">;<br />
<br />
echo </span><span class="string">'&lt;a href="'</span><span class="keyword">, </span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">), </span><span class="string">'"&gt;'</span><span class="keyword">, </span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">$link_label</span><span class="keyword">), </span><span class="string">'&lt;/a&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
This example covers all the encodings you need to apply in order to create URLs safely without problems with any special characters. It is stunning how many people make mistakes with this.<br />
<br />
Shortly:<br />
- Use urlencode for all GET parameters (things that come after each "=").<br />
- Use rawurlencode for parts that come before "?".<br />
- Use htmlspecialchars for HTML tag parameters and HTML text content.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56181""></a>
  <div class="note">
   <strong class="user">R Mortimer</strong>
   <a href="#56181" class="date">26-Aug-2005 01:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Do not let the browser auto encode an invalid URL. Not all browsers perform the same encodeing. Keep it cross browser do it server side.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55770""></a>
  <div class="note">
   <strong class="user">Bachsau</strong>
   <a href="#55770" class="date">12-Aug-2005 10:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Diferrent from the above example you do not have to encode URLs in hrefs with this. The browser does it automaticaly, so you just have to encode it with htmlentities() ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54439""></a>
  <div class="note">
   <strong class="user">linus at flowingcreativity dot net</strong>
   <a href="#54439" class="date">04-Jul-2005 09:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just came across the need for a function that exports an array into a query string. Being able to use urlencode($theArray) would be nice, but here's what I came up with:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">urlencode_array</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// the array value<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$varName</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// variable name to be used in the query string<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$separator </span><span class="keyword">= </span><span class="string">'&amp;'&nbsp; &nbsp; </span><span class="comment">// what separating character to use in the query string<br />
</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$toImplode </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$var </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$toImplode</span><span class="keyword">[] = </span><span class="default">urlencode_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="string">"</span><span class="keyword">{</span><span class="default">$varName</span><span class="keyword">}</span><span class="string">[</span><span class="keyword">{</span><span class="default">$key</span><span class="keyword">}</span><span class="string">]"</span><span class="keyword">, </span><span class="default">$separator</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$toImplode</span><span class="keyword">[] = </span><span class="string">"</span><span class="keyword">{</span><span class="default">$varName</span><span class="keyword">}</span><span class="string">[</span><span class="keyword">{</span><span class="default">$key</span><span class="keyword">}</span><span class="string">]="</span><span class="keyword">.</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="default">$separator</span><span class="keyword">, </span><span class="default">$toImplode</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This function supports n-dimensional arrays (it encodes recursively).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51942""></a>
  <div class="note">
   <strong class="user">edwardzyang at thewritingpot dot com</strong>
   <a href="#51942" class="date">15-Apr-2005 01:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was testing my input sanitation with some strange character entities. Ones like  and  were passed correctly and were in their raw form when I passed them through without any filtering.<br />
<br />
However, some weird things happen when dealing with characters like (these are HTML entities): &amp;#8252; &amp;#9616; &amp;#9488;and &amp;#920; have weird things going on.<br />
<br />
If you try to pass one in Internet Explorer, IE will *disable* the submit button. Firefox, however, does something weirder: it will convert it to it's HTML entity. It will display properly, but only when you don't convert entities.<br />
<br />
The point? Be careful with decorative characters.<br />
<br />
PS: If you try copy/pasting one of these characters to a TXT file, it will translate to a ?.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50079""></a>
  <div class="note">
   <strong class="user">Timwi</strong>
   <a href="#50079" class="date">17-Feb-2005 03:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The information on this page is misleading in that you might think the ampersand (&amp;) will only need to be escaped as &amp;amp; when there is ambiguity with an existing character entity. This is false; the W3C page linked to from here clarifies that the ampersands must ALWAYS be escaped.<br />
<br />
The following:<br />
<br />
&nbsp; &lt;a href='/script.php?variable1=value1&amp;variable2=value2'&gt;Link&lt;/a&gt;<br />
<br />
is INVALID HTML. It needs to be written as:<br />
<br />
&nbsp; &lt;a href='/script.php?variable1=value1&amp;amp;variable2=value2'&gt;Link&lt;/a&gt;<br />
<br />
in order for the link to go to:<br />
<br />
&nbsp; /script.php?variable1=value1&amp;variable2=value2<br />
<br />
I applaud the W3C's recommendation to use semicolons (';') instead of the ampersands, but it doesn't really change the fact that you still need to HTML-escape the value of all your HTML tag attributes. The following:<br />
<br />
&nbsp; &lt;span title='Rose &amp; Mary'&gt;Some text&lt;/span&gt;<br />
<br />
is also INVALID HTML. It needs to be escaped as:<br />
<br />
&nbsp; &lt;span title='Rose &amp;amp; Mary'&gt;Some text&lt;/span&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47132""></a>
  <div class="note">
   <strong class="user">george at ishop dot com</strong>
   <a href="#47132" class="date">04-Nov-2004 01:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
---[ Editor's Note ]---<br />
You can also use rawurlencode() here, and skip the functions provided in this note.<br />
---[ /Editor's Nore]---<br />
<br />
For handling slashes in redirections, (see comment from cameron at enprises dot com), try this :<br />
<br />
function myurlencode ( $TheVal )<br />
{<br />
&nbsp;return urlencode (str_replace("/","%2f",$TheVal));<br />
}<br />
<br />
function myurldecode ( $TheVal )<br />
{<br />
&nbsp;return str_replace("%2f","/",urldecode ($TheVal));<br />
} <br />
<br />
This is effectively a double urlencode for slashes and single urlencode for everything else.&nbsp; So, it is more "standardised" than his suggestion of using a + sign, and more readable (and search engine indexable) than a full double encode/decode.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45769""></a>
  <div class="note">
   <strong class="user">neugey at cox dot net</strong>
   <a href="#45769" class="date">17-Sep-2004 01:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful when encoding strings that came from simplexml in PHP 5.&nbsp; If you try to urlencode a simplexml object, the script tanks.<br />
<br />
I got around the problem by using a cast.<br />
<br />
$newValue = urlencode( (string) $oldValue );</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45499""></a>
  <div class="note">
   <strong class="user">monty3 at hotmail dot com</strong>
   <a href="#45499" class="date">09-Sep-2004 01:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to pass a url with parameters as a value IN a url AND through a javascript function, such as...<br />
<br />
&nbsp;&nbsp; &lt;a href="javascript:openWin('page.php?url=index.php?id=4&amp;pg=2');"&gt;<br />
<br />
...pass the url value through the PHP urlencode() function twice, like this...<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp; $url </span><span class="keyword">= </span><span class="string">"index.php?id=4&amp;pg=2"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; echo </span><span class="string">"&lt;a href=\"javascript:openWin('page.php?url=</span><span class="default">$url</span><span class="string">');\"&gt;"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
On the page being opened by the javascript function (page.php), you only need to urldecode() once, because when javascript 'touches' the url that passes through it, it decodes the url once itself. So, just decode it once more in your PHP script to fully undo the double-encoding...<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp; $url </span><span class="keyword">= </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'url'</span><span class="keyword">]);<br />
</span><span class="default">?&gt;<br />
</span><br />
If you don't do this, you'll find that the result url value in the target script is missing all the var=values following the ? question mark...<br />
<br />
&nbsp;&nbsp; index.php?id=4</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25822""></a>
  <div class="note">
   <strong class="user">issue9mm at leafapplication dot com</strong>
   <a href="#25822" class="date">07-Oct-2002 06:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a simple comment, really, but if you need to encode apostrophes, you should be using rawurlencode as opposed to just urlencode. <br />
<br />
Naturally, I figured that out the hard way.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.urldecode.html">urldecode</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="book.v8js.html">V8js</a></div>
 <div class="up"><a href="ref.url.html">URL Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

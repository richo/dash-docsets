<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Calculate Levenshtein distance between two strings</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.lcfirst.html">lcfirst</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.localeconv.html">localeconv</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.levenshtein" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">levenshtein</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.1, PHP 5)</p><p class="refpurpose"><span class="refname">levenshtein</span> &mdash; <span class="dc-title">Calculate Levenshtein distance between two strings</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.levenshtein-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><b>levenshtein</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$str1</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$str2</tt></span>
   )</div>

  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><b>levenshtein</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$str1</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$str2</tt></span>
   , <span class="methodparam"><span class="type">int</span> <tt class="parameter">$cost_ins</tt></span>
   , <span class="methodparam"><span class="type">int</span> <tt class="parameter">$cost_rep</tt></span>
   , <span class="methodparam"><span class="type">int</span> <tt class="parameter">$cost_del</tt></span>
   )</div>

  <p class="para rdfs-comment">
   The Levenshtein distance is defined as the minimal number of
   characters you have to replace, insert or delete to transform
   <i><tt class="parameter">str1</tt></i> into <i><tt class="parameter">str2</tt></i>.
   The complexity of the algorithm is <i>O(m*n)</i>,
   where <i>n</i> and <i>m</i> are the
   length of <i><tt class="parameter">str1</tt></i> and
   <i><tt class="parameter">str2</tt></i> (rather good when compared to
   <span class="function"><a href="function.similar-text.html" class="function">similar_text()</a></span>, which is O(max(n,m)**3),
   but still expensive).
  </p>
  <p class="para">
   In its simplest form the function will take only the two
   strings as parameter and will calculate just the number of
   insert, replace and delete operations needed to transform
   <i><tt class="parameter">str1</tt></i> into <i><tt class="parameter">str2</tt></i>.
  </p>
  <p class="para">
   A second variant will take three additional parameters that
   define the cost of insert, replace and delete operations.  This
   is more general and adaptive than variant one, but not as
   efficient.
  </p>
 </div>


<div class="refsect1 parameters" id="refsect1-function.levenshtein-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">str1</tt></i></span>
     <dd>

      <p class="para">
       One of the strings being evaluated for Levenshtein distance.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">str2</tt></i></span>
     <dd>

      <p class="para">
       One of the strings being evaluated for Levenshtein distance.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">cost_ins</tt></i></span>
     <dd>

      <p class="para">
       Defines the cost of insertion.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">cost_rep</tt></i></span>
     <dd>

      <p class="para">
       Defines the cost of replacement.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">cost_del</tt></i></span>
     <dd>

      <p class="para">
       Defines the cost of deletion.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.levenshtein-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   This function returns the Levenshtein-Distance between the
   two argument strings or -1, if one of the argument strings
   is longer than the limit of 255 characters.
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.levenshtein-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-4389">
    <p><b>Example #1 <span class="function"><b>levenshtein()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;input&nbsp;misspelled&nbsp;word<br /></span><span style="color: #0000BB">$input&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'carrrot'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;array&nbsp;of&nbsp;words&nbsp;to&nbsp;check&nbsp;against<br /></span><span style="color: #0000BB">$words&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'apple'</span><span style="color: #007700">,</span><span style="color: #DD0000">'pineapple'</span><span style="color: #007700">,</span><span style="color: #DD0000">'banana'</span><span style="color: #007700">,</span><span style="color: #DD0000">'orange'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'radish'</span><span style="color: #007700">,</span><span style="color: #DD0000">'carrot'</span><span style="color: #007700">,</span><span style="color: #DD0000">'pea'</span><span style="color: #007700">,</span><span style="color: #DD0000">'bean'</span><span style="color: #007700">,</span><span style="color: #DD0000">'potato'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;no&nbsp;shortest&nbsp;distance&nbsp;found,&nbsp;yet<br /></span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;loop&nbsp;through&nbsp;words&nbsp;to&nbsp;find&nbsp;the&nbsp;closest<br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$words&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$word</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;calculate&nbsp;the&nbsp;distance&nbsp;between&nbsp;the&nbsp;input&nbsp;word,<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;and&nbsp;the&nbsp;current&nbsp;word<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$lev&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">levenshtein</span><span style="color: #007700">(</span><span style="color: #0000BB">$input</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$word</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;check&nbsp;for&nbsp;an&nbsp;exact&nbsp;match<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$lev&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;closest&nbsp;word&nbsp;is&nbsp;this&nbsp;one&nbsp;(exact&nbsp;match)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$closest&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$word</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;break&nbsp;out&nbsp;of&nbsp;the&nbsp;loop;&nbsp;we've&nbsp;found&nbsp;an&nbsp;exact&nbsp;match<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">break;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;if&nbsp;this&nbsp;distance&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;next&nbsp;found&nbsp;shortest<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;distance,&nbsp;OR&nbsp;if&nbsp;a&nbsp;next&nbsp;shortest&nbsp;word&nbsp;has&nbsp;not&nbsp;yet&nbsp;been&nbsp;found<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$lev&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;set&nbsp;the&nbsp;closest&nbsp;match,&nbsp;and&nbsp;shortest&nbsp;distance<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$closest&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$word</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$lev</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />echo&nbsp;</span><span style="color: #DD0000">"Input&nbsp;word:&nbsp;</span><span style="color: #0000BB">$input</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />if&nbsp;(</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Exact&nbsp;match&nbsp;found:&nbsp;</span><span style="color: #0000BB">$closest</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Did&nbsp;you&nbsp;mean:&nbsp;</span><span style="color: #0000BB">$closest</span><span style="color: #DD0000">?\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Input word: carrrot
Did you mean: carrot?
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.levenshtein-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.soundex.html" class="function" rel="rdfs-seeAlso">soundex()</a> - Calculate the soundex key of a string</span></li>
    <li class="member"><span class="function"><a href="function.similar-text.html" class="function" rel="rdfs-seeAlso">similar_text()</a> - Calculate the similarity between two strings</span></li>
    <li class="member"><span class="function"><a href="function.metaphone.html" class="function" rel="rdfs-seeAlso">metaphone()</a> - Calculate the metaphone key of a string</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="107114""></a>
  <div class="note">
   <strong class="user">engineglue at gmail dot com</strong>
   <a href="#107114" class="date">08-Jan-2012 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I really like [the manual's] example for the use of the levenshtein function to match against an array. I ran into the need to specify the sensitivity of the result. There are circumstances when you want it to return false if the match is way out of line. I wouldn't want "marry had a little lamb" to match with "saw viii" simply because it was the best match in the array. Hence the need for sensitivity:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">wordMatch</span><span class="keyword">(</span><span class="default">$words</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">, </span><span class="default">$sensitivity</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$words </span><span class="keyword">as </span><span class="default">$word</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lev </span><span class="keyword">= </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$word</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">&lt;= </span><span class="default">$shortest </span><span class="keyword">|| </span><span class="default">$shortest </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest&nbsp; </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">$lev</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$shortest </span><span class="keyword">&lt;= </span><span class="default">$sensitivity</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$closest</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word </span><span class="keyword">= </span><span class="string">'PINEEEEAPPLE'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$words&nbsp; </span><span class="keyword">= array(</span><span class="string">'apple'</span><span class="keyword">,</span><span class="string">'pineapple'</span><span class="keyword">,</span><span class="string">'banana'</span><span class="keyword">,</span><span class="string">'orange'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'radish'</span><span class="keyword">,</span><span class="string">'carrot'</span><span class="keyword">,</span><span class="string">'pea'</span><span class="keyword">,</span><span class="string">'bean'</span><span class="keyword">,</span><span class="string">'potato'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">wordMatch</span><span class="keyword">(</span><span class="default">$words</span><span class="keyword">, </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">), </span><span class="default">2</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106381""></a>
  <div class="note">
   <strong class="user">Chaim Chaikin</strong>
   <a href="#106381" class="date">02-Nov-2011 11:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As regards to Example #1 above, would it not be more efficient to first use a simple php == comparison to check if the strings are equal even before testing the word with levenshtein().<br />
<br />
Something like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// input misspelled word<br />
</span><span class="default">$input </span><span class="keyword">= </span><span class="string">'carrrot'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// array of words to check against<br />
</span><span class="default">$words&nbsp; </span><span class="keyword">= array(</span><span class="string">'apple'</span><span class="keyword">,</span><span class="string">'pineapple'</span><span class="keyword">,</span><span class="string">'banana'</span><span class="keyword">,</span><span class="string">'orange'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'radish'</span><span class="keyword">,</span><span class="string">'carrot'</span><span class="keyword">,</span><span class="string">'pea'</span><span class="keyword">,</span><span class="string">'bean'</span><span class="keyword">,</span><span class="string">'potato'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// no shortest distance found, yet<br />
</span><span class="default">$shortest </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;<br />
<br />
</span><span class="comment">// loop through words to find the closest<br />
</span><span class="keyword">foreach (</span><span class="default">$words </span><span class="keyword">as </span><span class="default">$word</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// check for an exact match<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$input </span><span class="keyword">== </span><span class="default">$word</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// closest word is this one (exact match)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// break out of the loop; we've found an exact match<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// calculate the distance between the input word,<br />
&nbsp;&nbsp;&nbsp; // and the current word<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lev </span><span class="keyword">= </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$word</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// if this distance is less than the next found shortest<br />
&nbsp;&nbsp;&nbsp; // distance, OR if a next shortest word has not yet been found<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$lev </span><span class="keyword">&lt;= </span><span class="default">$shortest </span><span class="keyword">|| </span><span class="default">$shortest </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// set the closest match, and shortest distance<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest&nbsp; </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">$lev</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
echo </span><span class="string">"Input word: </span><span class="default">$input</span><span class="string">\n"</span><span class="keyword">;<br />
if (</span><span class="default">$shortest </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Exact match found: </span><span class="default">$closest</span><span class="string">\n"</span><span class="keyword">;<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Did you mean: </span><span class="default">$closest</span><span class="string">?\n"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101084""></a>
  <div class="note">
   <strong class="user">andrejs at gmail</strong>
   <a href="#101084" class="date">24-Nov-2010 06:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A ported version of the memory efficient implementation by Sten Hjelmqvist at <a href="http://www.codeproject.com/KB/recipes/Levenshtein.aspx - works 1.5x faster than previous versions posted here (44s vs 63s on 2.5KB strings" rel="nofollow" target="_blank">http://www.codeproject.com/KB/recipes/Levenshtein.aspx - works 1.5x faster than previous versions posted here (44s vs 63s on 2.5KB strings</a>). If you don't care about UTF, you can substitute mb_substr for array-like access and get even faster (24s on the same test set).<br />
<br />
I also added trimming of common beginning and end so you can save up to 99% more time â€” in case of small edits inside large texts.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">levenshteinDistance2</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$str2</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$len1 </span><span class="keyword">= </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$len2 </span><span class="keyword">= </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// strip common prefix<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; do {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) != </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$len1</span><span class="keyword">--;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$len2</span><span class="keyword">--;<br />
&nbsp;&nbsp;&nbsp; } while(</span><span class="default">$len1 </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$len2 </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str1 </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str2 </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// strip common suffix<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; do {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$len1</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) != </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">, </span><span class="default">$len2</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$len1</span><span class="keyword">--;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$len2</span><span class="keyword">--;<br />
&nbsp;&nbsp;&nbsp; } while(</span><span class="default">$len1 </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$len2 </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str1 </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$len1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str2 </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$len2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$len1 </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$len2</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$len2 </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$len1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$v0 </span><span class="keyword">= </span><span class="default">range</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$len1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$v1 </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">$len2</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v1</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str2j </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">, </span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$j </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt;= </span><span class="default">$len1</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cost </span><span class="keyword">= (</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) == </span><span class="default">$str2j</span><span class="keyword">) ? </span><span class="default">0 </span><span class="keyword">: </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$m_min </span><span class="keyword">= </span><span class="default">$v0</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">$v1</span><span class="keyword">[</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">$v0</span><span class="keyword">[</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">$cost</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$b </span><span class="keyword">&lt; </span><span class="default">$m_min</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$m_min </span><span class="keyword">= </span><span class="default">$b</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$c </span><span class="keyword">&lt; </span><span class="default">$m_min</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$m_min </span><span class="keyword">= </span><span class="default">$c</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v1</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">] = </span><span class="default">$m_min</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vTmp </span><span class="keyword">= </span><span class="default">$v0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v0 </span><span class="keyword">= </span><span class="default">$v1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v1 </span><span class="keyword">= </span><span class="default">$vTmp</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$v0</span><span class="keyword">[</span><span class="default">$len1</span><span class="keyword">];<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87175""></a>
  <div class="note">
   <strong class="user">paulroweatinamedotcom</strong>
   <a href="#87175" class="date">22-Nov-2008 08:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Once again, some testing (with thanks to Tiago) showed me that there was still an error in the code.&nbsp; It wasn't coming up with the right distance when a deletion was involved.&nbsp; This is because there was an error in the way that the distance array was instantiated.&nbsp; (Also, my thanks to the editor for making this easier on everyone involved.)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
* This function starts out with several checks in an attempt to save time.<br />
*&nbsp;&nbsp; 1.&nbsp; The shorter string is always used as the "right-hand" string (as the size of the array is based on its length). <br />
*&nbsp;&nbsp; 2.&nbsp; If the left string is empty, the length of the right is returned.<br />
*&nbsp;&nbsp; 3.&nbsp; If the right string is empty, the length of the left is returned.<br />
*&nbsp;&nbsp; 4.&nbsp; If the strings are equal, a zero-distance is returned.<br />
*&nbsp;&nbsp; 5.&nbsp; If the left string is contained within the right string, the difference in length is returned.<br />
*&nbsp;&nbsp; 6.&nbsp; If the right string is contained within the left string, the difference in length is returned.<br />
* If none of the above conditions were met, the Levenshtein algorithm is used.<br />
*/ <br />
&nbsp; </span><span class="keyword">function </span><span class="default">LevenshteinDistance</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">, </span><span class="default">$s2</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nLeftLength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nRightLength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$nLeftLength </span><span class="keyword">&gt;= </span><span class="default">$nRightLength</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$sLeft </span><span class="keyword">= </span><span class="default">$s1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$sRight </span><span class="keyword">= </span><span class="default">$s2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$sLeft </span><span class="keyword">= </span><span class="default">$s2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$sRight </span><span class="keyword">= </span><span class="default">$s1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$nLeftLength </span><span class="keyword">+= </span><span class="default">$nRightLength</span><span class="keyword">;&nbsp; </span><span class="comment">//&nbsp; arithmetic swap of two values<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$nRightLength </span><span class="keyword">= </span><span class="default">$nLeftLength </span><span class="keyword">- </span><span class="default">$nRightLength</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$nLeftLength </span><span class="keyword">-= </span><span class="default">$nRightLength</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$nLeftLength </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$nRightLength</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else if (</span><span class="default">$nRightLength </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$nLeftLength</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else if (</span><span class="default">$sLeft </span><span class="keyword">=== </span><span class="default">$sRight</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else if ((</span><span class="default">$nLeftLength </span><span class="keyword">&lt; </span><span class="default">$nRightLength</span><span class="keyword">) &amp;&amp; (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$sRight</span><span class="keyword">, </span><span class="default">$sLeft</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$nRightLength </span><span class="keyword">- </span><span class="default">$nLeftLength</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else if ((</span><span class="default">$nRightLength </span><span class="keyword">&lt; </span><span class="default">$nLeftLength</span><span class="keyword">) &amp;&amp; (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$sLeft</span><span class="keyword">, </span><span class="default">$sRight</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$nLeftLength </span><span class="keyword">- </span><span class="default">$nRightLength</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance </span><span class="keyword">= </span><span class="default">range</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$nRightLength</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; for (</span><span class="default">$nLeftPos </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$nLeftPos </span><span class="keyword">&lt;= </span><span class="default">$nLeftLength</span><span class="keyword">; ++</span><span class="default">$nLeftPos</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cLeft </span><span class="keyword">= </span><span class="default">$sLeft</span><span class="keyword">[</span><span class="default">$nLeftPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nDiagonal </span><span class="keyword">= </span><span class="default">$nLeftPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$nLeftPos</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$nRightPos </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$nRightPos </span><span class="keyword">&lt;= </span><span class="default">$nRightLength</span><span class="keyword">; ++</span><span class="default">$nRightPos</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cRight </span><span class="keyword">= </span><span class="default">$sRight</span><span class="keyword">[</span><span class="default">$nRightPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nCost </span><span class="keyword">= (</span><span class="default">$cRight </span><span class="keyword">== </span><span class="default">$cLeft</span><span class="keyword">) ? </span><span class="default">0 </span><span class="keyword">: </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nNewDiagonal </span><span class="keyword">= </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos</span><span class="keyword">] =<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">min</span><span class="keyword">(</span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nDiagonal </span><span class="keyword">+ </span><span class="default">$nCost</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nDiagonal </span><span class="keyword">= </span><span class="default">$nNewDiagonal</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightLength</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85387""></a>
  <div class="note">
   <strong class="user">paulrowe at iname dot com</strong>
   <a href="#85387" class="date">27-Aug-2008 05:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[EDITOR'S NOTE: original post and 2 corrections combined into 1 -- mgf]<br />
<br />
Here is an implementation of the Levenshtein Distance calculation that only uses a one-dimensional array and doesn't have a limit to the string length. This implementation was inspired by maze generation algorithms that also use only one-dimensional arrays.<br />
<br />
I have tested this function with two 532-character strings and it completed in 0.6-0.8 seconds. <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
* This function starts out with several checks in an attempt to save time.<br />
*&nbsp;&nbsp; 1.&nbsp; The shorter string is always used as the "right-hand" string (as the size of the array is based on its length).&nbsp; <br />
*&nbsp;&nbsp; 2.&nbsp; If the left string is empty, the length of the right is returned.<br />
*&nbsp;&nbsp; 3.&nbsp; If the right string is empty, the length of the left is returned.<br />
*&nbsp;&nbsp; 4.&nbsp; If the strings are equal, a zero-distance is returned.<br />
*&nbsp;&nbsp; 5.&nbsp; If the left string is contained within the right string, the difference in length is returned.<br />
*&nbsp;&nbsp; 6.&nbsp; If the right string is contained within the left string, the difference in length is returned.<br />
* If none of the above conditions were met, the Levenshtein algorithm is used.<br />
*/<br />
</span><span class="keyword">function </span><span class="default">LevenshteinDistance</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">, </span><span class="default">$s2</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$sLeft </span><span class="keyword">= (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">) &gt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s2</span><span class="keyword">)) ? </span><span class="default">$s1 </span><span class="keyword">: </span><span class="default">$s2</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$sRight </span><span class="keyword">= (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">) &gt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s2</span><span class="keyword">)) ? </span><span class="default">$s2 </span><span class="keyword">: </span><span class="default">$s1</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$nLeftLength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$sLeft</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$nRightLength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$sRight</span><span class="keyword">);<br />
&nbsp; if (</span><span class="default">$nLeftLength </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nRightLength</span><span class="keyword">;<br />
&nbsp; else if (</span><span class="default">$nRightLength </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nLeftLength</span><span class="keyword">;<br />
&nbsp; else if (</span><span class="default">$sLeft </span><span class="keyword">=== </span><span class="default">$sRight</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; else if ((</span><span class="default">$nLeftLength </span><span class="keyword">&lt; </span><span class="default">$nRightLength</span><span class="keyword">) &amp;&amp; (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$sRight</span><span class="keyword">, </span><span class="default">$sLeft</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nRightLength </span><span class="keyword">- </span><span class="default">$nLeftLength</span><span class="keyword">;<br />
&nbsp; else if ((</span><span class="default">$nRightLength </span><span class="keyword">&lt; </span><span class="default">$nLeftLength</span><span class="keyword">) &amp;&amp; (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$sLeft</span><span class="keyword">, </span><span class="default">$sRight</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nLeftLength </span><span class="keyword">- </span><span class="default">$nRightLength</span><span class="keyword">;<br />
&nbsp; else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nsDistance </span><span class="keyword">= </span><span class="default">range</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">$nRightLength </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$nLeftPos </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$nLeftPos </span><span class="keyword">&lt;= </span><span class="default">$nLeftLength</span><span class="keyword">; ++</span><span class="default">$nLeftPos</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$cLeft </span><span class="keyword">= </span><span class="default">$sLeft</span><span class="keyword">[</span><span class="default">$nLeftPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$nDiagonal </span><span class="keyword">= </span><span class="default">$nLeftPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$nLeftPos</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; for (</span><span class="default">$nRightPos </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$nRightPos </span><span class="keyword">&lt;= </span><span class="default">$nRightLength</span><span class="keyword">; ++</span><span class="default">$nRightPos</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cRight </span><span class="keyword">= </span><span class="default">$sRight</span><span class="keyword">[</span><span class="default">$nRightPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nCost </span><span class="keyword">= (</span><span class="default">$cRight </span><span class="keyword">== </span><span class="default">$cLeft</span><span class="keyword">) ? </span><span class="default">0 </span><span class="keyword">: </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nNewDiagonal </span><span class="keyword">= </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos</span><span class="keyword">] = <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">min</span><span class="keyword">(</span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nDiagonal </span><span class="keyword">+ </span><span class="default">$nCost</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nDiagonal </span><span class="keyword">= </span><span class="default">$nNewDiagonal</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightLength</span><span class="keyword">];<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83501""></a>
  <div class="note">
   <strong class="user">luka8088 at gmail dot com</strong>
   <a href="#83501" class="date">28-May-2008 01:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple levenshtein function without string length limit ...<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">levenshtein2</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$str2</span><span class="keyword">, </span><span class="default">$cost_ins </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$cost_rep </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$cost_del </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$d </span><span class="keyword">= </span><span class="default">array_fill</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">, </span><span class="default">array_fill</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$j </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">] = </span><span class="default">$j</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$j </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$str1</span><span class="keyword">{</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">} == </span><span class="default">$str2</span><span class="keyword">{</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">})<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">] = </span><span class="default">min</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">][</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">$c</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$ret</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82605""></a>
  <div class="note">
   <strong class="user">atx dot antrax at gmail dot com</strong>
   <a href="#82605" class="date">17-Apr-2008 02:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have made a function that removes the length-limit of levenshtein function and ajust the result with similar_text:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">_similar</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$str2</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$strlen1</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$strlen2</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$max</span><span class="keyword">=</span><span class="default">max</span><span class="keyword">(</span><span class="default">$strlen1</span><span class="keyword">, </span><span class="default">$strlen2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$splitSize</span><span class="keyword">=</span><span class="default">250</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$max</span><span class="keyword">&gt;</span><span class="default">$splitSize</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lev</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$cont</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$cont</span><span class="keyword">&lt;</span><span class="default">$max</span><span class="keyword">;</span><span class="default">$cont</span><span class="keyword">+=</span><span class="default">$splitSize</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$strlen1</span><span class="keyword">&lt;=</span><span class="default">$cont </span><span class="keyword">|| </span><span class="default">$strlen2</span><span class="keyword">&lt;=</span><span class="default">$cont</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lev</span><span class="keyword">=</span><span class="default">$lev</span><span class="keyword">/(</span><span class="default">$max</span><span class="keyword">/</span><span class="default">min</span><span class="keyword">(</span><span class="default">$strlen1</span><span class="keyword">,</span><span class="default">$strlen2</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lev</span><span class="keyword">+=</span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">,</span><span class="default">$cont</span><span class="keyword">,</span><span class="default">$splitSize</span><span class="keyword">), </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">,</span><span class="default">$cont</span><span class="keyword">,</span><span class="default">$splitSize</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lev</span><span class="keyword">=</span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$str2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$porcentage</span><span class="keyword">= -</span><span class="default">100</span><span class="keyword">*</span><span class="default">$lev</span><span class="keyword">/</span><span class="default">$max</span><span class="keyword">+</span><span class="default">100</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$porcentage</span><span class="keyword">&gt;</span><span class="default">75</span><span class="keyword">)</span><span class="comment">//Ajustar con similar_text<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">similar_text</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">,</span><span class="default">$str2</span><span class="keyword">,</span><span class="default">$porcentage</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$porcentage</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81046""></a>
  <div class="note">
   <strong class="user">dale3h</strong>
   <a href="#81046" class="date">12-Feb-2008 08:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using PHP's example along with Patrick's comparison percentage function, I have come up with a function that returns the closest word from an array, and assigns the percentage to a referenced variable:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">function </span><span class="default">closest_word</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$words</span><span class="keyword">, &amp;</span><span class="default">$percent </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$words </span><span class="keyword">as </span><span class="default">$word</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$lev </span><span class="keyword">= </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$word</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">&lt;= </span><span class="default">$shortest </span><span class="keyword">|| </span><span class="default">$shortest </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest&nbsp; </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">$lev</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$percent </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">- </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$closest</span><span class="keyword">) / </span><span class="default">max</span><span class="keyword">(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">), </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$closest</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$closest</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Usage:<br />
<span class="default">&lt;?php<br />
&nbsp; $input </span><span class="keyword">= </span><span class="string">'carrrot'</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$words </span><span class="keyword">= array(</span><span class="string">'apple'</span><span class="keyword">,</span><span class="string">'pineapple'</span><span class="keyword">,</span><span class="string">'banana'</span><span class="keyword">,</span><span class="string">'orange'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'radish'</span><span class="keyword">,</span><span class="string">'carrot'</span><span class="keyword">,</span><span class="string">'pea'</span><span class="keyword">,</span><span class="string">'bean'</span><span class="keyword">,</span><span class="string">'potato'</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">$percent </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$found </span><span class="keyword">= </span><span class="default">closest_word</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$words</span><span class="keyword">, </span><span class="default">$percent</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">'Closest word to "%s": %s (%s%% match)'</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">, </span><span class="default">$found</span><span class="keyword">, </span><span class="default">round</span><span class="keyword">(</span><span class="default">$percent </span><span class="keyword">* </span><span class="default">100</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
I found that lowercasing the array prior to comparing yields a better comparison when the case is not of importance, for example: comparing a user-inputted category to a list of existing categories.<br />
<br />
I also found that when the percentage was above 75%, it was usually the match that I was looking for.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74383""></a>
  <div class="note">
   <strong class="user">Patrick Palka</strong>
   <a href="#74383" class="date">08-Apr-2007 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To find the comparison percentage of levenshtein, use this function:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">_levenshtein</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$str2</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">1</span><span class="keyword">-</span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$str2</span><span class="keyword">)/</span><span class="default">max</span><span class="keyword">(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">), </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">));<br />
}<br />
<br />
echo </span><span class="default">_levenshtein</span><span class="keyword">(</span><span class="string">'dogs'</span><span class="keyword">, </span><span class="string">'cats'</span><span class="keyword">); </span><span class="comment">//.25<br />
<br />
</span><span class="default">This </span><span class="keyword">function (</span><span class="default">along with levenshtein</span><span class="keyword">) </span><span class="default">is obsolete though</span><span class="keyword">: </span><span class="default">similar_text is 20</span><span class="keyword">% </span><span class="default">faster that the two</span><span class="keyword">.<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73606""></a>
  <div class="note">
   <strong class="user">Paul</strong>
   <a href="#73606" class="date">02-Mar-2007 10:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@ ivo_gelov at gmx dot net<br />
<br />
Your implementation of Myers' algorithm is not entirely correct. The algorithm finds the end of a match, but you still need to find the start of a match. The easiest way to find the start of a match is to execute the algorithm again on the reversed string, starting at the j'th character. You can't just assume the start of the match is at j - m because you don't know whether the match is longer, shorter, or of equal length.<br />
<br />
Just my 2 cents.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70824""></a>
  <div class="note">
   <strong class="user">ivo_gelov at gmx dot net</strong>
   <a href="#70824" class="date">30-Oct-2006 07:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a small function to implement a fuzzy search.<br />
If someone is wondering about the mathematics inside, this information can be found in "A fast bit-vector algorithm for approximate string matching based on dynamic programming" by Gene Myers, May 27 1998<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// This can search for PATTERN into HAYSTACK with MIST mistaken symbols in PATTERN<br />
// OK_MATCH is a function ($Position, $Score)<br />
// Position is zero-based index in HAYSTACK, where PATTERN is found,<br />
// and Score is the number of mistaken symbols<br />
</span><span class="keyword">function </span><span class="default">FuzzyLook</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$mist</span><span class="keyword">,</span><span class="default">$ok_match</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$m </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$n</span><span class="keyword">==</span><span class="default">0 </span><span class="keyword">OR </span><span class="default">$m</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">) return;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Precompute Peq[Z]<br />
&nbsp; </span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">32</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) </span><span class="default">$Bit</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = (</span><span class="default">1 </span><span class="keyword">&lt;&lt; </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$m</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) </span><span class="default">$Peq</span><span class="keyword">[ </span><span class="default">ord</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)) ] |= </span><span class="default">$Bit</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Pv </span><span class="keyword">= </span><span class="default">0xFFFFFFFF</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Mv </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Score </span><span class="keyword">= </span><span class="default">$m</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$n</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Eq </span><span class="keyword">= </span><span class="default">$Peq</span><span class="keyword">[ </span><span class="default">ord</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$j</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">))];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Xv </span><span class="keyword">= </span><span class="default">$Eq </span><span class="keyword">| </span><span class="default">$Mv</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Xh </span><span class="keyword">= (((</span><span class="default">$Eq </span><span class="keyword">&amp; </span><span class="default">$Pv</span><span class="keyword">) + </span><span class="default">$Pv</span><span class="keyword">) ^ </span><span class="default">$Pv</span><span class="keyword">) | </span><span class="default">$Eq</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Ph </span><span class="keyword">= </span><span class="default">$Mv </span><span class="keyword">| ~ (</span><span class="default">$Xh </span><span class="keyword">| </span><span class="default">$Pv</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Mh </span><span class="keyword">= </span><span class="default">$Pv </span><span class="keyword">&amp; </span><span class="default">$Xh</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$Ph </span><span class="keyword">&amp; (</span><span class="default">1 </span><span class="keyword">&lt;&lt; (</span><span class="default">$m</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">))) </span><span class="default">$Score </span><span class="keyword">+= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif(</span><span class="default">$Mh </span><span class="keyword">&amp; (</span><span class="default">1 </span><span class="keyword">&lt;&lt; (</span><span class="default">$m</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">))) </span><span class="default">$Score </span><span class="keyword">-= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Ph </span><span class="keyword">&lt;&lt;= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Pv </span><span class="keyword">= (</span><span class="default">$Mh </span><span class="keyword">&lt;&lt; </span><span class="default">1</span><span class="keyword">) | ~ (</span><span class="default">$Xv </span><span class="keyword">| </span><span class="default">$Ph</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Mv </span><span class="keyword">= </span><span class="default">$Ph </span><span class="keyword">&amp; </span><span class="default">$Xv</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$Score </span><span class="keyword">&lt;= </span><span class="default">$mist </span><span class="keyword">&amp;&amp; </span><span class="default">$j</span><span class="keyword">&gt;=</span><span class="default">$m</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">) </span><span class="default">$ok_match</span><span class="keyword">(</span><span class="default">$j</span><span class="keyword">-</span><span class="default">$m</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">,</span><span class="default">$Score</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70796""></a>
  <div class="note">
   <strong class="user">carey at NOSPAM dot internode dot net dot au</strong>
   <a href="#70796" class="date">28-Oct-2006 07:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have found that levenshtein is actually case-sensitive (in PHP 4.4.2 at least).<br />
<br />
<span class="default">&lt;?php<br />
$distance</span><span class="keyword">=</span><span class="default">levenshtein</span><span class="keyword">(</span><span class="string">'hello'</span><span class="keyword">,</span><span class="string">'ELLO'</span><span class="keyword">);<br />
echo </span><span class="string">"</span><span class="default">$distance</span><span class="string">"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Outputs: "5", instead of "1". If you are implementing a fuzzy search feature that makes use of levenshtein, you will probably need to find a way to work around this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63274""></a>
  <div class="note">
   <strong class="user">dinesh AT dinsoft DOT net</strong>
   <a href="#63274" class="date">17-Mar-2006 03:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a string resynch function:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Trouve les operations a effectuer pour modifier $b en $a en exploitant leurs similitudes (Finds the operations required to change $b to $a)<br />
// Identique a la fonction Resynch Compare de Hex Workshop<br />
//<br />
// Parametres:<br />
//&nbsp; &nbsp; &nbsp; $a Premiere chaine (cible, target)<br />
//&nbsp; &nbsp; &nbsp; $b Seconde chaine (source)<br />
//&nbsp; &nbsp; &nbsp; $l Nombre d'octets devant correspondre pour etre consides comme un bloc similaire (number of matching bytes required)<br />
//&nbsp; &nbsp; &nbsp; $s Distance maximale dans laquelle les blocs similaires sont cherches (search window)<br />
//<br />
// Retourne:<br />
//&nbsp; &nbsp; &nbsp; Array<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Array<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] Operation: + Add , - Del , / Replace, = Match<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] Source offset<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [2] Source count<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [3] Target offset<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [4] Target count<br />
//<br />
</span><span class="keyword">function </span><span class="default">str_resynch</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">,</span><span class="default">$l</span><span class="keyword">=</span><span class="default">32</span><span class="keyword">,</span><span class="default">$s</span><span class="keyword">=</span><span class="default">2048</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">),</span><span class="default">$cc</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">),</span><span class="default">$ii</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$z</span><span class="keyword">=</span><span class="default">$s</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">,</span><span class="default">$z2</span><span class="keyword">=(</span><span class="default">$z</span><span class="keyword">&lt;&lt;</span><span class="default">1</span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$c</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">=</span><span class="default">$i</span><span class="keyword">-</span><span class="default">$z</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">=(</span><span class="default">$d</span><span class="keyword">&lt;</span><span class="default">$ii</span><span class="keyword">)?</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">,</span><span class="default">$ii</span><span class="keyword">,</span><span class="default">$z2</span><span class="keyword">-</span><span class="default">$ii</span><span class="keyword">+</span><span class="default">$d</span><span class="keyword">):</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">,</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$z2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">});<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$p</span><span class="keyword">!==</span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$m</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">=</span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">=</span><span class="default">$p</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p</span><span class="keyword">+=</span><span class="default">$ii</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ((++</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$c</span><span class="keyword">) &amp;&amp; (++</span><span class="default">$p</span><span class="keyword">&lt;</span><span class="default">$cc</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$a</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">}!=</span><span class="default">$b</span><span class="keyword">{</span><span class="default">$p</span><span class="keyword">}) break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$m</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$m</span><span class="keyword">&lt;</span><span class="default">$l</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">$bi</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n</span><span class="keyword">=</span><span class="default">$bp</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p</span><span class="keyword">=@</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">},</span><span class="default">$n</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">--;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[]=array(</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">+</span><span class="default">$ii</span><span class="keyword">,</span><span class="default">$m</span><span class="keyword">); </span><span class="comment">// offset a, offset b, Count<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ii</span><span class="keyword">=</span><span class="default">$p</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">count</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">)) return (</span><span class="default">$cc</span><span class="keyword">)?array(</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$cc</span><span class="keyword">):array(array(</span><span class="string">'+'</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$m</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$m</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]!=</span><span class="default">$bi</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]!=</span><span class="default">$bp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Replace<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]-</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]-</span><span class="default">$bp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Insertion<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'+'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]-</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]!=</span><span class="default">$bp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Delete<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'-'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]-</span><span class="default">$bp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Match<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'='</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">],</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">],</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">],</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">+=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">+=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$c</span><span class="keyword">!=</span><span class="default">$bi</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$cc</span><span class="keyword">!=</span><span class="default">$bp</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">-</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">$cc</span><span class="keyword">-</span><span class="default">$bp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'+'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">-</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">$cc</span><span class="keyword">!=</span><span class="default">$bp</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'-'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">$cc</span><span class="keyword">-</span><span class="default">$bp</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$o</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53562""></a>
  <div class="note">
   <strong class="user">june05 at tilo-hauke dot de</strong>
   <a href="#53562" class="date">06-Jun-2005 12:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
//levenshtein for arrays<br />
function array_levenshtein($array1,$array2)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {&nbsp;&nbsp; $aliases= array_flip(array_values(array_unique(array_merge($array1,$array2))));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(count($aliases)&gt;255) return -1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $stringA=''; $stringB='';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach($array1 as $entry) $stringA.=chr($aliases[$entry]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach($array2 as $entry) $stringB.=chr($aliases[$entry]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return levenshtein($stringA,$stringB);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
// e.g. use array_levenshtein to detect special expressions in unser-inputs<br />
<br />
echo array_levenshtein(split(" ", "my name is xxx"), split(" ","my name is levenshtein")); <br />
<br />
//output: 1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51600""></a>
  <div class="note">
   <strong class="user">justin at visunet dot ie</strong>
   <a href="#51600" class="date">05-Apr-2005 07:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/*********************************************************************<br />
&nbsp;&nbsp;&nbsp; * The below func, btlfsa, (better than levenstien for spelling apps)<br />
&nbsp;&nbsp;&nbsp; * produces better results when comparing words like haert against<br />
&nbsp;&nbsp;&nbsp; * haart and heart.<br />
&nbsp;&nbsp;&nbsp; *<br />
&nbsp;&nbsp;&nbsp; * For example here is the output of levenshtein compared to btlfsa<br />
&nbsp;&nbsp;&nbsp; * when comparing 'haert' to 'herat, haart, heart, harte'<br />
&nbsp;&nbsp;&nbsp; *<br />
&nbsp;&nbsp;&nbsp; * btlfsa('haert','herat'); output is.. 3<br />
&nbsp;&nbsp;&nbsp; * btlfsa('haert','haart'); output is.. 3<br />
&nbsp;&nbsp;&nbsp; * btlfsa('haert','harte'); output is.. 3<br />
&nbsp;&nbsp;&nbsp; * btlfsa('haert','heart'); output is.. 2<br />
&nbsp;&nbsp;&nbsp; *<br />
&nbsp;&nbsp;&nbsp; * levenshtein('haert','herat'); output is.. 2<br />
&nbsp;&nbsp;&nbsp; * levenshtein('haert','haart'); output is.. 1<br />
&nbsp;&nbsp;&nbsp; * levenshtein('haert','harte'); output is.. 2<br />
&nbsp;&nbsp;&nbsp; * levenshtein('haert','heart'); output is.. 2<br />
&nbsp;&nbsp;&nbsp; *<br />
&nbsp;&nbsp;&nbsp; * In other words, if you used levenshtein, 'haart' would be the<br />
&nbsp;&nbsp;&nbsp; * closest match to 'haert'. Where as, btlfsa sees that it should be<br />
&nbsp;&nbsp;&nbsp; * 'heart'<br />
&nbsp;&nbsp;&nbsp; */<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">btlfsa</span><span class="keyword">(</span><span class="default">$word1</span><span class="keyword">,</span><span class="default">$word2</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$score </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// For each char that is different add 2 to the score<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // as this is a BIG difference<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$remainder&nbsp; </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/["</span><span class="keyword">.</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/[^A-Za-z0-9\']/"</span><span class="keyword">,</span><span class="string">' '</span><span class="keyword">,</span><span class="default">$word1</span><span class="keyword">).</span><span class="string">"]/i"</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$word2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$remainder </span><span class="keyword">.= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/["</span><span class="keyword">.</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/[^A-Za-z0-9\']/"</span><span class="keyword">,</span><span class="string">' '</span><span class="keyword">,</span><span class="default">$word2</span><span class="keyword">).</span><span class="string">"]/i"</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$word1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$score&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$remainder</span><span class="keyword">)*</span><span class="default">2</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Take the difference in string length and add it to the score<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w1_len&nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$word1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w2_len&nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$word2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$score&nbsp; </span><span class="keyword">+= </span><span class="default">$w1_len </span><span class="keyword">&gt; </span><span class="default">$w2_len </span><span class="keyword">? </span><span class="default">$w1_len </span><span class="keyword">- </span><span class="default">$w2_len </span><span class="keyword">: </span><span class="default">$w2_len </span><span class="keyword">- </span><span class="default">$w1_len</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Calculate how many letters are in different locations<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // And add it to the score i.e.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // h e a r t<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // 1 2 3 4 5<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // h a e r t&nbsp; &nbsp;&nbsp; a e&nbsp; &nbsp; &nbsp; &nbsp; = 2<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // 1 2 3 4 5&nbsp;&nbsp; 1 2 3 4 5<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w1 </span><span class="keyword">= </span><span class="default">$w1_len </span><span class="keyword">&gt; </span><span class="default">$w2_len </span><span class="keyword">? </span><span class="default">$word1 </span><span class="keyword">: </span><span class="default">$word2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w2 </span><span class="keyword">= </span><span class="default">$w1_len </span><span class="keyword">&gt; </span><span class="default">$w2_len </span><span class="keyword">? </span><span class="default">$word2 </span><span class="keyword">: </span><span class="default">$word1</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$w1</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( !isset(</span><span class="default">$w2</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) || </span><span class="default">$w1</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] != </span><span class="default">$w2</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$score</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$score</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// *************************************************************<br />
&nbsp;&nbsp;&nbsp; // Here is a full code example showing the difference<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$misspelled </span><span class="keyword">= </span><span class="string">'haert'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Imagine that these are sample suggestions thrown back by soundex or metaphone..<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$suggestions </span><span class="keyword">= array(</span><span class="string">'herat'</span><span class="keyword">, </span><span class="string">'haart'</span><span class="keyword">, </span><span class="string">'heart'</span><span class="keyword">, </span><span class="string">'harte'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Firstly order an array based on levenshtein<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$levenshtein_ordered </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach ( </span><span class="default">$suggestions </span><span class="keyword">as </span><span class="default">$suggestion </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$levenshtein_ordered</span><span class="keyword">[</span><span class="default">$suggestion</span><span class="keyword">] = </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$misspelled</span><span class="keyword">,</span><span class="default">$suggestion</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">asort</span><span class="keyword">(</span><span class="default">$levenshtein_ordered</span><span class="keyword">, </span><span class="default">SORT_NUMERIC </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;b&gt;Suggestions as ordered by levenshtein...&lt;/b&gt;&lt;ul&gt;&lt;pre&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$levenshtein_ordered</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;/pre&gt;&lt;/ul&gt;"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Secondly order an array based on btlfsa<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$btlfsa_ordered </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach ( </span><span class="default">$suggestions </span><span class="keyword">as </span><span class="default">$suggestion </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$btlfsa_ordered</span><span class="keyword">[</span><span class="default">$suggestion</span><span class="keyword">] = </span><span class="default">btlfsa</span><span class="keyword">(</span><span class="default">$misspelled</span><span class="keyword">,</span><span class="default">$suggestion</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">asort</span><span class="keyword">(</span><span class="default">$btlfsa_ordered</span><span class="keyword">, </span><span class="default">SORT_NUMERIC </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;b&gt;Suggestions as ordered by btlfsa...&lt;/b&gt;&lt;ul&gt;&lt;pre&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$btlfsa_ordered</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;/pre&gt;&lt;/ul&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50699""></a>
  <div class="note">
   <strong class="user">mcreuzer at r-world dot com</strong>
   <a href="#50699" class="date">07-Mar-2005 09:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am using the Levenshtein distance to SORT my search results.<br />
<br />
I have a search page for peoples names. I do a SOUNDEX() search on the name in mysql. MySQL SOUNDEX() will perform the "fuzzy" search for me.<br />
<br />
I then calculate the Levenshtein distance between the search term and the actual name found by the SOUNDEX() search. This will give me a score on how close my results are to the search string.<br />
<br />
I can the sort my results for display listing the closest results first.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// PHP CODE INCLUDING DB LOOKUPS HERE<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">usort</span><span class="keyword">(</span><span class="default">$searchresults</span><span class="keyword">, </span><span class="string">"finallevenshteinsortfunction"</span><span class="keyword">);<br />
<br />
function </span><span class="default">finallevenshteinsortfunction</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if((</span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] &gt; </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">]) || ( </span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] == </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] &amp;&amp; </span><span class="default">strnatcasecmp</span><span class="keyword">( </span><span class="default">$a</span><span class="keyword">[</span><span class="string">'Last_Name'</span><span class="keyword">], </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'Last_Name'</span><span class="keyword">]) &gt;= </span><span class="default">1</span><span class="keyword">) ){ return </span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">];} </span><span class="comment">// Ok... The levenstein is greater OR with the same levenshtein, the last name is alphanumerically first<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">elseif(</span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] == </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">]){ return </span><span class="string">'0'</span><span class="keyword">;} </span><span class="comment">// The levenstein matches <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">elseif(</span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] &lt; </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">]){ return -</span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">];}<br />
&nbsp;&nbsp;&nbsp; else{die(</span><span class="string">"&lt;!-- a horrable death --&gt;"</span><span class="keyword">);}<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40310""></a>
  <div class="note">
   <strong class="user">silas at silaspalmer dot com</strong>
   <a href="#40310" class="date">28-Feb-2004 02:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some code for a basic fuzzy search.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$needle </span><span class="keyword">= </span><span class="string">"Youser Nein stitched tymes hand"</span><span class="keyword">;<br />
</span><span class="default">$haystack </span><span class="keyword">= </span><span class="string">"<br />
&nbsp;&nbsp;&nbsp; Did you know that a stitch in time can save nine. Isn't that amazing! I think so<br />
&nbsp;&nbsp;&nbsp; The user-supplied function has to return the loser, from the sand. Describe the cost for this particular operation. <br />
&nbsp;&nbsp;&nbsp; Eweser may decide to use only some of the supplied nans. And pay attention. This isn't hard...<br />
&nbsp;&nbsp;&nbsp; "</span><span class="keyword">;<br />
<br />
</span><span class="comment">// explode into words<br />
</span><span class="default">$hwords </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"/[\s\W]+/"</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">);<br />
</span><span class="default">$nwords </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"/[\s\W]+/"</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">);<br />
<br />
echo </span><span class="string">"You searched for </span><span class="default">$needle</span><span class="string">&lt;br&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"I found...&lt;br&gt;"</span><span class="keyword">;<br />
<br />
foreach (</span><span class="default">$hwords </span><span class="keyword">as </span><span class="default">$hkey </span><span class="keyword">=&gt; </span><span class="default">$hayword</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hmp </span><span class="keyword">= </span><span class="default">metaphone </span><span class="keyword">(</span><span class="default">$hayword</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$nwords </span><span class="keyword">as </span><span class="default">$nkey </span><span class="keyword">=&gt; </span><span class="default">$needword</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// First or last letters of needle and haystack have to match (case insensitive)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nfirst </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$needword</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nlast </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$needword</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hfirst </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$hayword</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hlast </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$hayword</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if ((</span><span class="default">$hfirst </span><span class="keyword">== </span><span class="default">$nfirst</span><span class="keyword">) or (</span><span class="default">$hlast </span><span class="keyword">== </span><span class="default">$nlast</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nmp </span><span class="keyword">= </span><span class="default">metaphone </span><span class="keyword">(</span><span class="default">$needword</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$distance </span><span class="keyword">= </span><span class="default">levenshtein </span><span class="keyword">(</span><span class="default">$hmp</span><span class="keyword">, </span><span class="default">$nmp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// $distance = levenshtein ($hayword, $needword);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n_len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$nmp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$per </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">((</span><span class="default">$distance</span><span class="keyword">/</span><span class="default">$n_len</span><span class="keyword">)*</span><span class="default">1000</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$per </span><span class="keyword">&lt; </span><span class="default">335</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Highlight word in haystack <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$hayword</span><span class="keyword">, </span><span class="string">"&lt;b&gt;</span><span class="default">$hayword</span><span class="string">&lt;/b&gt;"</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"&lt;b&gt;&lt;b&gt;"</span><span class="keyword">, </span><span class="string">"&lt;b&gt;"</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"&lt;/b&gt;&lt;/b&gt;"</span><span class="keyword">, </span><span class="string">"&lt;/b&gt;"</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
<br />
</span><span class="comment">// echo the new haystack<br />
</span><span class="keyword">echo </span><span class="default">$haystack</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Returns ...<br />
//<br />
// You searched for Youser Nein stitched tymes hand<br />
// I found...<br />
// Did you know that a &lt;b&gt;stitch&lt;/b&gt; in &lt;b&gt;time&lt;/b&gt; can<br />
// save &lt;b&gt;nine&lt;/b&gt;. Isn't that amazing! I think so. The<br />
// &lt;b&gt;user&lt;/b&gt;-supplied function has to return the<br />
// &lt;b&gt;loser&lt;/b&gt;, from the sand. Describe the cost for this<br />
// particular operation. Eweser may decide to use only some<br />
// of the supplied nans. &lt;b&gt;And&lt;/b&gt; pay attention. This <br />
// isn't &lt;b&gt;hard&lt;/b&gt;...<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37953""></a>
  <div class="note">
   <strong class="user">gzink at zinkconsulting dot com</strong>
   <a href="#37953" class="date">03-Dec-2003 03:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Try combining this with metaphone() for a truly amazing fuzzy search function. Play with it a bit, the results can be plain scary (users thinking the computer is almost telepathic) when implemented properly. I wish spell checkers worked as well as the code I've written.<br />
<br />
I would release my complete code if reasonable, but it's not, due to copyright issues. I just hope that somebody can learn from this little tip!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36900""></a>
  <div class="note">
   <strong class="user">genialbrainmachine at  dot IHATESPAM dot tiscali dot it</strong>
   <a href="#36900" class="date">26-Oct-2003 11:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote this function to have an "intelligent" comparison between data to be written in a DB<br />
and already existent data. Not ony calculating distances but also balancing distances for<br />
each field.<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
This function calculate a balanced percentage distance between an array of strings<br />
"$record" and a compared array "$compared", balanced through an array of<br />
weights "$weight". The three arrays must have the same indices.<br />
For an unbalanced distance, set all weights to 1.<br />
The used formula is:<br />
percentage distance = sum(field_levenshtein_distance * field_weight) / sum(record_field_length * field_weight) * 100<br />
*/<br />
</span><span class="keyword">function </span><span class="default">search_similar</span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">, </span><span class="default">$weights</span><span class="keyword">, </span><span class="default">$compared</span><span class="keyword">, </span><span class="default">$precision</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$field_names </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># "Weighted length" of $record and "weighted distance".<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">foreach (</span><span class="default">$field_names </span><span class="keyword">as </span><span class="default">$field_key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$record_weight </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">]) * </span><span class="default">$weights</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$weighted_distance </span><span class="keyword">+= </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">],</span><span class="default">$compared</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">]) * </span><span class="default">$weights</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># Building the result..<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$record_weight</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">round</span><span class="keyword">((</span><span class="default">$weighted_distance </span><span class="keyword">/ </span><span class="default">$record_weight </span><span class="keyword">* </span><span class="default">100</span><span class="keyword">),</span><span class="default">$precision</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif ((</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">implode</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">$record</span><span class="keyword">)) == </span><span class="default">0</span><span class="keyword">) &amp;&amp; (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">implode</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">$compared</span><span class="keyword">)) == </span><span class="default">0</span><span class="keyword">)) { </span><span class="comment">// empty records<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">round</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$precision</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif (</span><span class="default">array_sum</span><span class="keyword">(</span><span class="default">$weights</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">) { </span><span class="comment">// all weights == 0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">round</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$precision</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; Be very careful distinguising 0 result and false result.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; The function results 0 ('0.00' if $precision is 2 and so on) if:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; - $record and $compared are equals (even if $record and $compared are empty);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; - all weights are 0 (the meaning could be "no care about any field").<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; Conversely, the function results false if $record is empty, but the weights<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; are not all 0 and $compared is not empty. That cause a "division by 0" error.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; I wrote this kind of check:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if ($rel_dist = search_similar(...)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print $rel_dist;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif ($rel_dist == "0.00") { // supposing that $precision is 2<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print $rel_dist;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print "infinite";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36877""></a>
  <div class="note">
   <strong class="user">jlsalinas at gmx dot net</strong>
   <a href="#36877" class="date">25-Oct-2003 07:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding the post by fgilles on April 26th 2001, I suggest not to use levenshtein() function to test for over-uppercasing unless you've got plenty of time to waste in your host. ;) Anyhow, I think it's a useful feature, as I get really annoyed when reading whole messages in uppercase.<br />
<br />
PHP's levenshtein() function can only handle up to 255 characters, which is not realistic for user input (only the first paragraph oh this post has 285 characters). If you choose to use a custom function able to handle more than 255 characters, efficiency is an important issue.<br />
<br />
I use this function, specific for this case, but much faster:<br />
<br />
function ucase_percent ($str) {<br />
&nbsp;&nbsp;&nbsp; $str2 = strtolower ($str);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $l = strlen ($str);<br />
&nbsp;&nbsp;&nbsp; $ucase = 0;<br />
<br />
&nbsp;&nbsp;&nbsp; for ($i = 0; $i &lt; $l; $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($str{$i} != $str2{$i}) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ucase++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return $ucase / $l * 100.0;<br />
}<br />
<br />
I think 10% is enough for written English (maybe other languages like German, which use more capital letters, need more). With some sentencies in uppercase (everybody has the right to shout occasionally), 20% would be enough; so I use a threshold of 30%. When exceeded, I lowercase the whole message.<br />
<br />
Hope you find it useful and it helps keeping the web free of ill-mannered people.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33940""></a>
  <div class="note">
   <strong class="user">inerte is my hotmail.com username</strong>
   <a href="#33940" class="date">11-Jul-2003 10:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am using this function to avoid duplicate information on my client's database.<br />
<br />
After retrieving a series of rows and assigning the results to an array values, I loop it with foreach comparing its levenshtein() with the user supplied string.<br />
<br />
It helps to avoid people re-registering "John Smith", "Jon Smith" or "Jon Smit".<br />
<br />
Of course, I can't block the operation if the user really wants to, but a suggestion is displayed along the lines of: "There's a similar client with this name.", followed by the list of the similar strings.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31935""></a>
  <div class="note">
   <strong class="user">asseg at ukl dot uni-feiburg dot de</strong>
   <a href="#31935" class="date">09-May-2003 06:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for the unserious guys how might do dna sequence analysis<br />
with php. Here's the function that can handle long strings.<br />
to get an output of the matrix uncomment the <br />
printf-section. handle with care iteration are approximately <br />
2x2^strlen ;)<br />
<br />
------------------------------------------------------------<br />
function levdis($s,$t){<br />
&nbsp;&nbsp;&nbsp; $n=strlen($s);<br />
&nbsp;&nbsp;&nbsp; $m=strlen($t);<br />
&nbsp;&nbsp;&nbsp; $matrix=array(range(0,$n+1),range(0,$m+1));<br />
&nbsp;&nbsp;&nbsp; $ret=0;<br />
&nbsp;&nbsp;&nbsp; if ($n==0){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $m;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif ($m==0){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $n;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for ($i=0;$i&lt;=$n;$i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $matrix[$i][0]=$i;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for&nbsp; ($j=0;$j&lt;=$m;$j++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $matrix[0][$j]=$j;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for ($i=1;$i&lt;=$n;$i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for&nbsp; ($j=1;$j&lt;=$m;$j++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($s[$i-1]==$t[$j-1]) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $cost=0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $cost=1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $matrix[$i][$j]=min($matrix[$i-1][$j]+1,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $matrix[$i][$j-1]+1,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $matrix[$i-1][$j-1]+$cost);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
/* for ($j=0;$j&lt;=$m;$j++) {&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ($i=0;$i&lt;=$n;$i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; printf("&nbsp; %02d",$matrix[$i][$j]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "\n";<br />
&nbsp;&nbsp;&nbsp; }*/<br />
&nbsp;&nbsp;&nbsp; return $matrix[$n][$m];<br />
}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ----------------------------------------------</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="24289""></a>
  <div class="note">
   <strong class="user">bisqwit at iki dot fi</strong>
   <a href="#24289" class="date">12-Aug-2002 07:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
At the time of this manual note the user defined thing&nbsp; <br />
in levenshtein() is not implemented yet. I wanted something<br />
like that, so I wrote my own function. Note that this<br />
doesn't return levenshtein() difference, but instead <br />
an array of operations to transform a string to another.<br />
<br />
Please note that the difference finding part (resync)<br />
may be extremely slow on long strings.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/* matchlen(): returns the length of matching<br />
&nbsp;* substrings at beginning of $a and $b<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">matchlen</span><span class="keyword">(&amp;</span><span class="default">$a</span><span class="keyword">, &amp;</span><span class="default">$b</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$c</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$alen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$blen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$d </span><span class="keyword">= </span><span class="default">min</span><span class="keyword">(</span><span class="default">$alen</span><span class="keyword">, </span><span class="default">$blen</span><span class="keyword">);<br />
&nbsp; while(</span><span class="default">$a</span><span class="keyword">[</span><span class="default">$c</span><span class="keyword">] == </span><span class="default">$b</span><span class="keyword">[</span><span class="default">$c</span><span class="keyword">] &amp;&amp; </span><span class="default">$c </span><span class="keyword">&lt; </span><span class="default">$d</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">++;&nbsp;&nbsp; <br />
&nbsp; return </span><span class="default">$c</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">/* Returns a table describing<br />
&nbsp;* the differences of $a and $b */<br />
</span><span class="keyword">function </span><span class="default">calcdiffer</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$alen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$blen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$aptr </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$bptr </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; </span><span class="default">$ops </span><span class="keyword">= array();<br />
&nbsp; <br />
&nbsp; while(</span><span class="default">$aptr </span><span class="keyword">&lt; </span><span class="default">$alen </span><span class="keyword">&amp;&amp; </span><span class="default">$bptr </span><span class="keyword">&lt; </span><span class="default">$blen</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$matchlen </span><span class="keyword">= </span><span class="default">matchlen</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">), </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">, </span><span class="default">$bptr</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$matchlen</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">, </span><span class="default">$matchlen</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$aptr </span><span class="keyword">+= </span><span class="default">$matchlen</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$bptr </span><span class="keyword">+= </span><span class="default">$matchlen</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* Difference found */<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bestlen</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bestpos</span><span class="keyword">=array(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$atmp </span><span class="keyword">= </span><span class="default">$aptr</span><span class="keyword">; </span><span class="default">$atmp </span><span class="keyword">&lt; </span><span class="default">$alen</span><span class="keyword">; </span><span class="default">$atmp</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; for(</span><span class="default">$btmp </span><span class="keyword">= </span><span class="default">$bptr</span><span class="keyword">; </span><span class="default">$btmp </span><span class="keyword">&lt; </span><span class="default">$blen</span><span class="keyword">; </span><span class="default">$btmp</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$matchlen </span><span class="keyword">= </span><span class="default">matchlen</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$atmp</span><span class="keyword">), </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">, </span><span class="default">$btmp</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$matchlen</span><span class="keyword">&gt;</span><span class="default">$bestlen</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bestlen</span><span class="keyword">=</span><span class="default">$matchlen</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bestpos</span><span class="keyword">=array(</span><span class="default">$atmp</span><span class="keyword">,</span><span class="default">$btmp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$matchlen </span><span class="keyword">&gt;= </span><span class="default">$blen</span><span class="keyword">-</span><span class="default">$btmp</span><span class="keyword">)break;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$bestlen</span><span class="keyword">)break;<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$adifflen </span><span class="keyword">= </span><span class="default">$bestpos</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] - </span><span class="default">$aptr</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bdifflen </span><span class="keyword">= </span><span class="default">$bestpos</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] - </span><span class="default">$bptr</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$adifflen</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'-'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">, </span><span class="default">$adifflen</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$aptr </span><span class="keyword">+= </span><span class="default">$adifflen</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$bdifflen</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'+'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">, </span><span class="default">$bptr</span><span class="keyword">, </span><span class="default">$bdifflen</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$bptr </span><span class="keyword">+= </span><span class="default">$bdifflen</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">, </span><span class="default">$bestlen</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$aptr </span><span class="keyword">+= </span><span class="default">$bestlen</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bptr </span><span class="keyword">+= </span><span class="default">$bestlen</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; if(</span><span class="default">$aptr </span><span class="keyword">&lt; </span><span class="default">$alen</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* b has too much stuff */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'-'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">));<br />
&nbsp; }<br />
&nbsp; if(</span><span class="default">$bptr </span><span class="keyword">&lt; </span><span class="default">$blen</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* a has too little stuff */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'+'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">, </span><span class="default">$bptr</span><span class="keyword">));<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$ops</span><span class="keyword">;<br />
}<br />
&nbsp;<br />
<br />
</span><span class="default">Example</span><span class="keyword">:<br />
<br />
</span><span class="default">$tab </span><span class="keyword">= </span><span class="default">calcdiffer</span><span class="keyword">(</span><span class="string">'Tämä on jonkinlainen testi'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'Tämä ei ole minkäänlainen testi.'</span><span class="keyword">);&nbsp; <br />
</span><span class="default">$ops </span><span class="keyword">= array(</span><span class="string">'='</span><span class="keyword">=&gt;</span><span class="string">'Ok'</span><span class="keyword">, </span><span class="string">'-'</span><span class="keyword">=&gt;</span><span class="string">'Remove'</span><span class="keyword">, </span><span class="string">'+'</span><span class="keyword">=&gt;</span><span class="string">'Add'</span><span class="keyword">);<br />
foreach(</span><span class="default">$tab </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">)<br />
&nbsp; echo </span><span class="default">$ops</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]], </span><span class="string">" '"</span><span class="keyword">, </span><span class="default">$k</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="string">"'\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">Example output</span><span class="keyword">:<br />
<br />
</span><span class="default">Ok </span><span class="string">'Tämä '<br />
</span><span class="default">Remove </span><span class="string">'on jonki'<br />
</span><span class="default">Add </span><span class="string">'ei ole minkää'<br />
</span><span class="default">Ok </span><span class="string">'nlainen testi'<br />
</span><span class="default">Add </span><span class="string">'.'</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20670""></a>
  <div class="note">
   
   <a href="#20670" class="date">11-Apr-2002 06:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For spell checking applications, delay could be tolerable if you assume the typist got the first two or three chars of each word right.&nbsp; Then you'd only need to calc distances for a small segment of the dictionary.&nbsp; This is a compromise but one I think a lot of spell checkers make.<br />
For an example of site search using this function look at the PHP manual search button on this page.&nbsp; It appears to be doing this for the PHP function list.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="12645""></a>
  <div class="note">
   <strong class="user">fgilles at free dot fr</strong>
   <a href="#12645" class="date">26-Apr-2001 01:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Exempla of use for a forum: users can't post messages too much uppercased<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if ((</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">)&gt;</span><span class="default">10</span><span class="keyword">) and ( ( </span><span class="default">levenshtein </span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">, </span><span class="default">strtolower </span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">) / </span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">) ) &gt; </span><span class="default">.3 </span><span class="keyword">) ){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$subject </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="7675""></a>
  <div class="note">
   <strong class="user">hholzgra at php dot net</strong>
   <a href="#7675" class="date">11-Aug-2000 01:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
well, think of it as a sort of typo counter<br />
<br />
by the way we might introduce a feature similar to something that the jikes compiler for java does using this function: <br />
<br />
every time you try to access an undefined funtion you will get a suggestion of a function that's named<br />
similar to what you requested<br />
<br />
e.g.: <br />
<br />
Undefined function 'rest()'!<br />
Where you looking for 'reset()' instead?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="7658""></a>
  <div class="note">
   <strong class="user">dschultz at protonic dot com</strong>
   <a href="#7658" class="date">10-Aug-2000 09:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's also useful if you want to make some sort of registration page and you want to make sure that people who register don't pick usernames that are very similar to their passwords.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="7531""></a>
  <div class="note">
   <strong class="user">Mathijs Brands &amp;lt;mathijs at ilse dot nl&amp;gt;</strong>
   <a href="#7531" class="date">06-Aug-2000 05:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This could come in handy if you were to implement a simple searchengine in PHP. It would allow for simple fuzzy searching.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="7486""></a>
  <div class="note">
   <strong class="user">ad1n at dc dot uba dot ar</strong>
   <a href="#7486" class="date">04-Aug-2000 05:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One application of this is when you want to look for a similar match instead of an exact one. You can sort the results of checking the distances of a word to a dictionary and sort them to see which were the more similar ones. Of course it will be a quite resourse consuming task anyway.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.lcfirst.html">lcfirst</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.localeconv.html">localeconv</a></div>
 <div class="up"><a href="ref.strings.html">String Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

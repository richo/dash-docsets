<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Binary-safe file write</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.ftruncate.html">ftruncate</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.glob.html">glob</a></div>
 <div class="up"><a href="ref.filesystem.html">Filesystem Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.fwrite" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">fwrite</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">fwrite</span> &mdash; <span class="dc-title">Binary-safe file write</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.fwrite-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><b>fwrite</b></span>
    ( <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$handle</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$string</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$length</tt></span>
  ] )</div>

  <p class="simpara">
   <span class="function"><b>fwrite()</b></span> writes the contents of
   <i><tt class="parameter">string</tt></i> to the file stream pointed to by
   <i><tt class="parameter">handle</tt></i>. 
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.fwrite-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">handle</tt></i></span>
     <dd>

      <p class="para">A file system pointer <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>
that is typically created using <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span>.</p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">string</tt></i></span>
     <dd>

      <p class="para">
       The string that is to be written.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">length</tt></i></span>
     <dd>

      <p class="para">
       If the <i><tt class="parameter">length</tt></i> argument is given, writing will
       stop after <i><tt class="parameter">length</tt></i> bytes have been written or
       the end of <i><tt class="parameter">string</tt></i> is reached, whichever comes
       first.
      </p>
      <p class="para">
       Note that if the <i><tt class="parameter">length</tt></i> argument is given,
       then the <a href="info.configuration.html#ini.magic-quotes-runtime" class="link">magic_quotes_runtime</a>
       configuration option will be ignored and no slashes will be
       stripped from <i><tt class="parameter">string</tt></i>.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.fwrite-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="simpara">
   <span class="function"><b>fwrite()</b></span> returns the number of bytes
   written, or <b><tt>FALSE</tt></b> on error.
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.fwrite-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    Writing to a network stream may end before the whole string is written.
    Return value of <span class="function"><b>fwrite()</b></span> may be checked:
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">fwrite_stream</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</span><span style="color: #0000BB">$written&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$written&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$written&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">$fwrite</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$fwrite&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$written</span><span style="color: #007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$fwrite&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$written</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$written</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </p>
  </p></blockquote>
  
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    On systems which differentiate between binary and text files
    (i.e. Windows) the file must be opened with &#039;b&#039; included in
    <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span> mode parameter.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    If <i><tt class="parameter">handle</tt></i> was <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span>ed in
    append mode, <span class="function"><b>fwrite()</b></span>s are atomic (unless the size of
    <i><tt class="parameter">string</tt></i> exceeds the filesystem&#039;s block size, on some
    platforms, and as long as the file is on a local filesystem). That is,
    there is no need to <span class="function"><a href="function.flock.html" class="function">flock()</a></span> a resource before calling
    <span class="function"><b>fwrite()</b></span>; all of the data will be written without
    interruption.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    If writing twice to the file pointer, then the data will be appended to 
    the end of the file content:
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'data.txt'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'w'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'1'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'23'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;the&nbsp;content&nbsp;of&nbsp;'data.txt'&nbsp;is&nbsp;now&nbsp;123&nbsp;and&nbsp;not&nbsp;23!<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 examples" id="refsect1-function.fwrite-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-2193">
    <p><b>Example #1 A simple <span class="function"><b>fwrite()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$filename&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'test.txt'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$somecontent&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"Add&nbsp;this&nbsp;to&nbsp;the&nbsp;file\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;Let's&nbsp;make&nbsp;sure&nbsp;the&nbsp;file&nbsp;exists&nbsp;and&nbsp;is&nbsp;writable&nbsp;first.<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">is_writable</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">))&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;In&nbsp;our&nbsp;example&nbsp;we're&nbsp;opening&nbsp;$filename&nbsp;in&nbsp;append&nbsp;mode.<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;The&nbsp;file&nbsp;pointer&nbsp;is&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;the&nbsp;file&nbsp;hence<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;that's&nbsp;where&nbsp;$somecontent&nbsp;will&nbsp;go&nbsp;when&nbsp;we&nbsp;fwrite()&nbsp;it.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">$handle&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'a'</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Cannot&nbsp;open&nbsp;file&nbsp;(</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">)"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Write&nbsp;$somecontent&nbsp;to&nbsp;our&nbsp;opened&nbsp;file.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$somecontent</span><span style="color: #007700">)&nbsp;===&nbsp;</span><span style="color: #0000BB">FALSE</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Cannot&nbsp;write&nbsp;to&nbsp;file&nbsp;(</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">)"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Success,&nbsp;wrote&nbsp;(</span><span style="color: #0000BB">$somecontent</span><span style="color: #DD0000">)&nbsp;to&nbsp;file&nbsp;(</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">)"</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">);<br /><br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"The&nbsp;file&nbsp;</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">&nbsp;is&nbsp;not&nbsp;writable"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.fwrite-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.fread.html" class="function" rel="rdfs-seeAlso">fread()</a> - Binary-safe file read</span></li>
    <li class="member"><span class="function"><a href="function.fopen.html" class="function" rel="rdfs-seeAlso">fopen()</a> - Opens file or URL</span></li>
    <li class="member"><span class="function"><a href="function.fsockopen.html" class="function" rel="rdfs-seeAlso">fsockopen()</a> - Open Internet or Unix domain socket connection</span></li>
    <li class="member"><span class="function"><a href="function.popen.html" class="function" rel="rdfs-seeAlso">popen()</a> - Opens process file pointer</span></li>
    <li class="member"><span class="function"><a href="function.file-get-contents.html" class="function" rel="rdfs-seeAlso">file_get_contents()</a> - Reads entire file into a string</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="106209""></a>
  <div class="note">
   <strong class="user">pubdc on yahoo</strong>
   <a href="#106209" class="date">18-Oct-2011 11:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have encountered many instances where fwrite will fail to append all text to the file, especially when there is a sequence of fwrite appends. <br />
<br />
Sometimes it will work fine, sometimes the file will be only half-written. Adding a usleep(100000) for a tenth-of-a-second pause between the fwrites will usually avoid such issues without imposing too much of a delay.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103215""></a>
  <div class="note">
   <strong class="user">Jon Haynes</strong>
   <a href="#103215" class="date">01-Apr-2011 02:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful of using reserved Windows filenames in fwrite operations.<br />
<br />
<span class="default">&lt;?php<br />
$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'prn.txt'</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">);<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">, </span><span class="string">'wtf?'</span><span class="keyword">);<br />
echo </span><span class="string">'done' </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The above script will hang (tested on Windows 7) before it can echo 'done'.<br />
<br />
This is due to another 'feature' of our favourite operating system where filenames like prn.xxx, con.xxx, com1.xxx and aux.xxx (with xxx being any filename extension) are Windows reserved device names. Attempts to create/read/write to these files hangs the interpreter.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96951""></a>
  <div class="note">
   <strong class="user">nate at frickenate dot com</strong>
   <a href="#96951" class="date">24-Mar-2010 09:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After having problems with fwrite() returning 0 in cases where one would fully expect a return value of false, I took a look at the source code for php's fwrite() itself. The function will only return false if you pass in invalid arguments. Any other error, just as a broken pipe or closed connection, will result in a return value of less than strlen($string), in most cases 0.<br />
<br />
Therefore, looping with repeated calls to fwrite() until the sum of number of bytes written equals the strlen() of the full value or expecting false on error will result in an infinite loop if the connection is lost.<br />
<br />
This means the example fwrite_stream() code from the docs, as well as all the "helper" functions posted by others in the comments are all broken. You *must* check for a return value of 0 and either abort immediately or track a maximum number of retries.<br />
<br />
Below is the example from the docs. This code is BAD, as a broken pipe will result in fwrite() infinitely looping with a return value of 0. Since the loop only breaks if fwrite() returns false or successfully writes all bytes, an infinite loop will occur on failure.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// BROKEN function - infinite loop when fwrite() returns 0s<br />
</span><span class="keyword">function </span><span class="default">fwrite_stream</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$written </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$written </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">); </span><span class="default">$written </span><span class="keyword">+= </span><span class="default">$fwrite</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fwrite </span><span class="keyword">= </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$written</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$fwrite </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$written</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$written</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95081""></a>
  <div class="note">
   <strong class="user">chaly</strong>
   <a href="#95081" class="date">12-Dec-2009 08:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here are the two function I use to save my arrays to a file and load them into exactly the same array as it was before.<br />
<br />
At the moment I have no need in saving ressources or something. There I guess a memory-dump and -load is needed.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">save_array_to_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$file </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">,</span><span class="string">'w+'</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$filename</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$b </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,(</span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) ? </span><span class="default">chr</span><span class="keyword">(</span><span class="default">6</span><span class="keyword">).(string)</span><span class="default">$key </span><span class="keyword">: </span><span class="default">chr</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">).</span><span class="default">$key</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)); </span><span class="comment">//array starts<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">save_array_to_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">chr</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)); </span><span class="comment">//array ends<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">chr</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">).(string) </span><span class="default">$val</span><span class="keyword">); </span><span class="comment">//int<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">chr</span><span class="keyword">(</span><span class="default">3</span><span class="keyword">).</span><span class="default">$val</span><span class="keyword">); </span><span class="comment">//string<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)) </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">read_array_from_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$file </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">,</span><span class="string">'r'</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$filename</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret</span><span class="keyword">=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mod</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">) &lt; </span><span class="default">9</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$val</span><span class="keyword">!=</span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$mod</span><span class="keyword">==</span><span class="default">2</span><span class="keyword">) </span><span class="default">$val</span><span class="keyword">=(int) </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$mod</span><span class="keyword">==</span><span class="default">3</span><span class="keyword">) </span><span class="default">$val</span><span class="keyword">=(string) </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]=</span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mod</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">)==</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mod</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">)==</span><span class="default">1</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$ret</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$mod</span><span class="keyword">==</span><span class="default">5</span><span class="keyword">) </span><span class="default">$key</span><span class="keyword">=(string) </span><span class="default">$key</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$mod</span><span class="keyword">==</span><span class="default">6</span><span class="keyword">) </span><span class="default">$key</span><span class="keyword">=(int) </span><span class="default">$key</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mod</span><span class="keyword">=</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$mod</span><span class="keyword">==</span><span class="default">5 </span><span class="keyword">|| </span><span class="default">$mod</span><span class="keyword">==</span><span class="default">5</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key</span><span class="keyword">.=</span><span class="default">$b</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">$mod</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val</span><span class="keyword">=</span><span class="default">read_array_from_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val</span><span class="keyword">.=</span><span class="default">$b</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)) </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$ret</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91292""></a>
  <div class="note">
   <strong class="user">oktavianus dot programmer at gmail dot com</strong>
   <a href="#91292" class="date">03-Jun-2009 08:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this the another sample to use fwrite with create a folder and create the txt file.<br />
<br />
<span class="default">&lt;?php<br />
$mypath</span><span class="keyword">=</span><span class="string">"testdir\\subdir\\test"</span><span class="keyword">;<br />
</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$mypath</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">$filename </span><span class="keyword">= </span><span class="default">$mypath</span><span class="keyword">.</span><span class="string">'\test.txt'</span><span class="keyword">;<br />
</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">,</span><span class="string">"x+"</span><span class="keyword">);<br />
</span><span class="default">$somecontent </span><span class="keyword">= </span><span class="string">"Add this to the file Oktavianus"</span><span class="keyword">;<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">,</span><span class="default">$somecontent</span><span class="keyword">);<br />
echo </span><span class="string">"Success"</span><span class="keyword">;<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span> <br />
<br />
please try...<br />
Oktavianus</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90906""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#90906" class="date">15-May-2009 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you write with the pointer in the middle of a file, it overwrites what's there rather than shifting the rest of the file along.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86926""></a>
  <div class="note">
   <strong class="user">ceo at l-i-e dot com</strong>
   <a href="#86926" class="date">10-Nov-2008 03:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying to write binary/structured data (e.g., a 4-byte sequence for an (int)) to a file, you will need to use:<br />
<a href="http://php.net/pack" rel="nofollow" target="_blank">http://php.net/pack</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86265""></a>
  <div class="note">
   <strong class="user">james at facepwn dot com</strong>
   <a href="#86265" class="date">09-Oct-2008 05:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if (is_writable($filename)) {<br />
<br />
Could also be<br />
<br />
if (is_writable($filename) or die ("Can not write to ".$filename)) {</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83476""></a>
  <div class="note">
   <strong class="user">michael at newbcity dot com</strong>
   <a href="#83476" class="date">27-May-2008 11:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For my fellow newbies, if you test the sample script and want to have the .txt file created for you, you need to comment out the is_writable stuff, like this:&nbsp; <br />
<br />
<span class="default">&lt;?php<br />
$filename </span><span class="keyword">= </span><span class="string">'test.txt'</span><span class="keyword">;<br />
</span><span class="default">$somecontent </span><span class="keyword">= </span><span class="string">"Add this to the file\n"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Let's make sure the file exists and is writable first.<br />
//if (is_writable($filename)) {<br />
<br />
// In our example we're opening $filename in append mode.<br />
// The file pointer is at the bottom of the file hence<br />
// that's where $somecontent will go when we fwrite() it.<br />
</span><span class="keyword">if (!</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">)) {<br />
echo </span><span class="string">"Cannot open file (</span><span class="default">$filename</span><span class="string">)"</span><span class="keyword">;<br />
exit;<br />
}<br />
<br />
</span><span class="comment">// Write $somecontent to our opened file.<br />
</span><span class="keyword">if (</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">$somecontent</span><span class="keyword">) === </span><span class="default">FALSE</span><span class="keyword">) {<br />
echo </span><span class="string">"Cannot write to file (</span><span class="default">$filename</span><span class="string">)"</span><span class="keyword">;<br />
exit;<br />
}<br />
<br />
echo </span><span class="string">"Success, wrote (</span><span class="default">$somecontent</span><span class="string">) to file (</span><span class="default">$filename</span><span class="string">)"</span><span class="keyword">;<br />
<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
<br />
</span><span class="comment">//} else {<br />
//echo "The file $filename is not writable";<br />
//}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83359""></a>
  <div class="note">
   <strong class="user">kontakt at bmservices dot de</strong>
   <a href="#83359" class="date">22-May-2008 04:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Checking if fwrite failed will not work in that way:<br />
<br />
if (!fwrite($fH, $myText)) echo "Write error";<br />
<br />
because fwrite return the number of bytes written or FALSE in case of an error.<br />
<br />
So: if $myText is an empty string, fwrite will return 0, which is interpreted here as "FALSE", although the writing out of the string is ok.<br />
<br />
So you should check in that way:<br />
<br />
if (@fwrite($fH, $myText)===FALSE) echo "Write error";<br />
<br />
Regards from Berlin, GÌ©rÌ«me</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82211""></a>
  <div class="note">
   <strong class="user">elinor_hust at REMOVETHIS dot hotmail dot com</strong>
   <a href="#82211" class="date">01-Apr-2008 05:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Remember to use double-quotes when outputting special characters such as \n or they come out literally.<br />
<br />
...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81269""></a>
  <div class="note">
   <strong class="user">dharris dot nospam at removethispart dot drh dot net</strong>
   <a href="#81269" class="date">20-Feb-2008 10:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some people say that when writing to a socket not all of the bytes requested to be written may be written. You may have to call fwrite again to write bytes that were not written the first time. (At least this is how the write() system call in UNIX works.)<br />
<br />
This is helpful code (warning: not tested with multi-byte character sets)<br />
<br />
function fwrite_with_retry($sock, &amp;$data)<br />
{<br />
&nbsp;&nbsp;&nbsp; $bytes_to_write = strlen($data);<br />
&nbsp;&nbsp;&nbsp; $bytes_written = 0;<br />
<br />
&nbsp;&nbsp;&nbsp; while ( $bytes_written &lt; $bytes_to_write )<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( $bytes_written == 0 ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $rv = fwrite($sock, $data);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $rv = fwrite($sock, substr($data, $bytes_written));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( $rv === false || $rv == 0 )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return( $bytes_written == 0 ? false : $bytes_written );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $bytes_written += $rv;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $bytes_written;<br />
}<br />
<br />
Call this like so:<br />
<br />
&nbsp;&nbsp;&nbsp; $rv = fwrite_with_retry($sock, $request_string);<br />
<br />
&nbsp;&nbsp;&nbsp; if ( ! $rv )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; die("unable to write request_string to socket");<br />
&nbsp;&nbsp;&nbsp; if ( $rv != strlen($request_string) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; die("sort write to socket on writing request_string");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80421""></a>
  <div class="note">
   <strong class="user">mesho</strong>
   <a href="#80421" class="date">15-Jan-2008 02:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
be easy :)), this works fine<br />
<br />
&lt;?<br />
<br />
$file = "counter.txt";<br />
<br />
if ( !file_exists($file)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; touch ($file);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $handle = fopen ($file, 'r+'); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $str = "&lt;? \$count=0 ?&gt;";<br />
<br />
}<br />
else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; include "counter.txt";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $count++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $str = "&lt;? \$count=".$count." ?&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $handle = fopen ($file, 'r+'); <br />
}<br />
<br />
fwrite ($handle, $str); <br />
fclose ($handle); <br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77608""></a>
  <div class="note">
   <strong class="user">chad 0x40 herballure 0x2e com</strong>
   <a href="#77608" class="date">05-Sep-2007 10:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Remember to check the return value of fwrite(). In particular, writing into a socket can return fewer bytes than requested, and you'll have to try again with the remainder of your data.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74203""></a>
  <div class="note">
   <strong class="user">chaobreederxl at gmail dot com</strong>
   <a href="#74203" class="date">29-Mar-2007 11:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a simple function I wrote that uses the fopen and fwrite functions to log the actions of users... very useful for tracking your members on your site. <br />
<br />
&nbsp;<span class="default">&lt;?php<br />
&nbsp;</span><span class="keyword">function </span><span class="default">loguser</span><span class="keyword">(</span><span class="default">$reason</span><span class="keyword">,</span><span class="default">$ext </span><span class="keyword">= </span><span class="string">"db"</span><span class="keyword">){<br />
&nbsp; if(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="string">"logs"</span><span class="keyword">)):<br />
&nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="string">"logs"</span><span class="keyword">,</span><span class="string">"0493"</span><span class="keyword">);<br />
&nbsp;endif;<br />
&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"logs/"</span><span class="keyword">.</span><span class="default">date</span><span class="keyword">(</span><span class="string">"m-d-y"</span><span class="keyword">).</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$ext</span><span class="keyword">, </span><span class="string">"a+"</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="string">"&lt;strong&gt;"</span><span class="keyword">.</span><span class="default">date</span><span class="keyword">(</span><span class="string">"g:i:s A"</span><span class="keyword">).</span><span class="string">"&lt;/strong&gt;: "</span><span class="keyword">.</span><span class="default">$reason</span><span class="keyword">.</span><span class="string">"&lt;br/&gt;"</span><span class="keyword">);<br />
&nbsp;}<br />
</span><span class="default">?&gt;<br />
</span><br />
To use this, just call the function like so:<br />
<br />
&lt;? loguser($_SERVER["REMOTE_ADDR"]." attempted to create another account.","html"); ?&gt;<br />
<br />
The second parameter can be changed to anything that would support HTML. If you leave out the second extension, then it automatically uses the .db extension, which works excellent for me. <br />
<br />
Hope this helps.<br />
<br />
Paul</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73764""></a>
  <div class="note">
   <strong class="user">cutmaster at fearlesss dot com</strong>
   <a href="#73764" class="date">09-Mar-2007 03:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who, like me, lost a lot of minutes (hours) to understand why fwrite doesn't create a real utf-8 file, here's the explanation I've found :<br />
<br />
I tried to do something like this :<br />
<span class="default">&lt;?php<br />
$myString </span><span class="keyword">= </span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="string">"Test with accents Ì©Ì¬ÌÊÌ¤"</span><span class="keyword">);<br />
</span><span class="default">$fh</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'test.xml'</span><span class="keyword">,</span><span class="string">"w"</span><span class="keyword">);<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">,</span><span class="default">$myString</span><span class="keyword">);<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
For a mysterious reason, the resulted file shows the accent without the utf-8 conversion.<br />
<br />
I tried the binary, mode, etc. etc. And finally I've found it :<br />
It seems that fwrite NEEDS to have the utf8_encode function INSIDE its parameters like this, to understand it must create a non-text only file :<br />
<span class="default">&lt;?php<br />
$myString </span><span class="keyword">= </span><span class="string">"Test with accents Ì©Ì¬ÌÊÌ¤"</span><span class="keyword">;<br />
</span><span class="default">$fh</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'test.xml'</span><span class="keyword">,</span><span class="string">"w"</span><span class="keyword">);<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">,</span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$myString</span><span class="keyword">));<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Hope this will help</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69566""></a>
  <div class="note">
   <strong class="user">zaccraven at junk.com</strong>
   <a href="#69566" class="date">11-Sep-2006 12:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Use this to get a UTF-8 Unicode CSV file that opens properly in Excel:<br />
<br />
$tmp = chr(255).chr(254).mb_convert_encoding( $tmp, 'UTF-16LE', 'UTF-8'); <br />
$write = fwrite( $filepath, $tmp );<br />
<br />
Use a tab character, not comma, to seperate the fields in&nbsp; the $tmp.<br />
<br />
Credit for this goes to someone called Eugene Murai, I found this solution by him after searching for several hours.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63296""></a>
  <div class="note">
   <strong class="user">santibari at yahoo dot com</strong>
   <a href="#63296" class="date">18-Mar-2006 11:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To write a specific byte into a file (let's,say 0000 0001), use the function chr().<br />
<span class="default">&lt;?php<br />
<br />
fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">,</span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x01</span><span class="keyword">),</span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55054""></a>
  <div class="note">
   <strong class="user">bahatest at ifrance doc com</strong>
   <a href="#55054" class="date">23-Jul-2005 02:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor's Note: No, you only need to use this if you want a BOM (Byte order mark) added to the document - most people do not.]<br />
<br />
if you have to write a file in UTF-8 format, you have to add an header to the file like this :<br />
<br />
<span class="default">&lt;?php<br />
$f</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"test.txt"</span><span class="keyword">, </span><span class="string">"wb"</span><span class="keyword">);<br />
</span><span class="default">$text</span><span class="keyword">=</span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="string">"a!"</span><span class="keyword">);<br />
</span><span class="comment">// adding header<br />
</span><span class="default">$text</span><span class="keyword">=</span><span class="string">"\xEF\xBB\xBF"</span><span class="keyword">.</span><span class="default">$text</span><span class="keyword">;<br />
</span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54506""></a>
  <div class="note">
   <strong class="user">james at nicolson dot biz</strong>
   <a href="#54506" class="date">06-Jul-2005 08:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I could'nt quite get MKP Dev hit counter to work.... this is how I modified it<br />
&lt;?<br />
function hitcount()<br />
{<br />
$file = "counter.txt";<br />
if ( !file_exists($file)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; touch ($file);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $handle = fopen ($file, 'r+'); // Let's open for read and write<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $count = 0;<br />
<br />
}<br />
else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $handle = fopen ($file, 'r+'); // Let's open for read and write<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $count = fread ($handle, filesize ($file));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; settype ($count,"integer");<br />
}<br />
rewind ($handle); // Go back to the beginning<br />
/*<br />
&nbsp;* Note that we don't have problems with 9 being fewer characters than<br />
&nbsp; * 10 because we are always incrementing, so we will always write at<br />
&nbsp;&nbsp; * least as many characters as we read<br />
&nbsp;&nbsp;&nbsp; **/<br />
fwrite ($handle, ++$count); // Don't forget to increment the counter<br />
fclose ($handle); // Done <br />
<br />
return $count;<br />
}&nbsp; &nbsp; &nbsp; <br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53622""></a>
  <div class="note">
   <strong class="user">albert;cutthis; at ;coznospam;ribox dot nl</strong>
   <a href="#53622" class="date">07-Jun-2005 09:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To write 'true binary' files combine with pack() :<br />
<br />
$a = 65530;<br />
$fp = fopen('test.dat', 'w');<br />
fwrite($fp, pack('L', $a));<br />
fclose($fp);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52783""></a>
  <div class="note">
   <strong class="user">MKP Dev</strong>
   <a href="#52783" class="date">12-May-2005 05:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
bluevd at gmail dot com mentioned a hit counter. In his/her implementation, the file is first opened, read, closed, then opened +truncated, then written, and closed again. An alternative to this is:<br />
<span class="default">&lt;?php<br />
$file </span><span class="keyword">= </span><span class="string">'counter.txt or whatever'</span><span class="keyword">;<br />
</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="string">'r+'</span><span class="keyword">); </span><span class="comment">// Let's open for read and write<br />
</span><span class="default">$count </span><span class="keyword">= </span><span class="default">int </span><span class="keyword">(</span><span class="default">fread </span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">filesize </span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)));<br />
</span><span class="comment">// We don't want to think it's a string and try appending<br />
</span><span class="keyword">echo </span><span class="string">"Number of hits </span><span class="default">$count</span><span class="string">"</span><span class="keyword">;<br />
</span><span class="default">rewind </span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">); </span><span class="comment">// Go back to the beginning<br />
/*<br />
&nbsp;* Note that we don't have problems with 9 being fewer characters than<br />
&nbsp;* 10 because we are always incrementing, so we will always write at<br />
&nbsp;* least as many characters as we read<br />
&nbsp;**/<br />
</span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, ++</span><span class="default">$count</span><span class="keyword">); </span><span class="comment">// Don't forget to increment the counter<br />
</span><span class="default">fclose </span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">); </span><span class="comment">// Done<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51278""></a>
  <div class="note">
   <strong class="user">Will  at  EnigmaChannel dot com</strong>
   <a href="#51278" class="date">25-Mar-2005 06:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using fwrite to write to a file in your include folder...<br />
<br />
PHP does not recognise the permissions setting for the file until you restart the server... this script works fine. (still have to create the blank text file first though...it is not created automatically) On OS X Server..<br />
Using the 1 in fopen tells php to look for the file in your include folder. Change your include folder by altering include_path in php.ini<br />
On OS X Server, php.ini is in private/etc/php.ini.default<br />
copy the file and call it php.ini<br />
<br />
the default include path is usr/lib/php<br />
(All these folders are hidden - use TinkerTool to reveal them)<br />
<br />
<span class="default">&lt;?php<br />
$file </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'textfile.txt'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">$text</span><span class="keyword">=</span><span class="string">"\n Your text to write \n "</span><span class="keyword">.</span><span class="default">date</span><span class="keyword">(</span><span class="string">'d'</span><span class="keyword">).</span><span class="string">"-"</span><span class="keyword">.</span><span class="default">date</span><span class="keyword">(</span><span class="string">'m'</span><span class="keyword">).</span><span class="string">"-"</span><span class="keyword">.</span><span class="default">date</span><span class="keyword">(</span><span class="string">'Y'</span><span class="keyword">).</span><span class="string">"\n\n"</span><span class="keyword">;<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">); <br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50094""></a>
  <div class="note">
   <strong class="user">goodwork at myrealbox dot com</strong>
   <a href="#50094" class="date">17-Feb-2005 12:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
difficulty appending to file in SAFE MODE ON<br />
if you are getting resource errors etc try this...<br />
<br />
$textline="whatever string you submitted or created";<br />
$filename="afilename.log"; // or whatever your path and filename <br />
&nbsp;if (!$handle = fopen($filename, 'a')) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo "Cannot open file ($filename)"; // or handle your error<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; exit; }<br />
$textline.="\n"; // dont forget that period<br />
// now write content to our opened file.<br />
&nbsp;IF (fwrite($handle,$textline) === FALSE) <br />
&nbsp;&nbsp;&nbsp; {echo "Cannot write to file ($filename)";// or handle your error<br />
&nbsp;&nbsp; &nbsp; &nbsp; exit;}<br />
&nbsp;&nbsp; &nbsp; echo "Success, wrote ($textline) to file ($filename)";<br />
fclose($handle);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49840""></a>
  <div class="note">
   <strong class="user">sheyh</strong>
   <a href="#49840" class="date">09-Feb-2005 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you want to create quickly and without fopen use system, exec<br />
<br />
system('echo "blahblah" &gt; /path/file');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49647""></a>
  <div class="note">
   <strong class="user">kzevian at cybercable dot net dot mx</strong>
   <a href="#49647" class="date">03-Feb-2005 11:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed to append, but I needed to write on the file's beginning, and after some hours of effort this worked for me:<br />
<br />
$file = "file.txt";<br />
if (!file_exists("file.txt")) touch("file.txt");<br />
$fh = fopen("file.txt", "r");<br />
$fcontent = fread($fh, filesize("file.txt"));<br />
<br />
$towrite = "$newcontent $fcontent";<br />
<br />
$fh22 = fopen('file.txt', 'w+');<br />
fwrite($fh2, $towrite);<br />
fclose($fh);<br />
fclose($fh2);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48408""></a>
  <div class="note">
   <strong class="user">bluevd at gmail dot com</strong>
   <a href="#48408" class="date">22-Dec-2004 09:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Watch out for mistakes in writting a simple code for a hit counter:<br />
<span class="default">&lt;?php<br />
$cont</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'cont.txt'</span><span class="keyword">,</span><span class="string">'r'</span><span class="keyword">);<br />
</span><span class="default">$incr</span><span class="keyword">=</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$cont</span><span class="keyword">);<br />
</span><span class="comment">//echo $incr;<br />
</span><span class="default">$incr</span><span class="keyword">++;<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$cont</span><span class="keyword">);<br />
</span><span class="default">$cont</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'cont.txt'</span><span class="keyword">,</span><span class="string">'a'</span><span class="keyword">);<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$cont</span><span class="keyword">,</span><span class="default">$incr</span><span class="keyword">);<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$cont</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Why? notice the second fopen -&gt; $cont=fopen('cont.txt','a');<br />
it opens the file in writting mode (a). And when it ads the incremented<br />
value ( $incr ) it ads it ALONG the old value... so opening the counter<br />
page about 5 times will make your hits number look like this<br />
012131214121312151.21312141213E+ .... you get the piont.<br />
nasty, isn't it? REMEMBER to open the file with the 'w' mode (truncate<br />
the file to 0). Doing this will clear the file content and it will make sure that<br />
your counter works nice. This is the final code<br />
<br />
<span class="default">&lt;?php<br />
$cont</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'cont.txt'</span><span class="keyword">,</span><span class="string">'r'</span><span class="keyword">);<br />
</span><span class="default">$incr</span><span class="keyword">=</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$cont</span><span class="keyword">);<br />
</span><span class="comment">//echo $incr;<br />
</span><span class="default">$incr</span><span class="keyword">++;<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$cont</span><span class="keyword">);<br />
</span><span class="default">$cont</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'cont.txt'</span><span class="keyword">,</span><span class="string">'w'</span><span class="keyword">);<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$cont</span><span class="keyword">,</span><span class="default">$incr</span><span class="keyword">);<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$cont</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Notice that this work fine =)<br />
XU (alias Iscu Andrei)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46882""></a>
  <div class="note">
   <strong class="user">chill at cuna dot org</strong>
   <a href="#46882" class="date">26-Oct-2004 03:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In PHP 4.3.7 fwrite returns 0 rather than false on failure.<br />
The following example will output "SUCCESS: 0 bytes written" for existing file test.txt:<br />
<br />
$fp = fopen("test.txt", "rw");<br />
if (($bytes_written = fwrite($fp, "This is a test")) === false) {<br />
&nbsp; echo "Unable to write to test.txt\n\n";<br />
} else {<br />
&nbsp; echo "SUCCESS: $bytes_written bytes written\n\n";<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35166""></a>
  <div class="note">
   <strong class="user">php at biggerthanthebeatles dot com</strong>
   <a href="#35166" class="date">21-Aug-2003 03:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hope this helps other newbies.<br />
<br />
If you are writing data to a txt file on a windows system and need a line break. use \r\n . This will write hex OD OA.<br />
<br />
i.e.<br />
$batch_data= "some data... \r\n";<br />
fwrite($fbatch,$batch_data);<br />
<br />
The is the equivalent of opening a txt file in notepad pressing enter and the end of the line and saving it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="34153""></a>
  <div class="note">
   <strong class="user">Andi</strong>
   <a href="#34153" class="date">17-Jul-2003 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Ed. Note:<br />
The runtime configuration setting auto_detect_line_endings should solve this problem when set to On.]<br />
<br />
I figured out problems when writing to a file using \r as linebreak, after that file() wasn't able to read the data from that file.<br />
Using \n solved the problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33253""></a>
  <div class="note">
   <strong class="user">chedong at hotmail dot com</strong>
   <a href="#33253" class="date">20-Jun-2003 02:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
the fwrite output striped the slashes if without length argument given, example:<br />
<br />
<span class="default">&lt;?php<br />
$str </span><span class="keyword">= </span><span class="string">"c:\\01.txt"</span><span class="keyword">;<br />
</span><span class="default">$out </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"out.txt"</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">);<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
the out.txt will be:<br />
c:^@1.txt<br />
the '\\0' without escape will be '\0' ==&gt; 0x00.<br />
<br />
the correct one is change fwrite to:<br />
fwrite($out, $str, strlen($str));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32695""></a>
  <div class="note">
   <strong class="user">Jake Roberts</strong>
   <a href="#32695" class="date">04-Jun-2003 11:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Use caution when using:<br />
<br />
$content = fread($fh, filesize($fh)) or die "Error Reading";<br />
<br />
This will cause an error if the file you are reading is zero length.<br />
<br />
Intead use:<br />
<br />
if ( false === fread($fh, filesize($fh)) ) die "Error Reading";<br />
<br />
Thus it will be successful on reading zero bytes but detect and error returned as FALSE.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32153""></a>
  <div class="note">
   <strong class="user">Chris Blown</strong>
   <a href="#32153" class="date">19-May-2003 03:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't forget to check fwrite returns for errors! Just because you successfully opened a file for write, doesn't always mean you can write to it.&nbsp; <br />
<br />
On some systems this can occur if the filesystem is full, you can still open the file and create the filesystem inode, but the fwrite will fail, resulting in a zero byte file.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29328""></a>
  <div class="note">
   <strong class="user">seeker at seek dot planet</strong>
   <a href="#29328" class="date">09-Feb-2003 10:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[[Editors note: There is no "prepend" mode, you must essentially rewrite the entire file after prepending contents to a string. Perhaps you will use file(), modify, implode(), then fopen()/fwrite() it back]]<br />
To put strings into the front of the file, you need to set place the pointer at the top of the file when openning the file with fopen(), see fopen() for more info.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.ftruncate.html">ftruncate</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.glob.html">glob</a></div>
 <div class="up"><a href="ref.filesystem.html">Filesystem Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

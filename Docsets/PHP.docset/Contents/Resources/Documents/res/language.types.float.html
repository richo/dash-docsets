<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Floating point numbers</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="language.types.integer.html">Integers</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="language.types.string.html">Strings</a></div>
 <div class="up"><a href="language.types.html">Types</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="language.types.float" class="sect1">
 <h2 class="title">Floating point numbers</h2>

 <p class="para">
  Floating point numbers (also known as &quot;floats&quot;, &quot;doubles&quot;, or &quot;real numbers&quot;)
  can be specified using any of the following syntaxes:
 </p>

 <div class="informalexample">
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1.234</span><span style="color: #007700">;&nbsp;<br /></span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1.2e3</span><span style="color: #007700">;&nbsp;<br /></span><span style="color: #0000BB">$c&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">7E-10</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
  </div>

 </div>

 <p class="para">
  Formally:
 </p>

 <div class="informalexample">
  <div class="example-contents">
<div class="cdata"><pre>
LNUM          [0-9]+
DNUM          ([0-9]*[\.]{LNUM}) | ({LNUM}[\.][0-9]*)
EXPONENT_DNUM [+-]?(({LNUM} | {DNUM}) [eE][+-]? {LNUM})
</pre></div>
  </div>

 </div>

 <p class="para">
  The size of a float is platform-dependent, although a maximum of ~1.8e308 with
  a precision of roughly 14 decimal digits is a common value (the 64 bit IEEE
  format).
 </p>

 <div class="warning"><b class="warning">Warning</b>
  <h1 class="title">Floating point precision</h1>

  <p class="para">
   Floating point numbers have limited precision. Although it depends on the
   system, PHP typically uses the IEEE 754 double precision format, which will
   give a maximum relative error due to rounding in the order of 1.11e-16.
   Non elementary arithmetic operations may give larger errors, and, of course,
   error propagation must be considered when several operations are
   compounded.
  </p>
  
  <p class="para">
   Additionally, rational numbers that are exactly representable as floating
   point numbers in base 10, like <i>0.1</i> or
   <i>0.7</i>, do not have an exact representation as floating
   point numbers in base 2, which is used internally, no matter the size of
   the mantissa. Hence, they cannot be converted into their internal binary
   counterparts without a small loss of precision. This can lead to confusing
   results: for example, <i>floor((0.1+0.7)*10)</i> will usually
   return <i>7</i> instead of the expected <i>8</i>,
   since the internal representation will be something like
   <i>7.9999999999999991118...</i>.
  </p>

  <p class="para">
   So never trust floating number results to the last digit, and never compare
   floating point numbers for equality. If higher precision is necessary,
   the <a href="ref.bc.html" class="link">arbitrary precision math functions</a> and
   <a href="ref.gmp.html" class="link">gmp</a> functions are available.
  </p>
 </div>

 <div class="sect2" id="language.types.float.casting">
  <h3 class="title">Converting to float</h3>
  
  <p class="para">
   For information on converting <span class="type"><a href="language.types.string.html" class="type string">string</a></span>s to <span class="type"><a href="language.types.float.html" class="type float">float</a></span>, see
   <a href="language.types.string.html#language.types.string.conversion" class="link">String conversion to
   numbers</a>. For values of other types, the conversion is performed by
   converting the value to <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> first and then to
   <span class="type"><a href="language.types.float.html" class="type float">float</a></span>. See
   <a href="language.types.integer.html#language.types.integer.casting" class="link">Converting to integer</a>
   for more information. As of PHP 5, a notice is thrown if an
   <span class="type"><a href="language.types.object.html" class="type object">object</a></span> is converted to <span class="type"><a href="language.types.float.html" class="type float">float</a></span>.
  </p>

 </div>
 
 <div class="sect2" id="language.types.float.nan">
  <h3 class="title">NaN</h3>
  <p class="para">
   Some numeric operations can result in a value represented by the constant
   <b><tt>NAN</tt></b>. This result represents an undefined or
   unrepresentable value in floating-point calculations. Any loose or strict
   comparisons of this value against any other value, including itself, will
   have a result of <b><tt>FALSE</tt></b>.
  </p>
  <p class="para">
   Because <b><tt>NAN</tt></b> represents any number of different values,
   <b><tt>NAN</tt></b> should not be compared to other values, including
   itself, and instead should be checked for using <span class="function"><a href="function.is-nan.html" class="function">is_nan()</a></span>.
  </p>
 </div>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="106145""></a>
  <div class="note">
   <strong class="user">reinaldorock at yahoo dot com dot br</strong>
   <a href="#106145" class="date">13-Oct-2011 07:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Convert locale string into float number<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">str2num</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">){<br />
&nbsp; if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">) &lt; </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="string">','</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="string">','</span><span class="keyword">,</span><span class="string">'.'</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (float)</span><span class="default">$str</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">str2num</span><span class="keyword">(</span><span class="string">'25,01'</span><span class="keyword">); </span><span class="comment">//25.01<br />
</span><span class="default">str2num</span><span class="keyword">(</span><span class="string">'2.5,01'</span><span class="keyword">); </span><span class="comment">//25.01<br />
</span><span class="default">str2num</span><span class="keyword">(</span><span class="string">'25.01'</span><span class="keyword">); </span><span class="comment">//25.01<br />
</span><span class="default">str2num</span><span class="keyword">(</span><span class="string">'2,5.01'</span><span class="keyword">); </span><span class="comment">//25.01<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106106""></a>
  <div class="note">
   <strong class="user">cah4a at e-mail dot ua</strong>
   <a href="#106106" class="date">11-Oct-2011 02:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Converting IEEE754 64 bit binary to float in 32bit php version:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getDouble</span><span class="keyword">(</span><span class="default">$bits</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">binary_data</span><span class="keyword">)!=</span><span class="default">64 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"wrong binary data"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sign </span><span class="keyword">= </span><span class="default">$digits</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$exp </span><span class="keyword">= </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bits</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">11</span><span class="keyword">)) - </span><span class="default">1023</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mantissa_length </span><span class="keyword">= </span><span class="default">30</span><span class="keyword">; </span><span class="comment">// This is max workable length for 32bit representation of mantissa. We not use other (52-$mantissa_length bits)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$man </span><span class="keyword">= (</span><span class="default">2 </span><span class="keyword">&lt;&lt; (</span><span class="default">$mantissa_length</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)) + </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bits</span><span class="keyword">, </span><span class="default">12</span><span class="keyword">, </span><span class="default">$mantissa_length</span><span class="keyword">)); <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$man </span><span class="keyword">* </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">$exp </span><span class="keyword">- </span><span class="default">$mantissa_length</span><span class="keyword">) * (</span><span class="default">$sign </span><span class="keyword">? -</span><span class="default">1 </span><span class="keyword">: </span><span class="default">1</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103679""></a>
  <div class="note">
   <strong class="user">maxiumswarp at gmail dot com</strong>
   <a href="#103679" class="date">27-Apr-2011 03:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found that to compare floats correctly I had to use this, it works very good for doing price comparison, such as order validation to make sure final prices are correct before they send. This is make your statements return true are false correctly.<br />
<br />
<span class="default">&lt;?php<br />
$number1</span><span class="keyword">=</span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$float1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">);<br />
</span><span class="default">$number2</span><span class="keyword">=</span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$float2</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="string">'.'''</span><span class="keyword">);<br />
if(</span><span class="default">$number1</span><span class="keyword">!=</span><span class="default">$number2</span><span class="keyword">){<br />
&nbsp;echo </span><span class="string">'do correction here!'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103209""></a>
  <div class="note">
   <strong class="user">zelko at mojeime dot com</strong>
   <a href="#103209" class="date">31-Mar-2011 01:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $binarydata32 </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">,</span><span class="string">'00000000'</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$float32 </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"f"</span><span class="keyword">, </span><span class="default">$binarydata32</span><span class="keyword">); </span><span class="comment">// 0.0<br />
<br />
&nbsp;&nbsp; </span><span class="default">$binarydata64 </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">,</span><span class="string">'0000000000000000'</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$float64 </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"d"</span><span class="keyword">, </span><span class="default">$binarydata64</span><span class="keyword">); </span><span class="comment">// 0.0<br />
</span><span class="default">?&gt;<br />
</span><br />
I get 0 both for 32-bit and 64-bit numbers.<br />
<br />
But, please don't use your own "functions" to "convert" from float to binary and vice versa. Looping performance in PHP is horrible. Using pack/unpack you use processor's encoding, which is always correct. In C++ you can access the same 32/64 data as either float/double or 32/64 bit integer. No "conversions".<br />
<br />
To get binary encoding:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $float32 </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"f"</span><span class="keyword">, </span><span class="default">5300231</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$binarydata32 </span><span class="keyword">=</span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">,</span><span class="default">$float32</span><span class="keyword">); </span><span class="comment">//"0EC0A14A"<br />
<br />
&nbsp;&nbsp; </span><span class="default">$float64 </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"d"</span><span class="keyword">, </span><span class="default">5300231</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$binarydata64 </span><span class="keyword">=</span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">,</span><span class="default">$float64</span><span class="keyword">); </span><span class="comment">//"000000C001385441"<br />
</span><span class="default">?&gt;<br />
</span><br />
And my example from half a year ago:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $binarydata32 </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">,</span><span class="string">'0EC0A14A'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$float32 </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"f"</span><span class="keyword">, </span><span class="default">$binarydata32</span><span class="keyword">); </span><span class="comment">// 5300231<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$binarydata64 </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">,</span><span class="string">'000000C001385441'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$float64 </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"d"</span><span class="keyword">, </span><span class="default">$binarydata64</span><span class="keyword">); </span><span class="comment">// 5300231<br />
</span><span class="default">?&gt;<br />
</span><br />
And please mind the Big and Little endian boys...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102789""></a>
  <div class="note">
   <strong class="user">manasseh at smartcomputerinc.com</strong>
   <a href="#102789" class="date">06-Mar-2011 07:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found that 00000000 hex was converting to 1.0 decimal. From the Wikipedia article on IEEE-754 floating point:<br />
<br />
The true significand includes 23 fraction bits to the right of the binary point and an implicit leading bit (to the left of the binary point) with value 1 unless the exponent is stored with all zeros.<br />
<br />
In hex2float32n, replace:<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $intnumber=bindec("1".$binint);<br />
<br />
with<br />
<br />
&nbsp;&nbsp; if ($exp &lt;&gt; -127)<br />
&nbsp;&nbsp; &nbsp;&nbsp; { $intnumber=bindec("1".$binint); };<br />
<br />
and then 00000000 works correctly without affecting "normal" numbers.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102126""></a>
  <div class="note">
   <strong class="user">Nstiac (info at nstiac dot com)</strong>
   <a href="#102126" class="date">28-Jan-2011 02:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There are many scripts/functions to convert a Hex string to a Floating point number, but i could'nt find any usable function to convert a float2hex (float number to hexadecimal) .. so i went on an made one! .. to my surprise.. it didn't matched the other existing functions results exactly due to different methods used on each .. so i went on an created a complementary function to have both results match float2hex32n&lt;-&gt;hex2float32n.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/** Complementary functions to CONVERT PHP FLOATING POINT NUMBERS or DECIMALS<br />
&nbsp;*&nbsp; (IEEE 754 single-precision 32 bit) TO HEXADECIMAL AND BACK.<br />
&nbsp;*&nbsp; &nbsp; <br />
&nbsp;*&nbsp; @author NSTIAC (Jorge D. Baigorri Salas) &lt;<a href="http://www.nstiac.com&gt; &lt;http://www.n2works.com&gt;" rel="nofollow" target="_blank">http://www.nstiac.com&gt; &lt;http://www.n2works.com&gt;</a><br />
&nbsp;*&nbsp; @created on 28/Jan/2010 / time spent: 2hours approx.<br />
&nbsp;*&nbsp; @special thanks to Thomas Finley's article "Floating Point" <br />
&nbsp;*&nbsp; &lt;<a href="http://tfinley.net/notes/cps104/floating.html&gt;" rel="nofollow" target="_blank">http://tfinley.net/notes/cps104/floating.html&gt;</a><br />
&nbsp;*<br />
&nbsp;*&nbsp; These functions allow to convert any php floating point numbers with the <br />
&nbsp;*&nbsp; notation 1.234 (or fixed point numbers) into their corresponding 8 digits<br />
&nbsp;*&nbsp; hexadecimal notation. (i.e.- 1557897.40 -&gt; 49BE2C4B &lt;- 1557897.40) by<br />
&nbsp;*&nbsp; disregarding their implicit format and treating them at will as either<br />
&nbsp;*&nbsp; integer, decimals, binary numbers, hexadecimal values, or plain text.<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; <br />
**/<br />
<br />
/** FLOAT2HEX32n <br />
&nbsp; * (Convert php float numbers or decimals (single-precision 32bits) to 8 digit Hexadecimal)<br />
&nbsp; * Accepts only fixed point notation decimal numbers or fractions on a string (i.e.- "1.23456")<br />
&nbsp; * @usage:<br />
&nbsp; * float2hex32n("-1557897.13"); returns "c9be2c49"<br />
**/<br />
<br />
</span><span class="keyword">function </span><span class="default">float2hex32n</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Convert non-decimal to decimal.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$number</span><span class="keyword">=</span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="default">23</span><span class="keyword">,</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Get the integer portion of $number&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$number</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$intnumber</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Check whether is a negative number to remove - sign.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$intnumber</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Convert integer to binary<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$binint</span><span class="keyword">=</span><span class="default">decbin</span><span class="keyword">(</span><span class="default">$intnumber</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Get the decimal fraction of the number<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pointnumber</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Add a 0 to treat as single decimal fraction<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pointnumber</span><span class="keyword">=</span><span class="string">"0"</span><span class="keyword">.</span><span class="default">$pointnumber</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Convert decimal values to base 2<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tmppoint</span><span class="keyword">=</span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$pointnumber</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">,</span><span class="default">23</span><span class="keyword">,</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">23</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$binpoint</span><span class="keyword">.=</span><span class="default">substr</span><span class="keyword">((string)</span><span class="default">$tmppoint</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmppoint</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">((string)</span><span class="default">$tmppoint</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmppoint</span><span class="keyword">=</span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$tmppoint</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">,</span><span class="default">23</span><span class="keyword">,</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Gather both values to get base 2 binary fraction<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$scibin</span><span class="keyword">=</span><span class="default">$binint</span><span class="keyword">.</span><span class="string">"."</span><span class="keyword">.</span><span class="default">$binpoint</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Find fraction separator "." position<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$exp</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$scibin</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Transform to scientific notation (1.x^exp)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$scibin</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binint</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">).</span><span class="string">"."</span><span class="keyword">.</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binint</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">).</span><span class="default">$binpoint</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Create mantissa<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$scibin</span><span class="keyword">&gt;</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mantissa</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$scibin</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mantissa</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$scibin</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Fill mantissa to 23 bit value<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fill23</span><span class="keyword">=</span><span class="default">23</span><span class="keyword">-</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$mantissa</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$fill23</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mantissa</span><span class="keyword">.=</span><span class="string">"0"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Convert fraction separator position to exponent value<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$exp</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) { </span><span class="default">$exp</span><span class="keyword">--; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Adjust to binary notation exponent value<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$exp</span><span class="keyword">+=</span><span class="default">127</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Convert to 8 bit binary<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$exp</span><span class="keyword">=</span><span class="default">decbin</span><span class="keyword">(</span><span class="default">$exp</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Find 1 bit sign value&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$number</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) { </span><span class="default">$sign</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; } else { </span><span class="default">$sign</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; } <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Compose final binary value<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$binfinal</span><span class="keyword">=</span><span class="default">$sign</span><span class="keyword">.</span><span class="default">$exp</span><span class="keyword">.</span><span class="default">$mantissa</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Reorganizae number into 4digit/bits packets and<br />
&nbsp;&nbsp;&nbsp; //finally convert to decimal value and to hex.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hexfinal</span><span class="keyword">.=</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hexfinal</span><span class="keyword">.=</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hexfinal</span><span class="keyword">.=</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">8</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hexfinal</span><span class="keyword">.=</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">12</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hexfinal</span><span class="keyword">.=</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">16</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hexfinal</span><span class="keyword">.=</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">20</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hexfinal</span><span class="keyword">.=</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">24</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hexfinal</span><span class="keyword">.=</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">28</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)));<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$hexfinal</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">/** Using either function will return a value which can be used on the other function<br />
&nbsp; * to return the original input. (Hope it helps =)<br />
**/ <br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Second function (HEX2FLOAT32n) converts Hexadecimal 8 digit strings to fixed decimals float numbers. <br />
<br />
(complementary to FLOAT2HEX32n above) <br />
<br />
<span class="default">&lt;?php <br />
<br />
</span><span class="comment">/** Complementary functions to CONVERT PHP FLOATING POINT NUMBERS or DECIMALS <br />
&nbsp;*&nbsp; (IEEE 754 single-precision 32 bit) TO HEXADECIMAL AND BACK. <br />
&nbsp;*&nbsp; &nbsp; <br />
&nbsp;*&nbsp; @author NSTIAC (Jorge D. Baigorri Salas) &lt;<a href="http://www.nstiac.com&gt; &lt;http://www.n2works.com&gt; " rel="nofollow" target="_blank">http://www.nstiac.com&gt; &lt;http://www.n2works.com&gt; </a><br />
&nbsp;*&nbsp; @created on 28/Jan/2010 / time spent: 2hours approx. <br />
&nbsp;*&nbsp; @special thanks to Thomas Finley's article "Floating Point" <br />
&nbsp;*&nbsp; &lt;<a href="http://tfinley.net/notes/cps104/floating.html&gt; " rel="nofollow" target="_blank">http://tfinley.net/notes/cps104/floating.html&gt; </a><br />
&nbsp;* <br />
&nbsp;*&nbsp; These functions allow to convert any php floating point numbers with the <br />
&nbsp;*&nbsp; notation 1.234 (or fixed point numbers) into their corresponding 8 digits <br />
&nbsp;*&nbsp; hexadecimal notation. (i.e.- 1557897.40 -&gt; 49BE2C4B &lt;- 1557897.40) by <br />
&nbsp;*&nbsp; disregarding their implicit format and treating them at will as either <br />
&nbsp;*&nbsp; integer, decimals, binary numbers, hexadecimal values, or plain text. <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; <br />
**/ <br />
<br />
/** HEX2FLOAT32n <br />
&nbsp; * (Convert 8 digit hexadecimal values to fixed decimals float numbers (single-precision 32bits) <br />
&nbsp; * Accepts 8 digit hexadecimal values on a string (i.e.- F1A9B02C) and single integer to fix number of decimals <br />
&nbsp; * @usage: <br />
&nbsp; * hex2float32n("c9be2c49",2); returns -&gt; "-1557897.13" <br />
**/ <br />
<br />
</span><span class="keyword">function </span><span class="default">hex2float32n</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="default">$nd</span><span class="keyword">) { <br />
&nbsp;&nbsp; </span><span class="comment">//Separate each hexadecimal digit <br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$hex</span><span class="keyword">[]=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">); <br />
&nbsp;&nbsp; } <br />
&nbsp;&nbsp; </span><span class="comment">//Convert each hexadecimal digit to integer <br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$hex</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dec</span><span class="keyword">[]=</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$hex</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]); <br />
&nbsp;&nbsp; } <br />
&nbsp;&nbsp; </span><span class="comment">//Convert each decimal value to 4bit binary and join on a string <br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$binfinal</span><span class="keyword">.=</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%04d"</span><span class="keyword">,</span><span class="default">decbin</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])); <br />
&nbsp;&nbsp; } <br />
&nbsp;&nbsp; </span><span class="comment">//Get sign 1bit value <br />
&nbsp;&nbsp; </span><span class="default">$sign</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">); <br />
&nbsp;&nbsp; </span><span class="comment">//Get exponent 8bit value <br />
&nbsp;&nbsp; </span><span class="default">$exp</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">8</span><span class="keyword">); <br />
&nbsp;&nbsp; </span><span class="comment">//Get mantissa 23bit value <br />
&nbsp;&nbsp; </span><span class="default">$mantissa</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binfinal</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">); <br />
&nbsp;&nbsp; </span><span class="comment">//Convert &amp; adjunt binary exponent to integer <br />
&nbsp;&nbsp; </span><span class="default">$exp</span><span class="keyword">=</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">$exp</span><span class="keyword">); <br />
&nbsp;&nbsp; </span><span class="default">$exp</span><span class="keyword">-=</span><span class="default">127</span><span class="keyword">; <br />
&nbsp;&nbsp; </span><span class="comment">//Assign mantissa to pre-scientific binary notation <br />
&nbsp;&nbsp; </span><span class="default">$scibin</span><span class="keyword">=</span><span class="default">$mantissa</span><span class="keyword">; <br />
&nbsp;&nbsp; </span><span class="comment">//Split $scibin into integral &amp; fraction parts through exponent <br />
&nbsp;&nbsp; </span><span class="default">$binint</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$scibin</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$exp</span><span class="keyword">); <br />
&nbsp;&nbsp; </span><span class="default">$binpoint</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$scibin</span><span class="keyword">,</span><span class="default">$exp</span><span class="keyword">); <br />
&nbsp;&nbsp; </span><span class="comment">//Convert integral binary part to decimal integer <br />
&nbsp;&nbsp; </span><span class="default">$intnumber</span><span class="keyword">=</span><span class="default">bindec</span><span class="keyword">(</span><span class="string">"1"</span><span class="keyword">.</span><span class="default">$binint</span><span class="keyword">); <br />
&nbsp;&nbsp; </span><span class="comment">//Split each binary fractional digit <br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$binpoint</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$tmppoint</span><span class="keyword">[]=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binpoint</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">); <br />
&nbsp;&nbsp; } <br />
&nbsp;&nbsp; </span><span class="comment">//Reverse order to work backwards <br />
&nbsp;&nbsp; </span><span class="default">$tmppoint</span><span class="keyword">=</span><span class="default">array_reverse</span><span class="keyword">(</span><span class="default">$tmppoint</span><span class="keyword">); <br />
&nbsp;&nbsp; </span><span class="comment">//Convert base 2 digits to decimal <br />
&nbsp;&nbsp; </span><span class="default">$tpointnumber</span><span class="keyword">=</span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$tmppoint</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]/</span><span class="default">2</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$binpoint</span><span class="keyword">),</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">); <br />
&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$binpoint</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$pointnumber</span><span class="keyword">=</span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$tpointnumber</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$binpoint</span><span class="keyword">),</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$tpointnumber</span><span class="keyword">=</span><span class="default">$tmppoint</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">].</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$pointnumber</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">); <br />
&nbsp;&nbsp; } <br />
&nbsp;&nbsp; </span><span class="comment">//Join both decimal section to get final number <br />
&nbsp;&nbsp; </span><span class="default">$floatfinal</span><span class="keyword">=</span><span class="default">$intnumber</span><span class="keyword">+</span><span class="default">$pointnumber</span><span class="keyword">; <br />
&nbsp;&nbsp; </span><span class="comment">//Convert to positive or negative based on binary sign bit <br />
&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$sign</span><span class="keyword">==</span><span class="default">1</span><span class="keyword">) { </span><span class="default">$floatfinal</span><span class="keyword">=-</span><span class="default">$floatfinal</span><span class="keyword">; } <br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="comment">//Format float number to fixed decimals required <br />
&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$floatfinal</span><span class="keyword">,</span><span class="default">$nd</span><span class="keyword">,</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">); <br />
&nbsp;&nbsp; <br />
} <br />
<br />
</span><span class="comment">/** Using either function will return a value which can be used on the other function <br />
&nbsp; * to return the original input. (Hope it helps =) <br />
**/ <br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101318""></a>
  <div class="note">
   <strong class="user">Julian L</strong>
   <a href="#101318" class="date">09-Dec-2010 07:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Convert a hex string into a 32-bit IEEE 754 float number.&nbsp; This function is 2 times faster then the below hex to 32bit function.&nbsp; This function only changes datatypes (string to int) once. Also, this function is a port from the hex to 64bit function from below.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">hexTo32Float</span><span class="keyword">(</span><span class="default">$strHex</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$strHex</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= (</span><span class="default">$v </span><span class="keyword">&amp; ((</span><span class="default">1 </span><span class="keyword">&lt;&lt; </span><span class="default">23</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">)) + (</span><span class="default">1 </span><span class="keyword">&lt;&lt; </span><span class="default">23</span><span class="keyword">) * (</span><span class="default">$v </span><span class="keyword">&gt;&gt; </span><span class="default">31 </span><span class="keyword">| </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$exp </span><span class="keyword">= (</span><span class="default">$v </span><span class="keyword">&gt;&gt; </span><span class="default">23 </span><span class="keyword">&amp; </span><span class="default">0xFF</span><span class="keyword">) - </span><span class="default">127</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$x </span><span class="keyword">* </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">$exp </span><span class="keyword">- </span><span class="default">23</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
</span><span class="comment">//example<br />
</span><span class="keyword">echo </span><span class="default">hexTo32Float</span><span class="keyword">(</span><span class="string">"C4028000"</span><span class="keyword">); </span><span class="comment">// outputs: -522<br />
</span><span class="keyword">echo </span><span class="default">hexTo32Float</span><span class="keyword">(</span><span class="string">"457F9000"</span><span class="keyword">); </span><span class="comment">// outputs: 4089<br />
</span><span class="keyword">echo </span><span class="default">hexTo32Float</span><span class="keyword">(</span><span class="string">"2D7F5"</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// outputs: 6.00804264307E-39<br />
</span><span class="keyword">echo </span><span class="default">hexTo32Float</span><span class="keyword">(</span><span class="string">"0002D7F5"</span><span class="keyword">); </span><span class="comment">// outputs: 6.00804264307E-39<br />
</span><span class="keyword">echo </span><span class="default">hexTo32Float</span><span class="keyword">(</span><span class="string">"47D9F95E"</span><span class="keyword">); </span><span class="comment">// outputs: 111602.734375<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100294""></a>
  <div class="note">
   <strong class="user">Marc</strong>
   <a href="#100294" class="date">06-Oct-2010 07:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Small float compare function<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">floatcmp</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">,</span><span class="default">$decimals</span><span class="keyword">=</span><span class="default">6</span><span class="keyword">) {<br />
&nbsp; return </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%01.'</span><span class="keyword">.</span><span class="default">$decimals</span><span class="keyword">.</span><span class="string">'f'</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">)==</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%01.'</span><span class="keyword">.</span><span class="default">$decimals</span><span class="keyword">.</span><span class="string">'f'</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100289""></a>
  <div class="note">
   <strong class="user">v_gournay at hotmail dot com</strong>
   <a href="#100289" class="date">06-Oct-2010 05:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple way to check for equality of two floating point numbers. Change the default precision according to your needs:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">IsFloatEqual</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,</span><span class="default">$precision</span><span class="keyword">=</span><span class="default">0.0000001</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (</span><span class="default">$x</span><span class="keyword">+</span><span class="default">$precision </span><span class="keyword">&gt;= </span><span class="default">$y</span><span class="keyword">) &amp;&amp; (</span><span class="default">$x</span><span class="keyword">-</span><span class="default">$precision </span><span class="keyword">&lt;= </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99341""></a>
  <div class="note">
   <strong class="user">sbditto85</strong>
   <a href="#99341" class="date">11-Aug-2010 01:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for float comparison i cast them as strings:<br />
<span class="default">&lt;?php </span><span class="keyword">(string) </span><span class="default">$floatOne </span><span class="keyword">== (string) </span><span class="default">$floatTwo ?&gt;<br />
</span>and that seems to work...although that seems sooooo wrong to do that.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98272""></a>
  <div class="note">
   <strong class="user">zelko at mojeime dot com</strong>
   <a href="#98272" class="date">05-Jun-2010 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The was talk about "converting" 32 and 64 bit IEEE754 binary numbers to PHP float. The issue isn't as much converting, since they are already in binary form, as it is casting. PHP doesn't allow direct accessing of memory, but you can still get around a bit.<br />
<br />
The right was to read floats (32 and 64 bit) is this:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $binarydata32 </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">,</span><span class="string">'0EC0A14A'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$float32 </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"f"</span><span class="keyword">, </span><span class="default">$binarydata32</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$binarydata64 </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">,</span><span class="string">'000000C001385441'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$float64 </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"d"</span><span class="keyword">, </span><span class="default">$binarydata64</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$float32</span><span class="keyword">,</span><span class="default">$float64</span><span class="keyword">,</span><span class="default">$float32</span><span class="keyword">==</span><span class="default">$float64</span><span class="keyword">);&nbsp;&nbsp; <br />
</span><span class="default">?&gt;<br />
</span><br />
The result of dump():<br />
<span class="default">&lt;?php<br />
&nbsp;</span><span class="keyword">array(</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp; [</span><span class="default">1</span><span class="keyword">]=&gt;<br />
&nbsp; </span><span class="default">float</span><span class="keyword">(</span><span class="default">5300231</span><span class="keyword">)<br />
}<br />
array(</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp; [</span><span class="default">1</span><span class="keyword">]=&gt;<br />
&nbsp; </span><span class="default">float</span><span class="keyword">(</span><span class="default">5300231</span><span class="keyword">)<br />
}<br />
</span><span class="default">bool</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)<br />
</span><span class="default">?&gt;<br />
</span><br />
Note: mind the Big and Little endian boys</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98216""></a>
  <div class="note">
   <strong class="user">magicaltux at php dot net</strong>
   <a href="#98216" class="date">01-Jun-2010 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In some cases you may want to get the maximum value for a float without getting "INF".<br />
<br />
var_dump(1.8e308); will usually show: float(INF)<br />
<br />
I wrote a tiny function that will iterate in order to find the biggest non-infinite float value. It comes with a configurable multiplicator and affine values so you can share more CPU to get a more accurate estimate.<br />
<br />
I haven't seen better values with more affine, but well, the possibility is here so if you really thing it's worth the cpu time, just try to affine more.<br />
<br />
Best results seems to be with mul=2/affine=1. You can play with the values and see what you get. The good thing is this method will work on any system.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">function </span><span class="default">float_max</span><span class="keyword">(</span><span class="default">$mul </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">, </span><span class="default">$affine </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$max </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$omax </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while((string)</span><span class="default">$max </span><span class="keyword">!= </span><span class="string">'INF'</span><span class="keyword">) { </span><span class="default">$omax </span><span class="keyword">= </span><span class="default">$max</span><span class="keyword">; </span><span class="default">$max </span><span class="keyword">*= </span><span class="default">$mul</span><span class="keyword">; }<br />
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$affine</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$pmax </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$max </span><span class="keyword">= </span><span class="default">$omax</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; while((string)</span><span class="default">$max </span><span class="keyword">!= </span><span class="string">'INF'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$omax </span><span class="keyword">= </span><span class="default">$max</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$max </span><span class="keyword">+= </span><span class="default">$pmax</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pmax </span><span class="keyword">*= </span><span class="default">$mul</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$omax</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97611""></a>
  <div class="note">
   <strong class="user">inforsci at gmail dot com</strong>
   <a href="#97611" class="date">27-Apr-2010 11:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
convert 32bit HEX values into IEEE 754 floating point <br />
<span class="default">&lt;?php <br />
<br />
$strHex </span><span class="keyword">= </span><span class="string">"C45F82ED"</span><span class="keyword">; <br />
<br />
</span><span class="default">$bin </span><span class="keyword">= </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">base_convert</span><span class="keyword">(</span><span class="default">$strHex</span><span class="keyword">, </span><span class="default">16</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">), </span><span class="default">32</span><span class="keyword">, </span><span class="string">"0"</span><span class="keyword">, </span><span class="default">STR_PAD_LEFT</span><span class="keyword">); <br />
</span><span class="default">$sign </span><span class="keyword">= </span><span class="default">$bin</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]; <br />
</span><span class="default">$exp </span><span class="keyword">= </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">)) - </span><span class="default">127</span><span class="keyword">; <br />
</span><span class="default">$man </span><span class="keyword">= (</span><span class="default">2 </span><span class="keyword">&lt;&lt; </span><span class="default">22</span><span class="keyword">) + </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">, </span><span class="default">23</span><span class="keyword">)); <br />
<br />
</span><span class="default">$dec </span><span class="keyword">= </span><span class="default">$man </span><span class="keyword">* </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">$exp </span><span class="keyword">- </span><span class="default">23</span><span class="keyword">) * (</span><span class="default">$sign </span><span class="keyword">? -</span><span class="default">1 </span><span class="keyword">: </span><span class="default">1</span><span class="keyword">); <br />
<br />
echo </span><span class="string">"Answer = " </span><span class="keyword">. </span><span class="default">$dec </span><span class="keyword">. </span><span class="string">"&lt;BR&gt;\n"</span><span class="keyword">; <br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97557""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#97557" class="date">25-Apr-2010 11:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Calculations involving float types become inaccurate when it deals with numbers with more than approximately 8 digits long where ever the decimal point is.&nbsp; This is because of how 32bit floats are commonly stored in memory.&nbsp; This means if you rely on float types while working with tiny fractions or large numbers, your calculations can end up between tiny fractions to several trillion off.<br />
<br />
This usually won't matter when converting to binary memory storage form and editing many applications' float memory addresses directly, or dealing with smaller length numbers.&nbsp; But if you're working with larger scale numbers and decimals, it's best to switch to working with other types: <a href="http://www.php.net/manual/en/refs.math.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/refs.math.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97133""></a>
  <div class="note">
   <strong class="user">pyrosphere</strong>
   <a href="#97133" class="date">02-Apr-2010 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While testing equality between two floats is usually a bad idea, if you learn how floats work on computers, you should be able to figure out when testing for equality will work and when it won't, and use this knowledge to know where you can avoid unnecessary checks that could be the straw that breaks the camel's back. Remember, rules were made to be broken, and in the real world sometimes they have to be.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95624""></a>
  <div class="note">
   <strong class="user">pgarvin76+phpmanual at gmail dot com</strong>
   <a href="#95624" class="date">12-Jan-2010 07:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When converting from float to string trailing zeros will be dropped. Consider the following example. Tested on PHP 5.3.1.<br />
<br />
<span class="default">&lt;?php<br />
$a </span><span class="keyword">= </span><span class="default">5.00500</span><span class="keyword">;<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">30.00</span><span class="keyword">;<br />
echo </span><span class="string">"a = </span><span class="default">$a</span><span class="string">\n"</span><span class="keyword">;<br />
echo </span><span class="string">"b = </span><span class="default">$b</span><span class="string">\n"</span><span class="keyword">;<br />
</span><span class="comment">/* outputs:<br />
a = 5.005<br />
b = 30<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92885""></a>
  <div class="note">
   <strong class="user">francois dot barbier at gmail dot com</strong>
   <a href="#92885" class="date">12-Aug-2009 08:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As "m dot lebkowski+php at gmail dot com" (<a href="http://www.php.net/language.types.float#81416" rel="nofollow" target="_blank">http://www.php.net/language.types.float#81416</a>) noted 9 comments below :<br />
<br />
When PHP converts a float to a string, the decimal separator used depends on the current locale conventions.<br />
<br />
However, to declare a floating point number, one must always use a full stop otherwhise the code would be locale dependent (imagine the nightmare):<br />
<span class="default">&lt;?php<br />
$float </span><span class="keyword">= </span><span class="default">1.5</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// float(1.5)<br />
</span><span class="default">$float </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Parse error: syntax error, unexpected ','<br />
</span><span class="default">$float </span><span class="keyword">= (float) </span><span class="string">'1.5'</span><span class="keyword">; </span><span class="comment">// float(1.5)<br />
</span><span class="default">$float </span><span class="keyword">= (float) </span><span class="string">'1,5'</span><span class="keyword">; </span><span class="comment">// float(1)<br />
</span><span class="default">?&gt;<br />
</span><br />
Now, if you have a string containing a localized number, you can convert it back to a floating point number using the following function:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Convert a localized number string into a floating point number<br />
&nbsp;*<br />
&nbsp;* @param&nbsp; &nbsp; &nbsp; string $sNumber The localized number string to convert.<br />
&nbsp;* @return&nbsp; &nbsp;&nbsp; float The converted number.<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">str2num</span><span class="keyword">(</span><span class="default">$sNumber</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$aConventions </span><span class="keyword">= </span><span class="default">localeConv</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sNumber </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">((string) </span><span class="default">$sNumber</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bIsNegative </span><span class="keyword">= (</span><span class="default">0 </span><span class="keyword">=== </span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'n_sign_posn'</span><span class="keyword">] &amp;&amp; </span><span class="string">'(' </span><span class="keyword">=== </span><span class="default">$sNumber</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} &amp;&amp; </span><span class="string">')' </span><span class="keyword">=== </span><span class="default">$sNumber</span><span class="keyword">{</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$sNumber</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">});<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sCharacters </span><span class="keyword">= </span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'decimal_point'</span><span class="keyword">].<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'mon_decimal_point'</span><span class="keyword">].<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'negative_sign'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sNumber </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/[^'</span><span class="keyword">.</span><span class="default">preg_quote</span><span class="keyword">(</span><span class="default">$sCharacters</span><span class="keyword">).</span><span class="string">'\d]+/'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">trim</span><span class="keyword">((string) </span><span class="default">$sNumber</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$iLength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$sNumber</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'decimal_point'</span><span class="keyword">]))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sNumber </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'decimal_point'</span><span class="keyword">], </span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$sNumber</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'mon_decimal_point'</span><span class="keyword">]))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sNumber </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'mon_decimal_point'</span><span class="keyword">], </span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$sNumber</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sNegativeSign </span><span class="keyword">= </span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'negative_sign'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$sNegativeSign</span><span class="keyword">) &amp;&amp; </span><span class="default">0 </span><span class="keyword">!== </span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'n_sign_posn'</span><span class="keyword">])<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bIsNegative </span><span class="keyword">= (</span><span class="default">$sNegativeSign </span><span class="keyword">=== </span><span class="default">$sNumber</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} || </span><span class="default">$sNegativeSign </span><span class="keyword">=== </span><span class="default">$sNumber</span><span class="keyword">{</span><span class="default">$iLength </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">});<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$bIsNegative</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sNumber </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$aConventions</span><span class="keyword">[</span><span class="string">'negative_sign'</span><span class="keyword">], </span><span class="string">''</span><span class="keyword">, </span><span class="default">$sNumber</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fNumber </span><span class="keyword">= (float) </span><span class="default">$sNumber</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$bIsNegative</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fNumber </span><span class="keyword">= -</span><span class="default">$fNumber</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$fNumber</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Example:<br />
<span class="default">&lt;?php<br />
setLocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'fr_BE.UTF-8'</span><span class="keyword">); </span><span class="comment">// decimal separator is now a comma<br />
</span><span class="default">$float </span><span class="keyword">= -</span><span class="default">123456.789</span><span class="keyword">;<br />
</span><span class="default">$string </span><span class="keyword">= (string) </span><span class="default">$float</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$float</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// float(-123456,789)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// string(11) "-123456,789"<br />
</span><span class="default">var_dump</span><span class="keyword">((float) </span><span class="default">$string</span><span class="keyword">);&nbsp; </span><span class="comment">// float(-123456)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">str2num</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)); </span><span class="comment">// float(-123456,789)<br />
</span><span class="default">?&gt;<br />
</span><br />
It also works with strings returned by the number_format() function:<br />
<span class="default">&lt;?php<br />
setLocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'fr_BE.UTF-8'</span><span class="keyword">); </span><span class="comment">// decimal separator is now a comma<br />
</span><span class="default">$conv </span><span class="keyword">= </span><span class="default">localeconv</span><span class="keyword">();<br />
</span><span class="default">$float </span><span class="keyword">= -</span><span class="default">123456.789</span><span class="keyword">;<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="default">$conv</span><span class="keyword">[</span><span class="string">'int_curr_symbol'</span><span class="keyword">].</span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$float</span><span class="keyword">, </span><span class="default">$conv</span><span class="keyword">[</span><span class="string">'frac_digits'</span><span class="keyword">], </span><span class="default">$conv</span><span class="keyword">[</span><span class="string">'decimal_point'</span><span class="keyword">], </span><span class="default">$conv</span><span class="keyword">[</span><span class="string">'thousands_sep'</span><span class="keyword">]);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$float</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// float(-123456,789)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// string(15) "EUR -123.456,79"<br />
</span><span class="default">var_dump</span><span class="keyword">((float) </span><span class="default">$string</span><span class="keyword">);&nbsp; </span><span class="comment">// float(0)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">str2num</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)); </span><span class="comment">// float(-123456,79)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91267""></a>
  <div class="note">
   <strong class="user">rob at willo dot org</strong>
   <a href="#91267" class="date">02-Jun-2009 09:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP will parse ".123" with no leading digit; just a decimal point. For a command-line example:<br />
<br />
php -r "echo 1 + .123;"<br />
<br />
The regular expression provided above does not parse it.<br />
My correction is:<br />
<br />
EXPONENT_DNUM = "[+-]?({DNUM} | ({LNUM} | {DNUM}) [eE][+-]? {LNUM})"<br />
<br />
NOTE: {LNUM} by itself is an integer, not a floating point.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90754""></a>
  <div class="note">
   <strong class="user">Bob</strong>
   <a href="#90754" class="date">07-May-2009 10:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function to convert an exponential-format float to a decimal-format float; e.g. 1.6e+12 to 1600000000000.<br />
It will help addressing the problem specified by kjohnson above.<br />
I have tested it, but not in any real world situation so any feedback/improvements/bug-reports would be appreciated.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">exp_to_dec</span><span class="keyword">(</span><span class="default">$float_str</span><span class="keyword">)<br />
</span><span class="comment">// formats a floating point number string in decimal notation, supports signed floats, also supports non-standard formatting e.g. 0.2e+2 for 20<br />
// e.g. '1.6E+6' to '1600000', '-4.566e-12' to '-0.000000000004566', '+34e+10' to '340000000000'<br />
// Author: Bob<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// make sure its a standard php float string (i.e. change 0.2e+2 to 20)<br />
&nbsp;&nbsp;&nbsp; // php will automatically format floats decimally if they are within a certain range<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$float_str </span><span class="keyword">= (string)((float)(</span><span class="default">$float_str</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// if there is an E in the float string<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if((</span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$float_str</span><span class="keyword">), </span><span class="string">'e'</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// get either side of the E, e.g. 1.6E+6 =&gt; exp E+6, num 1.6<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$exp </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$float_str</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$float_str</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// strip off num sign, if there is one, and leave it off if its + (not required)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(((</span><span class="default">$num_sign </span><span class="keyword">= </span><span class="default">$num</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) === </span><span class="string">'+'</span><span class="keyword">) || (</span><span class="default">$num_sign </span><span class="keyword">=== </span><span class="string">'-'</span><span class="keyword">)) </span><span class="default">$num </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$num_sign </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$num_sign </span><span class="keyword">=== </span><span class="string">'+'</span><span class="keyword">) </span><span class="default">$num_sign </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// strip off exponential sign ('+' or '-' as in 'E+6') if there is one, otherwise throw error, e.g. E+6 =&gt; '+'<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(((</span><span class="default">$exp_sign </span><span class="keyword">= </span><span class="default">$exp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) === </span><span class="string">'+'</span><span class="keyword">) || (</span><span class="default">$exp_sign </span><span class="keyword">=== </span><span class="string">'-'</span><span class="keyword">)) </span><span class="default">$exp </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$exp</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">"Could not convert exponential notation to decimal notation: invalid float string '</span><span class="default">$float_str</span><span class="string">'"</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// get the number of decimal places to the right of the decimal point (or 0 if there is no dec point), e.g., 1.6 =&gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$right_dec_places </span><span class="keyword">= ((</span><span class="default">$dec_pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">)) === </span><span class="default">false</span><span class="keyword">) ? </span><span class="default">0 </span><span class="keyword">: </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">, </span><span class="default">$dec_pos</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// get the number of decimal places to the left of the decimal point (or the length of the entire num if there is no dec point), e.g. 1.6 =&gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$left_dec_places </span><span class="keyword">= (</span><span class="default">$dec_pos </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) ? </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">) : </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$dec_pos</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// work out number of zeros from exp, exp sign and dec places, e.g. exp 6, exp sign +, dec places 1 =&gt; num zeros 5<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$exp_sign </span><span class="keyword">=== </span><span class="string">'+'</span><span class="keyword">) </span><span class="default">$num_zeros </span><span class="keyword">= </span><span class="default">$exp </span><span class="keyword">- </span><span class="default">$right_dec_places</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$num_zeros </span><span class="keyword">= </span><span class="default">$exp </span><span class="keyword">- </span><span class="default">$left_dec_places</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// build a string with $num_zeros zeros, e.g. '0' 5 times =&gt; '00000'<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$zeros </span><span class="keyword">= </span><span class="default">str_pad</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">$num_zeros</span><span class="keyword">, </span><span class="string">'0'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// strip decimal from num, e.g. 1.6 =&gt; 16<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$dec_pos </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) </span><span class="default">$num </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$num</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// if positive exponent, return like 1600000<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$exp_sign </span><span class="keyword">=== </span><span class="string">'+'</span><span class="keyword">) return </span><span class="default">$num_sign</span><span class="keyword">.</span><span class="default">$num</span><span class="keyword">.</span><span class="default">$zeros</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// if negative exponent, return like 0.0000016<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">else return </span><span class="default">$num_sign</span><span class="keyword">.</span><span class="string">'0.'</span><span class="keyword">.</span><span class="default">$zeros</span><span class="keyword">.</span><span class="default">$num</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// otherwise, assume already in decimal notation and return<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">else return </span><span class="default">$float_str</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90753""></a>
  <div class="note">
   <strong class="user">Bob</strong>
   <a href="#90753" class="date">07-May-2009 08:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In MySQL, many floating point number types can have a range specified using 2 values, the "precision" and the "scale" E.g. 'float(precision,scale)' for the datatype. This syntax means a number may be &lt;precision&gt; bits long, but may only have &lt;scale&gt; bits after the decimal point. E.g. a 'float(5,2)' field may have the values -999.99 to 999.99.<br />
Here is a function to validate a PHP float using this syntax:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">validate_float</span><span class="keyword">(</span><span class="default">$float</span><span class="keyword">, </span><span class="default">$precision</span><span class="keyword">, </span><span class="default">$scale</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$max </span><span class="keyword">= (float)</span><span class="default">str_pad</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="default">$precision</span><span class="keyword">-</span><span class="default">$scale</span><span class="keyword">, </span><span class="string">'9'</span><span class="keyword">).</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">str_pad</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="default">$scale</span><span class="keyword">, </span><span class="string">'9'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$min </span><span class="keyword">= (float)</span><span class="string">"-</span><span class="default">$max</span><span class="string">"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if((</span><span class="default">$float </span><span class="keyword">&lt; </span><span class="default">$min</span><span class="keyword">) || (</span><span class="default">$float </span><span class="keyword">&gt; </span><span class="default">$max</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89842""></a>
  <div class="note">
   <strong class="user">Boylett</strong>
   <a href="#89842" class="date">25-Mar-2009 10:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had trouble with comparing floats. Basicly, I was reading floats from a database, and comparing with other floats from a database, and ended up with (5.0 != 5.0) being true.<br />
<br />
Anyway, i made some simple functions which fix the problem:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">floatcmp</span><span class="keyword">(</span><span class="default">$f1</span><span class="keyword">,</span><span class="default">$f2</span><span class="keyword">,</span><span class="default">$precision </span><span class="keyword">= </span><span class="default">10</span><span class="keyword">) </span><span class="comment">// are 2 floats equal<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">$precision</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i1 </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$f1 </span><span class="keyword">* </span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i2 </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$f2 </span><span class="keyword">* </span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$i1 </span><span class="keyword">== </span><span class="default">$i2</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">floatgtr</span><span class="keyword">(</span><span class="default">$big</span><span class="keyword">,</span><span class="default">$small</span><span class="keyword">,</span><span class="default">$precision </span><span class="keyword">= </span><span class="default">10</span><span class="keyword">) </span><span class="comment">// is one float bigger than another<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">$precision</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ibig </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$big </span><span class="keyword">* </span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ismall </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$small </span><span class="keyword">* </span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$ibig </span><span class="keyword">&gt; </span><span class="default">$ismall</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">floatgtre</span><span class="keyword">(</span><span class="default">$big</span><span class="keyword">,</span><span class="default">$small</span><span class="keyword">,</span><span class="default">$precision </span><span class="keyword">= </span><span class="default">10</span><span class="keyword">) </span><span class="comment">// is on float bigger or equal to another<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">$precision</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ibig </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$big </span><span class="keyword">* </span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ismall </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$small </span><span class="keyword">* </span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$ibig </span><span class="keyword">&gt;= </span><span class="default">$ismall</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88849""></a>
  <div class="note">
   <strong class="user">info at forrest79 dot net</strong>
   <a href="#88849" class="date">10-Feb-2009 12:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My BIN to FLOAT (IEEE754), the first one doesn't work for me:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">binToFloat</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">) &gt; </span><span class="default">32</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">) &lt; </span><span class="default">32</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bin </span><span class="keyword">= </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">'0'</span><span class="keyword">, (</span><span class="default">32 </span><span class="keyword">- </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">))) . </span><span class="default">$bin</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sign </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) == </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sign </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$binExponent </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$exponent </span><span class="keyword">= -</span><span class="default">127</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">8</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$exponent </span><span class="keyword">+= (</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$binExponent</span><span class="keyword">[</span><span class="default">7 </span><span class="keyword">- </span><span class="default">$i</span><span class="keyword">]) * </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$binBase </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base </span><span class="keyword">= </span><span class="default">1.0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">23</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base </span><span class="keyword">+= (</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$binBase</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]) * </span><span class="default">pow</span><span class="keyword">(</span><span class="default">0.5</span><span class="keyword">, (</span><span class="default">$x </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">)));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$float </span><span class="keyword">= (float) </span><span class="default">$sign </span><span class="keyword">* </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">$exponent</span><span class="keyword">) * </span><span class="default">$base</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$float</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83716""></a>
  <div class="note">
   <strong class="user">an dot kovacs at gmail dot com</strong>
   <a href="#83716" class="date">08-Jun-2008 09:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Converting IEEE754 binary representation to php float:<br />
<br />
function bin2float ($bin) {<br />
&nbsp;&nbsp;&nbsp; if((ord($bin[0])&gt;&gt;7)==0) $sign=1;<br />
&nbsp;&nbsp;&nbsp; else $sign=-1;<br />
&nbsp;&nbsp;&nbsp; if((ord($bin[0])&gt;&gt;6)%2==1) $exponent=1;<br />
&nbsp;&nbsp;&nbsp; else $exponent=-127;<br />
&nbsp;&nbsp;&nbsp; $exponent+=(ord($bin[0])%64)*2;<br />
&nbsp;&nbsp;&nbsp; $exponent+=ord($bin[1])&gt;&gt;7;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $base=1.0;<br />
&nbsp;&nbsp;&nbsp; for($k=1;$k&lt;8;$k++) {<br />
&nbsp;&nbsp; &nbsp; $base+=((ord($bin[1])&gt;&gt;(7-$k))%2)*pow(0.5,$k);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for($k=0;$k&lt;8;$k++) {<br />
&nbsp;&nbsp; &nbsp; $base+=((ord($bin[2])&gt;&gt;(7-$k))%2)*pow(0.5,$k+8);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for($k=0;$k&lt;8;$k++) {<br />
&nbsp;&nbsp; &nbsp; $base+=((ord($bin[3])&gt;&gt;(7-$k))%2)*pow(0.5,$k+16);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $float=(float)$sign*pow(2,$exponent)*$base;<br />
&nbsp;&nbsp;&nbsp; return $float;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83577""></a>
  <div class="note">
   <strong class="user">kjohnson at zootweb dot com</strong>
   <a href="#83577" class="date">02-Jun-2008 12:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP switches from the standard decimal notation to exponential notation for certain "special" floats. You can see a partial list of such "special" values with this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">for( </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">100</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++ ) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tmp </span><span class="keyword">+= </span><span class="default">100000</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">round</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">),</span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
So, if you add two floats, end up with a "special" value, e.g. 1.2E+6, then put that value unmodified into an update query to store the value in a decimal column, say, you will likely get a failed transaction, since the database will see "1.2E+6" as varchar data, not decimal. Likewise, you will likely get an XSD validation error if you put the value into xml.<br />
<br />
I have to be honest: this is one of the strangest things I have seen in any language in over 20 years of coding, and it is a colossal pain to work around.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81416""></a>
  <div class="note">
   <strong class="user">m dot lebkowski+php at gmail dot com</strong>
   <a href="#81416" class="date">27-Feb-2008 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just another note about the locales. Consider the following code:<br />
<br />
<span class="default">&lt;?php <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// in polish locale decimal separator is ","<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">"pl_PL"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo (float)(string)</span><span class="default">$a</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/// prints "2", so the decimal part is dropped<br />
</span><span class="default">?&gt;<br />
</span><br />
This causes very serious problems in my opinion. In some locale combination the typecasting can be destructive.<br />
Maybe when locale decimal separator is ",", then (float)"2,5" should be recognized as "two and a half"? <br />
Anyway - bare that in mind and be very careful when casting floats to strings and back.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78668""></a>
  <div class="note">
   <strong class="user">helly at php dot net</strong>
   <a href="#78668" class="date">22-Oct-2007 12:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Floating point values have a limited precision. Hence a value might not have the same string representation after any processing. That also includes writing a floating point value in your script and directly printing it without any mathematical operations.<br />
<br />
If you would like to know more about "floats" and what IEEE 754 is read this: <a href="http://docs.sun.com/source/806-3568/ncg_goldberg.html" rel="nofollow" target="_blank">http://docs.sun.com/source/806-3568/ncg_goldberg.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71167""></a>
  <div class="note">
   <strong class="user">sinuhet</strong>
   <a href="#71167" class="date">14-Nov-2006 08:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; define</span><span class="keyword">(</span><span class="string">'EPSILON'</span><span class="keyword">, </span><span class="default">1.0e-8</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">real_cmp</span><span class="keyword">(</span><span class="default">$r1</span><span class="keyword">, </span><span class="default">$r2</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$diff </span><span class="keyword">= </span><span class="default">$r1 </span><span class="keyword">- </span><span class="default">$r2</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">abs</span><span class="keyword">(</span><span class="default">$diff</span><span class="keyword">) &lt; </span><span class="default">EPSILON </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$diff </span><span class="keyword">&lt; </span><span class="default">0 </span><span class="keyword">? -</span><span class="default">1 </span><span class="keyword">: </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">real_lt</span><span class="keyword">(</span><span class="default">$r1</span><span class="keyword">, </span><span class="default">$r2</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">real_cmp</span><span class="keyword">(</span><span class="default">$r1</span><span class="keyword">, </span><span class="default">$r2</span><span class="keyword">) &lt; </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"raw compare\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0.1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">1.0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">0.1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$i</span><span class="string">\t</span><span class="default">$n</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"\nepsilon compare\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0.1</span><span class="keyword">; </span><span class="default">real_lt</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">, </span><span class="default">1.0</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">0.1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$i</span><span class="string">\t</span><span class="default">$n</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
</span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Outputs:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; raw compare<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.1&nbsp; &nbsp;&nbsp; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.2&nbsp; &nbsp;&nbsp; 2<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.3&nbsp; &nbsp;&nbsp; 3<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.4&nbsp; &nbsp;&nbsp; 4<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.5&nbsp; &nbsp;&nbsp; 5<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.6&nbsp; &nbsp;&nbsp; 6<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.7&nbsp; &nbsp;&nbsp; 7<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.8&nbsp; &nbsp;&nbsp; 8<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.9&nbsp; &nbsp;&nbsp; 9<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 1&nbsp; &nbsp; &nbsp;&nbsp; 10<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; epsilon compare<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.1&nbsp; &nbsp;&nbsp; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.2&nbsp; &nbsp;&nbsp; 2<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.3&nbsp; &nbsp;&nbsp; 3<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.4&nbsp; &nbsp;&nbsp; 4<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.5&nbsp; &nbsp;&nbsp; 5<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.6&nbsp; &nbsp;&nbsp; 6<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.7&nbsp; &nbsp;&nbsp; 7<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.8&nbsp; &nbsp;&nbsp; 8<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0.9&nbsp; &nbsp;&nbsp; 9<br />
*/<br />
</span><span class="default">?&gt;<br />
</span><br />
So moral of this program? "Never compare floating point numbers for equality" solves only half of the problem. As seen above, even raw comparing of floats for less than (or grater than) is dangerous and epsilon (round, etc.) must be used.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68469""></a>
  <div class="note">
   <strong class="user">TAS</strong>
   <a href="#68469" class="date">27-Jul-2006 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An update regarding the james dot cridland at virginradio dot co dot uk note below, I recently tried his formula using PHP 5 and it is necessary to specify the integer precision when using the round function, otherwise the output will be 0.<br />
<br />
&lt;? echo round((69.1-floor(69.1))); ?&gt; // prints 0<br />
&lt;? echo round((69.1-floor(69.1)), 1); ?&gt; // prints 0.1<br />
<br />
Also, it appears that "small numbers" include everything up to 64.0.&nbsp; So that<br />
<br />
&lt;? echo (63.1-floor(63.1)); ?&gt;<br />
<br />
will print 0.1 and<br />
<br />
&lt;? echo (64.0-floor(64.0)); ?&gt;<br />
<br />
will print 0, but<br />
<br />
&lt;? echo round(64.1-floor(64.1)); ?&gt;<br />
<br />
will print 0.099999999999994.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63619""></a>
  <div class="note">
   <strong class="user">david at davidmosesNO dot SPAM dot ca</strong>
   <a href="#63619" class="date">25-Mar-2006 01:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Re: rick at ninjafoo dot com<br />
<br />
There is no need to always use the BCMath functions. We just need to heed the documentation and never compare floating point numbers for equality.<br />
<br />
The reason (19.6*100) !== (double)1960, is because inside a computer they are not equal.<br />
<br />
Try this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
printf</span><span class="keyword">(</span><span class="string">"%.15f"</span><span class="keyword">, (</span><span class="default">19.6</span><span class="keyword">*</span><span class="default">100</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Outputs: 1960.000000000000227 (not 1960 as somewhat expected)<br />
<br />
If comparison is required a few options come to mind (other than BCMath):<br />
<br />
1) Round numbers before comparison:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$sig_figs </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">;<br />
echo (</span><span class="default">round</span><span class="keyword">((</span><span class="default">19.6</span><span class="keyword">*</span><span class="default">100</span><span class="keyword">), </span><span class="default">$sig_figs</span><span class="keyword">) !== </span><span class="default">round</span><span class="keyword">((double)</span><span class="default">1960</span><span class="keyword">, </span><span class="default">$sig_figs</span><span class="keyword">)) ? </span><span class="string">'not equal' </span><span class="keyword">: </span><span class="string">'equal'</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Outputs: equal<br />
<br />
2) Another method is to use a tolerance value, and consider numbers equal if their difference is less than the tolerance.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58824""></a>
  <div class="note">
   <strong class="user">Luzian</strong>
   <a href="#58824" class="date">17-Nov-2005 12:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful when using float values in strings that are used as code later, for example when generating JavaScript code or SQL statements. The float is actually formatted according to the browser's locale setting, which means that "0.23" will result in "0,23". Imagine something like this:<br />
<br />
$x = 0.23;<br />
$js = "var foo = doBar($x);";<br />
print $js;<br />
<br />
This would result in a different result for users with some locales. On most systems, this would print:<br />
<br />
var foo = doBar(0.23);<br />
<br />
but when for example a user from Germany arrives, it would be different:<br />
<br />
var foo = doBar(0,23);<br />
<br />
which is obviously a different call to the function. JavaScript won't state an error, additional arguments are discarded without notice, but the function doBar(a) would get 0 as parameter. Similar problems could arise anywhere else (SQL, any string used as code somewhere else). The problem persists, if you use the "." operator instead of evaluating the variable in the string.<br />
<br />
So if you REALLY need to be sure to have the string correctly formatted, use number_format() to do it!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57110""></a>
  <div class="note">
   <strong class="user">TRI0N</strong>
   <a href="#57110" class="date">23-Sep-2005 07:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a simple formula to break down a number and get rid of the decimal values.&nbsp; I built this to take a number in seconds and convert it to a readable value for Server Uptimes.<br />
<br />
<span class="default">&lt;?php<br />
$day </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">((</span><span class="default">$uptime </span><span class="keyword">/ </span><span class="default">86400</span><span class="keyword">)*</span><span class="default">1.0</span><span class="keyword">) ;<br />
</span><span class="default">$calc1 </span><span class="keyword">= </span><span class="default">$day </span><span class="keyword">* </span><span class="default">86400 </span><span class="keyword">;<br />
</span><span class="default">$calc2 </span><span class="keyword">= </span><span class="default">$uptime </span><span class="keyword">- </span><span class="default">$calc1 </span><span class="keyword">;<br />
</span><span class="default">$hour </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">((</span><span class="default">$calc2 </span><span class="keyword">/ </span><span class="default">3600</span><span class="keyword">)*</span><span class="default">1.0</span><span class="keyword">) ;<br />
if (</span><span class="default">$hour </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">) {<br />
</span><span class="default">$hour </span><span class="keyword">= </span><span class="string">"0"</span><span class="keyword">.</span><span class="default">$hour </span><span class="keyword">;<br />
}<br />
</span><span class="default">$calc3 </span><span class="keyword">= </span><span class="default">$hour </span><span class="keyword">* </span><span class="default">3600 </span><span class="keyword">;<br />
</span><span class="default">$calc4 </span><span class="keyword">= </span><span class="default">$calc2 </span><span class="keyword">- </span><span class="default">$calc3 </span><span class="keyword">;<br />
</span><span class="default">$min </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">((</span><span class="default">$calc4 </span><span class="keyword">/ </span><span class="default">60</span><span class="keyword">)*</span><span class="default">1.0</span><span class="keyword">) ;<br />
if (</span><span class="default">$min </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">) {<br />
</span><span class="default">$min </span><span class="keyword">= </span><span class="string">"0"</span><span class="keyword">.</span><span class="default">$min </span><span class="keyword">;<br />
}<br />
</span><span class="default">$calc5 </span><span class="keyword">= </span><span class="default">$min </span><span class="keyword">* </span><span class="default">60 </span><span class="keyword">;<br />
</span><span class="default">$sec </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">((</span><span class="default">$calc4 </span><span class="keyword">- </span><span class="default">$calc5</span><span class="keyword">)*</span><span class="default">1.0</span><span class="keyword">) ;<br />
if (</span><span class="default">$min </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">) {<br />
</span><span class="default">$sec </span><span class="keyword">= </span><span class="string">"0"</span><span class="keyword">.</span><span class="default">$sec </span><span class="keyword">;<br />
}<br />
</span><span class="default">$uptime2 </span><span class="keyword">= </span><span class="default">$day</span><span class="keyword">.</span><span class="string">" Days, "</span><span class="keyword">.</span><span class="default">$hour</span><span class="keyword">.</span><span class="string">":"</span><span class="keyword">.</span><span class="default">$min</span><span class="keyword">.</span><span class="string">":"</span><span class="keyword">.</span><span class="default">$sec </span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Place this where you want the results to be seen:<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$uptime2 </span><span class="keyword">; </span><span class="default">?&gt;<br />
</span><br />
For a Value of 1455587 seconds the results will show as followed:<br />
16 Days, 20:19:47<br />
<br />
Enjoy</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54494""></a>
  <div class="note">
   <strong class="user">rick at ninjafoo dot com</strong>
   <a href="#54494" class="date">06-Jul-2005 01:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Concider the following:<br />
<br />
(19.6*100) != 1960&nbsp; <br />
<br />
echo gettype(19.6*100) returns 'double', However even ..... <br />
<br />
(19.6*100) !== (double)1960 <br />
<br />
19.6*100 cannot be compaired to anything without manually <br />
casting it as something else first. <br />
<br />
(string)(19.6*100) == 1960<br />
<br />
Rule of thumb, if it has a decimal point, use the BCMath functions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44692""></a>
  <div class="note">
   <strong class="user">feline at NOSPAM dot penguin dot servehttp dot com</strong>
   <a href="#44692" class="date">12-Aug-2004 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
General computing hint: If you're keeping track of money, do yourself and your users the favor of handling everything internally in cents and do as much math as you can in integers. Store values in cents if at all possible. Add and subtract in cents. At every operation that wii involve floats, ask yourself "what will happen in the real world if I get a fraction of a cent here" and if the answer is that this operation will generate a transaction in integer cents, do not try to carry fictional fractional accuracy that will only screw things up later.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35591""></a>
  <div class="note">
   <strong class="user">gallico_ at hotmail dot com</strong>
   <a href="#35591" class="date">07-Sep-2003 08:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To complete the thread about testing two floating point numbers for equality, here's the way it works for *every* programming language:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// two fp numbers should be considered equal if their absolute<br />
// difference does not exceed a certain value epsilon:<br />
</span><span class="default">$epsilon </span><span class="keyword">= </span><span class="default">0.0001</span><span class="keyword">; </span><span class="comment">// this defines the precision of your comparision<br />
// check their absolute difference<br />
</span><span class="keyword">if (</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$one_float </span><span class="keyword">- </span><span class="default">$another_float</span><span class="keyword">) &lt; </span><span class="default">$epsilon</span><span class="keyword">)<br />
&nbsp;&nbsp; </span><span class="comment">// what to be done in case the numbers are equal goes here<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31622""></a>
  <div class="note">
   <strong class="user">james dot cridland at virginradio dot co dot uk</strong>
   <a href="#31622" class="date">28-Apr-2003 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The 'floating point precision' box in practice means:<br />
<br />
&lt;? echo (69.1-floor(69.1)); ?&gt;<br />
Think this'll return 0.1?<br />
It doesn't - it returns 0.099999999999994<br />
<br />
&lt;? echo round((69.1-floor(69.1))); ?&gt;<br />
This returns 0.1 and is the workaround we use.<br />
<br />
Note that<br />
&lt;? echo (4.1-floor(4.1)); ?&gt;<br />
*does* return 0.1 - so if you, like us, test this with low numbers, you won't, like us, understand why all of a sudden your script stops working, until you spend a lot of time, like us, debugging it.<br />
<br />
So, that's all lovely then.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31261""></a>
  <div class="note">
   <strong class="user">dev at maintainfit dot com</strong>
   <a href="#31261" class="date">15-Apr-2003 11:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was programming an accounting application in MySql that required me to sum a collection of floats and ensure that they equal zero before commiting a transaction, but as seen above a sum of floats cannot always be trusted (as was my case).&nbsp; I kept getting a very small remainder (like 1.4512431231e-14).&nbsp; Since I had used number_format(num,2) to set the precision of the numbers in the database to only two (2) decimal places, when the time comes to calculate the sum I simply multiply every number by ten (10), therby eliminating and decimal places and leaving me with integers to preform my sum.&nbsp; This worked great.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30846""></a>
  <div class="note">
   
   <a href="#30846" class="date">01-Apr-2003 02:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to "...the author probably knows what they are talking about..." above:<br />
<br />
Of course the author knows what they're talking about. The previous poster missunderstood the semantics of the author's example of the decimal representation of 1/3. The author is not suggesting that some property of decimal numbers causes the behaviour, but that the property of finite binary representations of real numbers which does cause the problem is shared by finite decimal representations. To paraphrase, the author is saying "10*(0.1+0.7) gives 7.99999... because of the binary equivalent of the fact that 1/3+2/3 gives 0.99999... when using finite decimal representations (where 1/3 == 0.33333... and 2/3 == 0.66666..., so 1/3+2/3 == (0.33333...)+(0.66666...) == 0.99999... instead of 1)."<br />
<br />
The problem occurs with finite representations of real numbers, regardless of base of the number system used.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30715""></a>
  <div class="note">
   <strong class="user">Theo Diem</strong>
   <a href="#30715" class="date">26-Mar-2003 10:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just to mention ....<br />
<br />
$something = "12.20";<br />
$value = (float) $something;<br />
<br />
Depending you locale settings (see setlocale) this will return a float number 12.2 or 12 (without decimal part, if you locale uses another symbol than dot for decimal part)<br />
<br />
Be aware if u are working with PHP using one locale setting (by setlocale) and a SQL database with other locale ....</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30198""></a>
  <div class="note">
   <strong class="user">Julian Suggate</strong>
   <a href="#30198" class="date">10-Mar-2003 06:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Never never never compare floats for equality! Even a &gt;= is asking too much of any binary computer (that's pretty much all of them ;-). It will sometimes work, but the best you can hope for is a subtle bug that will occasionally cause non-deterministic behaviour.<br />
<br />
Floats must only ever be used for proper inequalities.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30071""></a>
  <div class="note">
   <strong class="user">backov at spotbrokers-nospamplz dot com</strong>
   <a href="#30071" class="date">05-Mar-2003 01:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'd like to point out a "feature" of PHP's floating point support that isn't made clear anywhere here, and was driving me insane.<br />
<br />
This test (where var_dump says that $a=0.1 and $b=0.1)<br />
<br />
if ($a&gt;=$b) echo "blah!";<br />
<br />
Will fail in some cases due to hidden precision (standard C problem, that PHP docs make no mention of, so I assumed they had gotten rid of it). I should point out that I originally thought this was an issue with the floats being stored as strings, so I forced them to be floats and they still didn't get evaluated properly (probably 2 different problems there).<br />
<br />
To fix, I had to do this horrible kludge (the equivelant of anyway):<br />
<br />
if (round($a,3)&gt;=round($b,3)) echo "blah!";<br />
<br />
THIS works. Obviously even though var_dump says the variables are identical, and they SHOULD BE identical (started at 0.01 and added 0.001 repeatedly), they're not. There's some hidden precision there that was making me tear my hair out. Perhaps this should be added to the documentation?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29170""></a>
  <div class="note">
   <strong class="user">www.sarioz.com</strong>
   <a href="#29170" class="date">04-Feb-2003 10:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
just a comment on something the "Floating point precision" inset, which goes: "This is related to .... 0.3333333."<br />
<br />
While the author probably knows what they are talking about, this loss of precision has nothing to do with decimal notation, it has to do with representation as a floating-point binary in a finite register, such as while 0.8 terminates in decimal, it is the repeating 0.110011001100... in binary, which is truncated.&nbsp; 0.1 and 0.7 are also non-terminating in binary, so they are also truncated, and the sum of these truncated numbers does not add up to the truncated binary representation of 0.8 (which is why (floor)(0.8*10) yields a different, more intuitive, result).&nbsp; However, since 2 is a factor of 10, any number that terminates in binary also terminates in decimal.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25556""></a>
  <div class="note">
   
   <a href="#25556" class="date">27-Sep-2002 11:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
much easier:<br />
&nbsp;&nbsp; <br />
&nbsp; e.g. round(3.1415927,2) =&gt; 3.14<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; round(1092,-2) =&gt; 1100</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13048""></a>
  <div class="note">
   <strong class="user">jeroen at php dot net</strong>
   <a href="#13048" class="date">23-May-2001 07:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to round a floating point number to the nearest multiple of some number n, use the following trick:<br />
<br />
$rounded = round($number / n) * n<br />
<br />
For example, to round 12874.49 to the nearest 100-multiple (i.e. 12900), use<br />
$rounded = round($number / 100) * 100<br />
<br />
Use ceil() or floor() if you want to round down/up.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="language.types.integer.html">Integers</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="language.types.string.html">Strings</a></div>
 <div class="up"><a href="language.types.html">Types</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

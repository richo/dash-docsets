<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Fetches all the headers sent by the server in response to a HTTP request</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.base64-encode.html">base64_encode</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.get-meta-tags.html">get_meta_tags</a></div>
 <div class="up"><a href="ref.url.html">URL Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.get-headers" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">get_headers</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">get_headers</span> &mdash; <span class="dc-title">Fetches all the headers sent by the server in response to a HTTP request</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.get-headers-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><b>get_headers</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$url</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$format</tt><span class="initializer"> = 0</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><b>get_headers()</b></span> returns an array with the headers sent
   by the server in response to a HTTP request.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.get-headers-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">url</tt></i></span>
     <dd>

      <p class="para">
       The target URL.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">format</tt></i></span>
     <dd>

      <p class="para">
       If the optional <i><tt class="parameter">format</tt></i> parameter is set to non-zero,
       <span class="function"><b>get_headers()</b></span> parses the response and sets the 
       array&#039;s keys.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.get-headers-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns an indexed or associative array with the headers, or <b><tt>FALSE</tt></b> on
   failure.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.get-headers-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">5.1.3</td>
       <td align="left">
        This function now uses the default stream context, which can be
        set/changed with the <span class="function"><a href="function.stream-context-set-default.html" class="function">stream_context_set_default()</a></span>
        function.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.get-headers-examples">
 <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-3719">
    <p><b>Example #1 <span class="function"><b>get_headers()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$url&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'http://www.example.com'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">get_headers</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">get_headers</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [0] =&gt; HTTP/1.1 200 OK
    [1] =&gt; Date: Sat, 29 May 2004 12:28:13 GMT
    [2] =&gt; Server: Apache/1.3.27 (Unix)  (Red-Hat/Linux)
    [3] =&gt; Last-Modified: Wed, 08 Jan 2003 23:11:55 GMT
    [4] =&gt; ETag: &quot;3f80f-1b6-3e1cb03b&quot;
    [5] =&gt; Accept-Ranges: bytes
    [6] =&gt; Content-Length: 438
    [7] =&gt; Connection: close
    [8] =&gt; Content-Type: text/html
)

Array
(
    [0] =&gt; HTTP/1.1 200 OK
    [Date] =&gt; Sat, 29 May 2004 12:28:14 GMT
    [Server] =&gt; Apache/1.3.27 (Unix)  (Red-Hat/Linux)
    [Last-Modified] =&gt; Wed, 08 Jan 2003 23:11:55 GMT
    [ETag] =&gt; &quot;3f80f-1b6-3e1cb03b&quot;
    [Accept-Ranges] =&gt; bytes
    [Content-Length] =&gt; 438
    [Connection] =&gt; close
    [Content-Type] =&gt; text/html
)
</pre></div>
    </div>
   </div>
   <div class="example" id="example-3720">
    <p><b>Example #2 <span class="function"><b>get_headers()</b></span> using HEAD example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;By&nbsp;default&nbsp;get_headers&nbsp;uses&nbsp;a&nbsp;GET&nbsp;request&nbsp;to&nbsp;fetch&nbsp;the&nbsp;headers.&nbsp;If&nbsp;you<br />//&nbsp;want&nbsp;to&nbsp;send&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;instead,&nbsp;you&nbsp;can&nbsp;do&nbsp;so&nbsp;using&nbsp;a&nbsp;stream&nbsp;context:<br /></span><span style="color: #0000BB">stream_context_set_default</span><span style="color: #007700">(<br />&nbsp;&nbsp;&nbsp;&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'http'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'method'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'HEAD'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br />);<br /></span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_headers</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://example.com'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.get-headers-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.apache-request-headers.html" class="function" rel="rdfs-seeAlso">apache_request_headers()</a> - Fetch all HTTP request headers</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="104723""></a>
  <div class="note">
   <strong class="user">damolp at hotmail dot com</strong>
   <a href="#104723" class="date">03-Jul-2011 05:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found that this function is the slowest in obtaining the headers of a page probably because it uses a GET request rather then a HEAD request. Over 10,000,000 trials of obtaining the headers of a page from a server i found the following (results in seconds).<br />
<br />
cURL: Mean: 0.584127946. Sigma: 0.050581736.<br />
fsocketopen: Mean: 0.622114251. Sigma: 0.263170424.<br />
get_headers: Mean: 0.90375551. Sigma: 0.273823419.<br />
<br />
cURL was the fastest with fsocketopens being the second fastest. I noticed as well that fsocketopen had some outliers where as cURL did not.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101786""></a>
  <div class="note">
   <strong class="user">Lukas Najduk</strong>
   <a href="#101786" class="date">11-Jan-2011 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Unfortunately there is still no useful output format to handle redirects.<br />
<br />
This function will bring all non-broken headers into a usable format. Too bad it has to call the get_headers() funtion 2 times, but i dont see any other possibility right now.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">page_get_headers</span><span class="keyword">(</span><span class="default">$crawl_uri</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// get the array values where to split the second get headers return<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">= </span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$crawl_uri</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (empty(</span><span class="default">$headers</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return array();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$splitmarks </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$headers </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$h</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$splitmarks</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// get the "real" headers<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$headers_final </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">= </span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$crawl_uri</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$headers </span><span class="keyword">as </span><span class="default">$head</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// if the value is one of the splitmarks, start the next header<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">, </span><span class="default">$splitmarks</span><span class="keyword">) &amp;&amp; </span><span class="default">$head </span><span class="keyword">=== </span><span class="default">$splitmarks</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// get the headers name<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">": "</span><span class="keyword">, </span><span class="default">$head</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// check if the header is already existing, if yes, parse the similar header to an array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!empty(</span><span class="default">$headers_final</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">][</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$headers_final</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">][</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$headers_final</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">][</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]], </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers_final</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">][</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = array(</span><span class="default">$headers_final</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">][</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]], </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers_final</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">][</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$headers_final</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100113""></a>
  <div class="note">
   <strong class="user">Weboide</strong>
   <a href="#100113" class="date">25-Sep-2010 06:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that get_headers **WILL follow redirections** (HTTP redirections). New headers will be appended to the array if $format=0. If $format=1 each redundant header will be an array of multiple values, one for each redirection.<br />
<br />
For example:<br />
<br />
<span class="default">&lt;?php<br />
$url </span><span class="keyword">= </span><span class="string">'<a href="http://google.com" rel="nofollow" target="_blank">http://google.com</a>'</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">));<br />
</span><span class="comment">/*array(18) {<br />
&nbsp; [0]=&gt;&nbsp; string(30) "HTTP/1.0 301 Moved Permanently"<br />
&nbsp; [1]=&gt;&nbsp; string(32) "Location: <a href="http://www.google.com/" rel="nofollow" target="_blank">http://www.google.com/</a>"<br />
&nbsp; [2]=&gt;&nbsp; string(38) "Content-Type: text/html; charset=UTF-8"<br />
&nbsp; [3]=&gt;&nbsp; string(35) "Date: Sun, 26 Sep 2010 00:59:50 GMT"<br />
&nbsp; [4]=&gt;&nbsp; string(38) "Expires: Tue, 26 Oct 2010 00:59:50 GMT"<br />
&nbsp; [5]=&gt;&nbsp; string(38) "Cache-Control: public, max-age=2592000"<br />
....<br />
&nbsp; string(15) "HTTP/1.0 200 OK"<br />
&nbsp; [10]=&gt;&nbsp; string(35) "Date: Sun, 26 Sep 2010 00:59:51 GMT"<br />
&nbsp; [11]=&gt;&nbsp; string(11) "Expires: -1"<br />
&nbsp; [12]=&gt;&nbsp; string(33) "Cache-Control: private, max-age=0"<br />
.....<br />
}*/<br />
<br />
/*===========================*/<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">));<br />
</span><span class="comment">/*array(11) {<br />
&nbsp; [0]=&gt;<br />
&nbsp; string(30) "HTTP/1.0 301 Moved Permanently"<br />
&nbsp; ["Location"]=&gt;&nbsp; string(22) "<a href="http://www.google.com/" rel="nofollow" target="_blank">http://www.google.com/</a>"<br />
&nbsp; ["Content-Type"]=&gt;&nbsp; array(2) {<br />
&nbsp;&nbsp;&nbsp; [0]=&gt;&nbsp; &nbsp; string(24) "text/html; charset=UTF-8"<br />
&nbsp;&nbsp;&nbsp; [1]=&gt;&nbsp; &nbsp; string(29) "text/html; charset=ISO-8859-1"<br />
&nbsp; }<br />
&nbsp; ["Date"]=&gt;&nbsp; array(2) {<br />
&nbsp;&nbsp;&nbsp; [0]=&gt;&nbsp; &nbsp; string(29) "Sun, 26 Sep 2010 01:03:39 GMT"<br />
&nbsp;&nbsp;&nbsp; [1]=&gt;&nbsp; &nbsp; string(29) "Sun, 26 Sep 2010 01:03:39 GMT"<br />
&nbsp; }<br />
&nbsp; ["Expires"]=&gt;&nbsp; array(2) {<br />
&nbsp;&nbsp;&nbsp; [0]=&gt;&nbsp; &nbsp; string(29) "Tue, 26 Oct 2010 01:03:39 GMT"<br />
&nbsp;&nbsp;&nbsp; [1]=&gt;&nbsp; &nbsp; string(2) "-1"<br />
&nbsp; }<br />
&nbsp; ["Cache-Control"]=&gt;&nbsp; array(2) {<br />
&nbsp;&nbsp;&nbsp; [0]=&gt;&nbsp; &nbsp; string(23) "public, max-age=2592000"<br />
&nbsp;&nbsp;&nbsp; [1]=&gt;&nbsp; &nbsp; string(18) "private, max-age=0"<br />
&nbsp; }<br />
.....<br />
}*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97684""></a>
  <div class="note">
   <strong class="user">nick at innovaweb dot co dot uk</strong>
   <a href="#97684" class="date">02-May-2010 05:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Seems like there are some people who are looking for only the 3-digit HTTP response code&nbsp; - here is a quick and nasty solution:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">get_http_response_code</span><span class="keyword">(</span><span class="default">$theURL</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">= </span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$theURL</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$headers</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">9</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
How easy is that? Echo the function containing the URL you want to check the response code for, and voilÃ . Custom redirects, alternative for blocked is_file() or flie_exists() functions (like I seem to have on my servers) hence the cheap workaround. But hey - it works!<br />
<br />
Pudding</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95917""></a>
  <div class="note">
   <strong class="user">php at hm2k dot org</strong>
   <a href="#95917" class="date">28-Jan-2010 10:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Fetches all the real headers sent by the server in response to a HTTP request without redirects<br />
&nbsp;*<br />
&nbsp;* @link&nbsp; &nbsp; &nbsp; <a href="http://php.net/function.get_headers" rel="nofollow" target="_blank">http://php.net/function.get_headers</a><br />
&nbsp;* @link&nbsp; &nbsp; &nbsp; <a href="http://bugs.php.net/bug.php?id=50719 " rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=50719 </a><br />
&nbsp;*/<br />
<br />
</span><span class="keyword">function </span><span class="default">get_real_headers</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">$format</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$follow_redirect</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp; if (!</span><span class="default">$follow_redirect</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//set new default options<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$opts </span><span class="keyword">= array(</span><span class="string">'http' </span><span class="keyword">=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array(</span><span class="string">'max_redirects'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">,</span><span class="string">'ignore_errors'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">stream_context_get_default</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; </span><span class="comment">//get headers<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">=</span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">$format</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//restore default options<br />
&nbsp; </span><span class="keyword">if (isset(</span><span class="default">$opts</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$opts </span><span class="keyword">= array(</span><span class="string">'http' </span><span class="keyword">=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array(</span><span class="string">'max_redirects'</span><span class="keyword">=&gt;</span><span class="default">20</span><span class="keyword">,</span><span class="string">'ignore_errors'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">stream_context_get_default</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; </span><span class="comment">//return<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$headers</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90434""></a>
  <div class="note">
   <strong class="user">gabe at vtunnel dot com</strong>
   <a href="#90434" class="date">22-Apr-2009 01:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In some cases, you don't want get_headers to follow redirects. For example, some of my servers can access a particular website, which sends a redirect header. The site it is redirected to, however, has me firewalled. I need to take the 302 redirected url, and do something to it to give me a new url that I *can* connect to.<br />
<br />
The following will give you output similar to get_headers, except it has a timeout, and it doesn't follow redirects:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">get_headers_curl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_NOBODY</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEOUT</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">15</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">split</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$r</span><span class="keyword">;<br />
}<br />
<br />
If </span><span class="default">you </span><span class="keyword">do </span><span class="default">want to follow redirects</span><span class="keyword">, </span><span class="default">you can </span><span class="keyword">do </span><span class="default">something like this</span><span class="keyword">:<br />
<br />
</span><span class="default">$go </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
<br />
while (</span><span class="default">$go </span><span class="keyword">&amp;&amp; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">6</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">= </span><span class="default">get_headers_curl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$go </span><span class="keyword">= </span><span class="default">getNextLocation</span><span class="keyword">(</span><span class="default">$headers</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$go</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">modifyUrl</span><span class="keyword">(</span><span class="default">$go</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
}<br />
<br />
function </span><span class="default">getNextLocation</span><span class="keyword">(</span><span class="default">$headers</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">$headers</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$count</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="string">"ocation:"</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">10</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$url</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$url</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83976""></a>
  <div class="note">
   <strong class="user">info at marc-gutt dot de</strong>
   <a href="#83976" class="date">21-Jun-2008 05:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Should be the same than the original get_headers():<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'get_headers'</span><span class="keyword">)) {<br />
function </span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$format</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$host </span><span class="keyword">= isset(</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]) ? </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= isset(</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]) ? </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] : </span><span class="default">80</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= (isset(</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]) ? </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] : </span><span class="string">'/'</span><span class="keyword">) . (isset(</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]) ? </span><span class="string">'?' </span><span class="keyword">. </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fsockopen</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$fp</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hdr </span><span class="keyword">= </span><span class="string">"GET </span><span class="default">$path</span><span class="string"> HTTP/1.1\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hdr </span><span class="keyword">.= </span><span class="string">"Host: </span><span class="default">$host</span><span class="string"> \r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hdr </span><span class="keyword">.= </span><span class="string">"Connection: Close\r\n\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$hdr</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">) &amp;&amp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">1024</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$line </span><span class="keyword">== </span><span class="string">"\r\n"</span><span class="keyword">) break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">': '</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$format</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$val</span><span class="keyword">) </span><span class="default">$headers</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$headers</span><span class="keyword">[] = </span><span class="default">$key</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$headers</span><span class="keyword">[] = </span><span class="default">$line</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$headers</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
}<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83648""></a>
  <div class="note">
   <strong class="user">php dot sirlancelot at spamgourmet dot com</strong>
   <a href="#83648" class="date">05-Jun-2008 01:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I tried to replicate the native behavior as much as possible for systems that don't have the get_headers() function. Here it is:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'get_headers'</span><span class="keyword">)) {<br />
function </span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$Url</span><span class="keyword">, </span><span class="default">$Format</span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$Depth</span><span class="keyword">= </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$Depth </span><span class="keyword">&gt; </span><span class="default">5</span><span class="keyword">) return;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Parts </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$Url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">'path'</span><span class="keyword">, </span><span class="default">$Parts</span><span class="keyword">))&nbsp;&nbsp; </span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] = </span><span class="string">'/'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">'port'</span><span class="keyword">, </span><span class="default">$Parts</span><span class="keyword">))&nbsp;&nbsp; </span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] = </span><span class="default">80</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">'scheme'</span><span class="keyword">, </span><span class="default">$Parts</span><span class="keyword">)) </span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] = </span><span class="string">'http'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Return </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fsockopen</span><span class="keyword">(</span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">], </span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">], </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$fp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Out </span><span class="keyword">= </span><span class="string">'GET '</span><span class="keyword">.</span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">].(isset(</span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]) ? </span><span class="string">'?'</span><span class="keyword">.@</span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">).</span><span class="string">" HTTP/1.1\r\n"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'Host: '</span><span class="keyword">.</span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].(</span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] != </span><span class="default">80 </span><span class="keyword">? </span><span class="string">':'</span><span class="keyword">.</span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">).</span><span class="string">"\r\n"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'Connection: Close'</span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$Out</span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Redirect </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">; </span><span class="default">$RedirectUrl </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">) &amp;&amp; </span><span class="default">$InLine </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">1280</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$InLine </span><span class="keyword">== </span><span class="string">"\r\n"</span><span class="keyword">) break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$InLine </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$InLine</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$Key</span><span class="keyword">, </span><span class="default">$Value</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">': '</span><span class="keyword">, </span><span class="default">$InLine</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$Key </span><span class="keyword">== </span><span class="default">$InLine</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$Format </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Return</span><span class="keyword">[</span><span class="default">$Depth</span><span class="keyword">] = </span><span class="default">$InLine</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else&nbsp; &nbsp; </span><span class="default">$Return</span><span class="keyword">[] = </span><span class="default">$InLine</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$InLine</span><span class="keyword">, </span><span class="string">'Moved'</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) </span><span class="default">$Redirect </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$Key </span><span class="keyword">== </span><span class="string">'Location'</span><span class="keyword">) </span><span class="default">$RedirectUrl </span><span class="keyword">= </span><span class="default">$Value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$Format </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Return</span><span class="keyword">[</span><span class="default">$Key</span><span class="keyword">] = </span><span class="default">$Value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else&nbsp; &nbsp; </span><span class="default">$Return</span><span class="keyword">[] = </span><span class="default">$Key</span><span class="keyword">.</span><span class="string">': '</span><span class="keyword">.</span><span class="default">$Value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$Redirect </span><span class="keyword">&amp;&amp; !empty(</span><span class="default">$RedirectUrl</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NewParts </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$RedirectUrl</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">'host'</span><span class="keyword">, </span><span class="default">$NewParts</span><span class="keyword">))&nbsp;&nbsp; </span><span class="default">$RedirectUrl </span><span class="keyword">= </span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].</span><span class="default">$RedirectUrl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">'scheme'</span><span class="keyword">, </span><span class="default">$NewParts</span><span class="keyword">)) </span><span class="default">$RedirectUrl </span><span class="keyword">= </span><span class="default">$Parts</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">].</span><span class="string">'://'</span><span class="keyword">.</span><span class="default">$RedirectUrl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$RedirectHeaders </span><span class="keyword">= </span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$RedirectUrl</span><span class="keyword">, </span><span class="default">$Format</span><span class="keyword">, </span><span class="default">$Depth</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$RedirectHeaders</span><span class="keyword">) </span><span class="default">$Return </span><span class="keyword">= </span><span class="default">array_merge_recursive</span><span class="keyword">(</span><span class="default">$Return</span><span class="keyword">, </span><span class="default">$RedirectHeaders</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$Return</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
}}<br />
</span><span class="default">?&gt;<br />
</span>The function will handle up to five redirects.<br />
Enjoy!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80460""></a>
  <div class="note">
   <strong class="user">dxtrim at yahoo dot com</strong>
   <a href="#80460" class="date">17-Jan-2008 01:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Content-Type returns a value depending only on the extension and not the real MIME TYPE. <br />
<br />
So, bad_file.exe renamed to good_file.doc will return application/msword<br />
<br />
A file without extension returns a 404.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71114""></a>
  <div class="note">
   
   <a href="#71114" class="date">13-Nov-2006 12:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've noticed it.<br />
Some Server will simply return the false reply header if you sent 'HEAD' request instead of 'GET'. The 'GET' request header always receiving the most actual HTTP header instead of 'HEAD' request header. But If you don't mind for a fast but risky method then 'HEAD' request is better for you.<br />
<br />
btw ... this is get header with additional information such as User, Pass &amp; Refferer. ... <br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get_headers_x</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">$format</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$referer</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$user</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$authentification </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$pass</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$authline </span><span class="keyword">= </span><span class="string">"Authorization: Basic </span><span class="default">$authentification</span><span class="string">\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$referer</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$refererline </span><span class="keyword">= </span><span class="string">"Referer: </span><span class="default">$referer</span><span class="string">\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url_info</span><span class="keyword">=</span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= isset(</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]) ? </span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] : </span><span class="default">80</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fp</span><span class="keyword">=</span><span class="default">fsockopen</span><span class="keyword">(</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">], </span><span class="default">$port</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$fp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">= </span><span class="string">"GET "</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">].</span><span class="string">"?"</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">].</span><span class="string">" HTTP/1.0\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">.= </span><span class="string">"Host: "</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].</span><span class="string">":"</span><span class="keyword">.</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">].</span><span class="string">"\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">.= </span><span class="string">"Host: "</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].</span><span class="string">"\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">.= </span><span class="string">"Connection: Close\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">.= </span><span class="string">"Accept: */*\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">.= </span><span class="default">$refererline</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">.= </span><span class="default">$authline</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">.= </span><span class="string">"\r\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$head</span><span class="keyword">);&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">) or (</span><span class="default">$eoheader</span><span class="keyword">==</span><span class="default">true</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$header</span><span class="keyword">=</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">1024</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$header </span><span class="keyword">== </span><span class="string">"\r\n"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$eoheader </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$header</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$format </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">,</span><span class="default">$header</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$key </span><span class="keyword">== </span><span class="default">$header</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">[] = </span><span class="default">$header</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$header</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)+</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">[] = </span><span class="default">$header</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$headers</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Regards.<br />
Donovan</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65942""></a>
  <div class="note">
   
   <a href="#65942" class="date">10-May-2006 04:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to get headers that current PHP process is going to send back to browser, see headers_list()</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56770""></a>
  <div class="note">
   <strong class="user">stuart at sixletterwords dot com</strong>
   <a href="#56770" class="date">14-Sep-2005 12:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
hey, i came across this afew weeks ago and used the function in an app for recording info about domains that my company owns, and found that the status this returns was wrong most of the time (400 bad request or void for sites that were clearly online). then looking into it i noticed the problem was that it wasn't able to get the correct info about sites with redirections. but thats not the full problem because everything on my server was returning the wrong status too. i searched around on php.net for other info and found that fsockopen's example worked better and only needed some tweeking.<br />
<br />
heres the function i put together from it and a small change.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'get_headers'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; function </span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">$format</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$httpn</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fsockopen</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">80</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$fp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">"GET / HTTP/1.1\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"Host: </span><span class="default">$url</span><span class="string">\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"Connection: Close\r\n\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$out</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$var</span><span class="keyword">.=</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">1280</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"&lt;"</span><span class="keyword">,</span><span class="default">$var</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var</span><span class="keyword">=</span><span class="default">$var</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">,</span><span class="default">$var</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$var</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
this returns an array of the header (only problem being that if the site doesn't have correct html it'll pull in some content too).<br />
<br />
hope this'll help someone else.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55216""></a>
  <div class="note">
   <strong class="user">sey at sey dot prometheus-designs dot net</strong>
   <a href="#55216" class="date">27-Jul-2005 04:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The replacement updated get_headers function by aeontech at gmail dot com improperly formats dates when $format = 1.<br />
<br />
Replace:<br />
&lt;?<br />
else {<br />
$headers[strtolower($h2[0])] = trim($h2[1]);<br />
}<br />
?&gt;<br />
<br />
With:<br />
&lt;?<br />
else {&nbsp; &nbsp; <br />
$foo = implode( ':', $h2 );<br />
$foo = preg_replace( '/[a-zA-Z- ]*: /', '', $foo );<br />
$headers[strtolower($h2[0])] = trim( $foo );<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55190""></a>
  <div class="note">
   <strong class="user">drfickle2 at yahoo dot com</strong>
   <a href="#55190" class="date">27-Jul-2005 05:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
aeontech, this the below change adds support for SSL connections. Thanks for the code!<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset($url_info['scheme']) &amp;&amp; $url_info['scheme'] == 'https') {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $port = 443;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $fp=fsockopen('ssl://'.$url_info['host'], $port, $errno, $errstr, 30);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $port = isset($url_info['port']) ? $url_info['port'] : 80;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $fp=fsockopen($url_info['host'], $port, $errno, $errstr, 30);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54820""></a>
  <div class="note">
   
   <a href="#54820" class="date">15-Jul-2005 01:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For anyone reading the previous comments, here is code that takes into account all the previous suggestions and includes a bugfix, too.<br />
<br />
This code basically provides the "get_headers" function even on systems that are not running PHP 5.0.&nbsp; It uses strtolower() on the keys, as suggested.&nbsp; It uses the $h2 array instead of the $key, as suggested.&nbsp; It removes a line about unsetting the $key -- no reason to unset something which is no longer used.&nbsp; And I've changed the status header to be named "status" (instead of "0") in the array.&nbsp; Note that if more than one header is returned without a label, they'll be stuck in "status" -- but I think status is the only header that comes back without a label, so it works for me.&nbsp; So, first the code, then a sample of the usage:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'get_headers'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; * @return array<br />
&nbsp;&nbsp;&nbsp; * @param string $url<br />
&nbsp;&nbsp;&nbsp; * @param int $format<br />
&nbsp;&nbsp;&nbsp; * @desc Fetches all the headers<br />
&nbsp;&nbsp;&nbsp; * @author cpurruc fh-landshut de<br />
&nbsp;&nbsp;&nbsp; * @modified by dotpointer<br />
&nbsp;&nbsp;&nbsp; * @modified by aeontech<br />
&nbsp;&nbsp;&nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">$format</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url_info</span><span class="keyword">=</span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= isset(</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]) ? </span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] : </span><span class="default">80</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fp</span><span class="keyword">=</span><span class="default">fsockopen</span><span class="keyword">(</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">], </span><span class="default">$port</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$fp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">= </span><span class="string">"HEAD "</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">].</span><span class="string">"?"</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">.= </span><span class="string">" HTTP/1.0\r\nHost: "</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].</span><span class="string">"\r\n\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$head</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$header</span><span class="keyword">=</span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">1024</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$format </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$h2 </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">,</span><span class="default">$header</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// the first element is the http header type, such as HTTP/1.1 200 OK,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // it doesn't have a separate name, so we have to check for it.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$h2</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] == </span><span class="default">$header</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">[</span><span class="string">'status'</span><span class="keyword">] = </span><span class="default">$header</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">[</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$h2</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$h2</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">[] = </span><span class="default">$header</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$headers</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
OK?&nbsp; Here's the usage:<br />
<br />
<span class="default">&lt;?php<br />
$response </span><span class="keyword">= </span><span class="default">get_headers</span><span class="keyword">(</span><span class="string">'<a href="http://www.example.com/" rel="nofollow" target="_blank">http://www.example.com/</a>'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
if (!</span><span class="default">$response</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Unable to initiate connection.'</span><span class="keyword">;<br />
}<br />
else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53493""></a>
  <div class="note">
   <strong class="user">Chortos-2</strong>
   <a href="#53493" class="date">03-Jun-2005 02:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
aeontech, I'd edit your function a little... How about replacing this:<br />
<br />
&lt;?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $key = array_shift(explode(':',$header));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // the first element is the http header type, such as HTTP 200 OK,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // it doesn't have a separate name, so we have to check for it.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($key == $header)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $headers[] = $header;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $headers[$key]=substr($header,strlen($key)+2);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
?&gt;<br />
<br />
with this:<br />
<br />
&lt;?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $h2 = explode(':',$header);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // the first element is the http header type, such as HTTP/1.1 200 OK,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // it doesn't have a separate name, so we have to check for it.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($h2[0] == $header)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $headers[] = $header;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $headers[ $h2[0] ] = trim($h2[1]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
?&gt;<br />
<br />
I think it looks a bit nicer :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51591""></a>
  <div class="note">
   <strong class="user">david at nothisbit dot futuresbright dot com</strong>
   <a href="#51591" class="date">05-Apr-2005 04:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After discovering that some webservers reply with "Content-Type" and others with "Content-type" I modified the function below to use strtolower($key) to make for easy checking against these case differences.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48445""></a>
  <div class="note">
   <strong class="user">aeontech at gmail dot com</strong>
   <a href="#48445" class="date">23-Dec-2004 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to dotpointer's modification of Jamaz' solution...<br />
<br />
Here is a small modification of your function, this adds the emulation of the optional $format parameter.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'get_headers'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; * @return array<br />
&nbsp;&nbsp;&nbsp; * @param string $url<br />
&nbsp;&nbsp;&nbsp; * @param int $format<br />
&nbsp;&nbsp;&nbsp; * @desc Fetches all the headers<br />
&nbsp;&nbsp;&nbsp; * @author cpurruc fh-landshut de<br />
&nbsp;&nbsp;&nbsp; * @modified by dotpointer<br />
&nbsp;&nbsp;&nbsp; * @modified by aeontech<br />
&nbsp;&nbsp;&nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get_headers</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">$format</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url_info</span><span class="keyword">=</span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= isset(</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]) ? </span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] : </span><span class="default">80</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fp</span><span class="keyword">=</span><span class="default">fsockopen</span><span class="keyword">(</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">], </span><span class="default">$port</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$fp</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">= </span><span class="string">"HEAD "</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">].</span><span class="string">"?"</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">].</span><span class="string">" HTTP/1.0\r\nHost: "</span><span class="keyword">.@</span><span class="default">$url_info</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].</span><span class="string">"\r\n\r\n"</span><span class="keyword">;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$head</span><span class="keyword">);&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$header</span><span class="keyword">=</span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">1024</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$format </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">,</span><span class="default">$header</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// the first element is the http header type, such as HTTP 200 OK,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // it doesn't have a separate name, so we have to check for it.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$key </span><span class="keyword">== </span><span class="default">$header</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">[] = </span><span class="default">$header</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$header</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)+</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers</span><span class="keyword">[] = </span><span class="default">$header</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$headers</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.base64-encode.html">base64_encode</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.get-meta-tags.html">get_meta_tags</a></div>
 <div class="up"><a href="ref.url.html">URL Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

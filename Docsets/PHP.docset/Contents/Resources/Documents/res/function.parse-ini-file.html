<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Parse a configuration file</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.move-uploaded-file.html">move_uploaded_file</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.parse-ini-string.html">parse_ini_string</a></div>
 <div class="up"><a href="ref.filesystem.html">Filesystem Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.parse-ini-file" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">parse_ini_file</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">parse_ini_file</span> &mdash; <span class="dc-title">Parse a configuration file</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.parse-ini-file-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><b>parse_ini_file</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$filename</tt></span>
   [, <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$process_sections</tt><span class="initializer"> = false</span></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$scanner_mode</tt><span class="initializer"> = INI_SCANNER_NORMAL</span></span>
  ]] )</div>

  <p class="para rdfs-comment">
   <span class="function"><b>parse_ini_file()</b></span> loads in the
   ini file specified in <i><tt class="parameter">filename</tt></i>,
   and returns the settings in it in an associative array.
  </p>
  <p class="para">
   The structure of the ini file is the same as the <var class="filename">php.ini</var>&#039;s.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.parse-ini-file-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">filename</tt></i></span>
     <dd>

      <p class="para">
       The filename of the ini file being parsed.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">process_sections</tt></i></span>
     <dd>

      <p class="para">
       By setting the <i><tt class="parameter">process_sections</tt></i>
       parameter to <b><tt>TRUE</tt></b>, you get a multidimensional array, with
       the section names and settings included. The default
       for <i><tt class="parameter">process_sections</tt></i> is <b><tt>FALSE</tt></b>      
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">scanner_mode</tt></i></span>
     <dd>

      <p class="para">
       Can either be <b><tt>INI_SCANNER_NORMAL</tt></b> (default) or 
       <b><tt>INI_SCANNER_RAW</tt></b>. If <b><tt>INI_SCANNER_RAW</tt></b> 
       is supplied, then option values will not be parsed.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.parse-ini-file-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   The settings are returned as an associative <span class="type"><a href="language.types.array.html" class="type array">array</a></span> on success,
   and <b><tt>FALSE</tt></b> on failure.
  </p>
 </div>


 
 <div class="refsect1 changelog" id="refsect1-function.parse-ini-file-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">5.3.0</td>
       <td align="left">
         Added optional <i><tt class="parameter">scanner_mode</tt></i> parameter.
         Single quotes may now be used around variable assignments.
         Hash marks (<i>#</i>) may no longer be used as comments
         and will throw a deprecation warning if used.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">5.2.7</td>
       <td align="left">
        On syntax error this function will return <b><tt>FALSE</tt></b> rather than an empty
        array.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">5.2.4</td>
       <td align="left">
        Keys and section names consisting of numbers are now evaluated as PHP
        <a href="language.types.integer.html" class="link">integers</a> thus numbers
        starting by 0 are evaluated as octals and numbers starting by 0x are
        evaluated as hexadecimals.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">5.0.0</td>
       <td align="left">
        Values enclosed in double quotes can contain new lines.
       </td>
      </tr>

      <tr valign="middle">
       <td align="left">4.2.1</td>
       <td align="left">
        This function is now affected by <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe mode</a>
        and <a href="ini.core.html#ini.open-basedir" class="link">open_basedir</a>.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.parse-ini-file-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-2210">
    <p><b>Example #1 Contents of <var class="filename">sample.ini</var></b></p>
    <div class="example-contents">
<div class="cdata"><pre>
; This is a sample configuration file
; Comments start with &#039;;&#039;, as in php.ini

[first_section]
one = 1
five = 5
animal = BIRD

[second_section]
path = &quot;/usr/local/bin&quot;
URL = &quot;http://www.example.com/~username&quot;

[third_section]
phpversion[] = &quot;5.0&quot;
phpversion[] = &quot;5.1&quot;
phpversion[] = &quot;5.2&quot;
phpversion[] = &quot;5.3&quot;
</pre></div>
    </div>

   </div>
   <div class="example" id="example-2211">
    <p><b>Example #2 <span class="function"><b>parse_ini_file()</b></span> example</b></p>
    <div class="example-contents"><p>
     <a href="language.constants.html" class="link">Constants</a> may also be parsed
     in the ini file so if you define a constant as an ini value before
     running <span class="function"><b>parse_ini_file()</b></span>, it will be integrated into
     the results.  Only ini values are evaluated.  For example:
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />define</span><span style="color: #007700">(</span><span style="color: #DD0000">'BIRD'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Dodo&nbsp;bird'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Parse&nbsp;without&nbsp;sections<br /></span><span style="color: #0000BB">$ini_array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_ini_file</span><span style="color: #007700">(</span><span style="color: #DD0000">"sample.ini"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini_array</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Parse&nbsp;with&nbsp;sections<br /></span><span style="color: #0000BB">$ini_array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_ini_file</span><span style="color: #007700">(</span><span style="color: #DD0000">"sample.ini"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini_array</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [one] =&gt; 1
    [five] =&gt; 5
    [animal] =&gt; Dodo bird
    [path] =&gt; /usr/local/bin
    [URL] =&gt; http://www.example.com/~username
    [phpversion] =&gt; Array
        (
            [0] =&gt; 5.0
            [1] =&gt; 5.1
            [2] =&gt; 5.2
            [3] =&gt; 5.3
        )

)
Array
(
    [first_section] =&gt; Array
        (
            [one] =&gt; 1
            [five] =&gt; 5
            [animal] =&gt; Dodo bird
        )

    [second_section] =&gt; Array
        (
            [path] =&gt; /usr/local/bin
            [URL] =&gt; http://www.example.com/~username
        )

    [third_section] =&gt; Array
        (
            [phpversion] =&gt; Array
                (
                    [0] =&gt; 5.0
                    [1] =&gt; 5.1
                    [2] =&gt; 5.2
                    [3] =&gt; 5.3
                )

        )

)
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2212">
    <p><b>Example #3 <span class="function"><b>parse_ini_file()</b></span> parsing a php.ini file</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;A&nbsp;simple&nbsp;function&nbsp;used&nbsp;for&nbsp;comparing&nbsp;the&nbsp;results&nbsp;below<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">yesno</span><span style="color: #007700">(</span><span style="color: #0000BB">$expression</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return(</span><span style="color: #0000BB">$expression&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #DD0000">'Yes'&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">'No'</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Get&nbsp;the&nbsp;path&nbsp;to&nbsp;php.ini&nbsp;using&nbsp;the&nbsp;php_ini_loaded_file()&nbsp;<br />//&nbsp;function&nbsp;available&nbsp;as&nbsp;of&nbsp;PHP&nbsp;5.2.4<br /></span><span style="color: #0000BB">$ini_path&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">php_ini_loaded_file</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;Parse&nbsp;php.ini<br /></span><span style="color: #0000BB">$ini&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_ini_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini_path</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Print&nbsp;and&nbsp;compare&nbsp;the&nbsp;values,&nbsp;note&nbsp;that&nbsp;using&nbsp;get_cfg_var()<br />//&nbsp;will&nbsp;give&nbsp;the&nbsp;same&nbsp;results&nbsp;for&nbsp;parsed&nbsp;and&nbsp;loaded&nbsp;here<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'(parsed)&nbsp;magic_quotes_gpc&nbsp;=&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">yesno</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini</span><span style="color: #007700">[</span><span style="color: #DD0000">'magic_quotes_gpc'</span><span style="color: #007700">])&nbsp;.&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #DD0000">'(loaded)&nbsp;magic_quotes_gpc&nbsp;=&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">yesno</span><span style="color: #007700">(</span><span style="color: #0000BB">get_cfg_var</span><span style="color: #007700">(</span><span style="color: #DD0000">'magic_quotes_gpc'</span><span style="color: #007700">))&nbsp;.&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
(parsed) magic_quotes_gpc = Yes
(loaded) magic_quotes_gpc = Yes
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.parse-ini-file-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    This function has nothing to do with the
    <var class="filename">php.ini</var> file. It is already processed by
    the time you run your script. This function can be used to
    read in your own application&#039;s configuration files.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    If a value in the ini file contains any non-alphanumeric
    characters it needs to be enclosed in double-quotes (&quot;).
   </p>
  </p></blockquote>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <span class="simpara">
    There are reserved words which must not be used as keys for
    ini files.  These include: null, yes, no, true, false, on, off, none.
    Values null, no and false results in &quot;&quot;, yes and true results in &quot;1&quot;.
    Characters <i>?{}|&amp;~![()^&quot;</i> must not be used anywhere in
    the key and have a special meaning in the value.
   </span>
  </p></blockquote>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.parse-ini-file-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.parse-ini-string.html" class="function" rel="rdfs-seeAlso">parse_ini_string()</a> - Parse a configuration string</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="106538""></a>
  <div class="note">
   <strong class="user">jwka at gmx dot net</strong>
   <a href="#106538" class="date">17-Nov-2011 02:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just to give novices a heads up since that can be really time consuming:<br />
<br />
BE AWARE of CONSTANTS you defined! <br />
<br />
ANY INI value NOT IN QUOTES that matches ANY constant will be replaced by the constant's value while any other unquoted value will be regarded as being a text "as is".<br />
<br />
If you want to AVOID REPLACEMENTS, be sure you stringently enclose your strings in quotes!<br />
<br />
Remark: <br />
The German examples are (have been?) wrong here. It shows(ed?) that [animal]=BIRD but it will be [animal]=Dodo bird.<br />
<br />
Example Extension:<br />
In the example, if the INI file's line would have been:<br />
<br />
animal = "BIRD" (notice the quotes)<br />
<br />
then [animal] would ALLWAYS equal "BIRD", no matter if a constant BIRD would be defined or not.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105426""></a>
  <div class="note">
   <strong class="user">jerikojerk</strong>
   <a href="#105426" class="date">16-Aug-2011 02:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that despite the changelog telling nothing about it, the parse_ini_file() changed <br />
-&gt; the way it interprets the simple quote (not accepted on my 5.1 php)<br />
-&gt; array index. PHP 5.3 accepts the following but not php 5.1<br />
<br />
[section]<br />
param["index"]='value'<br />
param["other index"]='other value'</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102266""></a>
  <div class="note">
   <strong class="user">Alex - webitoria.com</strong>
   <a href="#102266" class="date">04-Feb-2011 03:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Constants in ini files are not expanded if they are concatenated with strings quoted with single quotes, they must be in double quotes only to make constants expanded.<br />
<br />
Example:<br />
<br />
define ('APP_PATH', '/some/path');<br />
<br />
mypath = APP_PATH '/config'<br />
// Constant won't be expanded: [mypath] =&gt; APP_PATH '/config'<br />
<br />
mypath = APP_PATH "/config"<br />
// Constant will be expanded: [mypath] =&gt; /some/path/config<br />
<br />
Note "." between constant and following string is not used.<br />
<br />
Since Zend_Config_Ini is built on parse_ini_file, it inherits this behaviour.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100851""></a>
  <div class="note">
   <strong class="user">daevid at daevid dot com</strong>
   <a href="#100851" class="date">10-Nov-2010 07:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be warned that this function will not only NOT parse 'null', 'true', 'false', etc. but worse, it converts EVERYTHING to strings and sets 'true' values to "1" and null/'false' values to "".<br />
<br />
Here is my test.ini file:<br />
<br />
[examples]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a section<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a comment line<br />
log_level = E_ALL &amp; ~E_NOTICE <br />
1 = intkey&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a int key<br />
nullvalue = null&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is NULL<br />
truebool = true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is boolean (TRUE)<br />
falsebool = false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is boolean (FALSE)<br />
intvalue = -1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a integer (-1)<br />
floatvalue = +1.4E-3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a float (0.0014)<br />
stringvalue = Hello World&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a unquoted string<br />
quoted = "Hello World"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a quoted string<br />
apostrophed = 'Hello World'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a apostrophed string<br />
quoted escaped = "it work's \"fine\"!"&nbsp; &nbsp; &nbsp; ; this is a quoted string with escaped quotes<br />
apostrophed escaped = 'it work\'s "fine"!'&nbsp; ; this is a apostrophed string with escaped apostrophes<br />
<br />
Here is my test.php page:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; var_dump</span><span class="keyword">(</span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'./test.ini'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
Here is the output:<br />
<br />
array<br />
&nbsp; 'examples' =&gt; <br />
&nbsp;&nbsp;&nbsp; array<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'log_level' =&gt; string '6135' (length=4)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 1 =&gt; string 'intkey' (length=6)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'nullvalue' =&gt; string '' (length=0)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'truebool' =&gt; string '1' (length=1)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'falsebool' =&gt; string '' (length=0)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'intvalue' =&gt; string '-1' (length=2)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'floatvalue' =&gt; string '+1.4E-3' (length=7)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'stringvalue' =&gt; string 'Hello World' (length=11)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'quoted' =&gt; string 'Hello World' (length=11)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'apostrophed' =&gt; string ''Hello World'' (length=13)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'quoted escaped' =&gt; string 'it work's \fine\!' (length=17)<br />
&nbsp;&nbsp; &nbsp;&nbsp; 'apostrophed escaped' =&gt; string ''it work\'sfine' (length=15)<br />
<br />
verified with PHP 5.2.4 to 5.3.3</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100046""></a>
  <div class="note">
   <strong class="user">Rolf</strong>
   <a href="#100046" class="date">21-Sep-2010 02:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of PHP 5.3, you can escape a double quote like this:<br />
<br />
description = "an \" example"<br />
<br />
But strangely, this fails when you try to escape two consecutive double quotes:<br />
<br />
description = "no \"\" good"<br />
<br />
Unless there is something between them (in this example, there is a space character):<br />
<br />
description = "this is \" \" ok"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99943""></a>
  <div class="note">
   <strong class="user">uramihsayibok, gmail, com</strong>
   <a href="#99943" class="date">16-Sep-2010 01:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Undocumented feature!<br />
<br />
Using ${...} as a value will look to<br />
1) an INI setting, or<br />
2) an environment variable<br />
<br />
For example,<br />
<br />
<span class="default">&lt;?php<br />
<br />
print_r</span><span class="keyword">(</span><span class="default">parse_ini_string</span><span class="keyword">(</span><span class="string">'<br />
php_ext_dir = ${extension_dir}<br />
operating_system = ${OS}<br />
'</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [php_ext_dir] =&gt; ./ext/<br />
&nbsp;&nbsp;&nbsp; [operating_system] =&gt; Windows_NT<br />
)<br />
<br />
Present in PHP 5.3.2, likely in 5.x, maybe even earlier too.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99868""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#99868" class="date">11-Sep-2010 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a ini lexer with regexp:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">@</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: text/plain'</span><span class="keyword">);<br />
<br />
</span><span class="default">$myini </span><span class="keyword">= &lt;&lt;&lt;EOT<br />
</span><span class="string">[examples]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a section<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a comment line<br />
1 = intkey&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a int key<br />
nullvalue = null&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is NULL<br />
truebool = true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is boolean (TRUE)<br />
falsebool = false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is boolean (FALSE)<br />
intvalue = -1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a integer (-1)<br />
floatvalue = +1.4E-3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a float (0.0014)<br />
stringvalue = Hello World&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a unquoted string<br />
quoted = "Hello World"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a quoted string<br />
apostrophed = 'Hello World'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a apostrophed string<br />
quoted escaped = "it work's \"fine\"!"&nbsp; &nbsp; &nbsp; ; this is a quoted string with escaped quotes<br />
apostrophed escaped = 'it work\'s "fine"!'&nbsp; ; this is a apostrophed string with escaped apostrophes<br />
<br />
&nbsp;&nbsp;&nbsp; [[valid special cases]]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this is a section with square brackets and whitespaces at the beginning<br />
quoted multiline = "line1<br />
line2<br />
line3"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a quoted multiline string<br />
apostrophed multiline = "line1<br />
line2<br />
line3"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this is a apostrophed multiline string<br />
&nbsp;&nbsp; &nbsp; spaces before key = is ok&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this line has whitespaces at the beginning<br />
no val =&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this setting has no key<br />
= no key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this setting has no value<br />
=&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this setting has no key and no value<br />
<br />
[bad cases]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; you should never do that but it works<br />
notgood = unquoted"string&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this value has a single quote<br />
notgood2 = unapostrophed'string&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; this value has a single apostrophe<br />
bad = "unclosed quotes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this value has unclosed quotes<br />
bad2 = 'unclosed apostrophes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; this value has unclosed apostrophes<br />
<br />
[invalid<br />
section]<br />
invalid setting<br />
</span><span class="keyword">EOT;<br />
<br />
function </span><span class="default">get_tokens_from_ini_lexer</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$verbose </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexp </span><span class="keyword">= </span><span class="string">'/<br />
&nbsp;&nbsp;&nbsp; (?&lt;=^|\r\n|\r|\n)<br />
&nbsp;&nbsp;&nbsp; (?P&lt;line&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (?:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?(?![\t\x20]*;)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;left_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \[(?P&lt;section&gt;[^;\r\n]+)\]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;setting&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;key&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [^=;\r\n]+?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;left_equal_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;equal_sign&gt;=)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;right_equal_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;val&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \x22(?P&lt;quoted&gt;.*?)(?&lt;!\x5C)\x22<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \x27(?P&lt;apostrophed&gt;.*?)(?&lt;!\x5C)\x27<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;null&gt;null)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;bool&gt;true|false)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;int&gt;[+-]?(?:[1-9]\d{0,18}|0))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;float&gt;(?:[+-]?(?:[1-9]\d*|0))\.\d+(?:E[+-]\d+)?)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;string&gt;[^;\r\n]+?)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;right_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;comment_seperator&gt;;)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;comment_space&gt;[\t\x20]*)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;comment&gt;[^\r\n]+?)?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )?<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; |<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (?P&lt;error&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [^\r\n]+?<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; (?=\r\n|\r|\n|$)(?P&lt;crlf&gt;\r\n|\r|\n)?<br />
&nbsp;&nbsp;&nbsp; |<br />
&nbsp;&nbsp;&nbsp; (?&lt;=\r\n|\r|\n)(?P&lt;emptyline&gt;\r\n|\r|\n)<br />
&nbsp;&nbsp;&nbsp; /xsi'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if(!@</span><span class="default">is_int</span><span class="keyword">(</span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="default">$regexp</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">$tokens</span><span class="keyword">, </span><span class="default">PREG_SET_ORDER</span><span class="keyword">)))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// parse error<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$tokens </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$token</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$verbose</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'line'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'crlf'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'setting'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'equal_sign'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'val'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'left_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'left_equal_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'right_equal_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'right_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'comment_seperator'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'comment_space'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$token </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!@</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) || !@</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; };<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="default">$tokens</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; };<br />
};<br />
<br />
</span><span class="default">$verbose </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">get_tokens_from_ini_lexer</span><span class="keyword">(</span><span class="default">$myini</span><span class="keyword">, </span><span class="default">$verbose</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99474""></a>
  <div class="note">
   <strong class="user">pd at frozen-bits dot de</strong>
   <a href="#99474" class="date">19-Aug-2010 02:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use the following syntax to secure my config.ini.php file:<br />
<br />
;<span class="default">&lt;?php<br />
</span><span class="keyword">;die(); </span><span class="comment">// For further security<br />
</span><span class="keyword">;</span><span class="comment">/*<br />
<br />
[category]<br />
name="value"<br />
<br />
;*/<br />
<br />
</span><span class="keyword">;</span><span class="default">?&gt;<br />
</span><br />
Works like a charm and is both: A valid PHP File and a valid ini-File ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99036""></a>
  <div class="note">
   <strong class="user">geggert at web dot de</strong>
   <a href="#99036" class="date">23-Jul-2010 06:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As quick an dirty way to gain the security of that *.ini.php-files you may alternatively use this as first line:<br />
<br />
; <span class="default">&lt;?php </span><span class="keyword">exit(); __halt_compiler();<br />
</span><span class="comment">// the closing tag is just to end up the syntax highlighting ...<br />
// leave these comments and the closing tag away in your ini.php-file!<br />
</span><span class="default">?&gt;<br />
</span><br />
You can use parse_ini_file() in the normal way and any criminal stranger will only see a ";" then ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98438""></a>
  <div class="note">
   <strong class="user">forcestudios.square7.de</strong>
   <a href="#98438" class="date">15-Jun-2010 12:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Tip: you cannot parse an ini-file with this safer structure:<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">exit();<br />
</span><span class="default">$data</span><span class="keyword">=</span><span class="string">"<br />
<br />
[section_one]<br />
test = abc<br />
<br />
[section_two]<br />
and_so=on<br />
<br />
"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
(strangers are not able to see this file because php closed the file previously by executing exit();)<br />
<br />
But here is a very simple code to prevent this:<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">class </span><span class="default">iniParser</span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; private </span><span class="default">$IniFile</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; private </span><span class="default">$SafeFile</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; private </span><span class="default">$ParseClasses</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public </span><span class="default">$KeysWithoutSections</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public </span><span class="default">$KeysWithSections</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$FileName</span><span class="keyword">, </span><span class="default">$SafeFile </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">IniFile </span><span class="keyword">= </span><span class="default">$FileName</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">SafeFile </span><span class="keyword">= </span><span class="default">$SafeFile</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">parseIni</span><span class="keyword">(</span><span class="default">$SaveInClass </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$FileHandle </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">IniFile</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CountLines </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$FileHandle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NKeys </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">SafeFile </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CountLines </span><span class="keyword">-= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ( </span><span class="default">$Counter </span><span class="keyword">&lt; </span><span class="default">$CountLines </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurLine </span><span class="keyword">= </span><span class="default">$FileHandle</span><span class="keyword">[</span><span class="default">$Counter</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurLineSplit </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$CurLine</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurKey </span><span class="keyword">= </span><span class="default">$CurLineSplit</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurValue </span><span class="keyword">= </span><span class="default">$CurLineSplit</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$SaveInClass </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Keys</span><span class="keyword">[</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$CurKey</span><span class="keyword">)] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$CurValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NKeys</span><span class="keyword">[</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$CurKey</span><span class="keyword">)] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$CurValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$SaveInClass </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">KeysWithoutSections</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$NKeys</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">parseIniWithSections</span><span class="keyword">(</span><span class="default">$SaveInClass </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$FileHandle </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">IniFile</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CountLines </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$FileHandle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$LastSection </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NKeys </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">SafeFile </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CountLines </span><span class="keyword">-= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Counter </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ( </span><span class="default">$Counter </span><span class="keyword">&lt; </span><span class="default">$CountLines </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurLine </span><span class="keyword">= </span><span class="default">$FileHandle</span><span class="keyword">[</span><span class="default">$Counter</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$CurLine</span><span class="keyword">, </span><span class="string">"["</span><span class="keyword">) == </span><span class="default">1 </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$LastSection </span><span class="keyword">= </span><span class="default">$CurLine</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Explosion </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$CurLine</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurKey </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$Explosion</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CurValue </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$Explosion</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$SaveInClass </span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">KeysWithSections</span><span class="keyword">[</span><span class="default">$LastSection</span><span class="keyword">][</span><span class="default">$CurKey</span><span class="keyword">] = </span><span class="default">$CurValue</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NKeys</span><span class="keyword">[</span><span class="default">$LastSection</span><span class="keyword">][</span><span class="default">$CurKey</span><span class="keyword">] = </span><span class="default">$CurValue</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$SaveInClass </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">KeysWithSections</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$NKeys</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; };<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
To use this class just try this script here:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">include </span><span class="string">"iniparser.php" </span><span class="comment">// class above<br />
<br />
</span><span class="default">$SafeIniParser </span><span class="keyword">= new </span><span class="default">iniParser</span><span class="keyword">(</span><span class="string">"test.php"</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">); </span><span class="comment">// file: test.php, safefile.<br />
<br />
</span><span class="default">$Keys </span><span class="keyword">= </span><span class="default">$SafeIniParser</span><span class="keyword">-&gt;</span><span class="default">parseIniWithSections</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$Keys</span><span class="keyword">[</span><span class="string">"section_one"</span><span class="keyword">][</span><span class="string">"test"</span><span class="keyword">];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
i used this file:<br />
<span class="default">&lt;?php </span><span class="keyword">exit();<br />
</span><span class="default">$data</span><span class="keyword">=</span><span class="string">"<br />
<br />
[section_one]<br />
test = abc<br />
<br />
[section_two]<br />
and_so=on<br />
<br />
"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95747""></a>
  <div class="note">
   <strong class="user">Mauro Gabriel Titimoli</strong>
   <a href="#95747" class="date">19-Jan-2010 03:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have recently finished an implementacion of a multiple configuration type class.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Configuration </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">AUTO </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">JSON </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">PHP_INI </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">XML </span><span class="keyword">= </span><span class="default">16</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; static private </span><span class="default">$CONF_EXT_RELATION </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'json' </span><span class="keyword">=&gt; </span><span class="default">2</span><span class="keyword">, </span><span class="comment">// JSON<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'ini' </span><span class="keyword">=&gt; </span><span class="default">4</span><span class="keyword">,&nbsp; </span><span class="comment">// PHP_INI<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'xml' </span><span class="keyword">=&gt; </span><span class="default">16&nbsp; </span><span class="comment">// XML<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; static private </span><span class="default">$instances</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$data</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; static public function </span><span class="default">objectToArray</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr </span><span class="keyword">= (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">))?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">) :<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = ((</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) || (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)))?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">objectToArray</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) :<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$arr</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$type </span><span class="keyword">= </span><span class="default">Configuration</span><span class="keyword">::</span><span class="default">AUTO</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$type </span><span class="keyword">== </span><span class="default">self</span><span class="keyword">::</span><span class="default">AUTO</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">$CONF_EXT_RELATION</span><span class="keyword">[</span><span class="default">pathinfo</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">PATHINFO_EXTENSION</span><span class="keyword">)];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch(</span><span class="default">$type</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">self</span><span class="keyword">::</span><span class="default">JSON</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">), </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">self</span><span class="keyword">::</span><span class="default">PHP_INI</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">self</span><span class="keyword">::</span><span class="default">XML</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">objectToArray</span><span class="keyword">(</span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; static public function &amp; </span><span class="default">getInstance</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$type </span><span class="keyword">= </span><span class="default">Configuration</span><span class="keyword">::</span><span class="default">AUTO</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(! isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$file</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$file</span><span class="keyword">] = new </span><span class="default">Configuration</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$file</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__get</span><span class="keyword">(</span><span class="default">$section</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">)) &amp;&amp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$section</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$section</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getAvailableSections</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$configuration </span><span class="keyword">= </span><span class="default">Configuration</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">(</span><span class="comment">/*configuration filename*/</span><span class="keyword">);<br />
foreach(</span><span class="default">$configuration</span><span class="keyword">-&gt;</span><span class="default">getAvailableSections</span><span class="keyword">() as </span><span class="default">$pos </span><span class="keyword">=&gt; </span><span class="default">$sectionName</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$sectionName</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$configuration</span><span class="keyword">-&gt;{</span><span class="default">$sectionName</span><span class="keyword">});<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94414""></a>
  <div class="note">
   <strong class="user">freamer89 at gmail dot com</strong>
   <a href="#94414" class="date">03-Nov-2009 08:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Didn`t find the one,which suits my needs,so Here`s a small and easy write ini from array function... Maybe you`ll find it handy.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">write_php_ini</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res</span><span class="keyword">[] = </span><span class="string">"[</span><span class="default">$key</span><span class="string">]"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$val </span><span class="keyword">as </span><span class="default">$skey </span><span class="keyword">=&gt; </span><span class="default">$sval</span><span class="keyword">) </span><span class="default">$res</span><span class="keyword">[] = </span><span class="string">"</span><span class="default">$skey</span><span class="string"> = "</span><span class="keyword">.(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$sval</span><span class="keyword">) ? </span><span class="default">$sval </span><span class="keyword">: </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">$sval</span><span class="keyword">.</span><span class="string">'"'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$res</span><span class="keyword">[] = </span><span class="string">"</span><span class="default">$key</span><span class="string"> = "</span><span class="keyword">.(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) ? </span><span class="default">$val </span><span class="keyword">: </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">.</span><span class="string">'"'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">safefilerewrite</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">implode</span><span class="keyword">(</span><span class="string">"\r\n"</span><span class="keyword">, </span><span class="default">$res</span><span class="keyword">));<br />
}<br />
</span><span class="comment">//////<br />
</span><span class="keyword">function </span><span class="default">safefilerewrite</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="default">$dataToSave</span><span class="keyword">)<br />
{&nbsp; &nbsp; if (</span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startTime </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; do<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$canWrite </span><span class="keyword">= </span><span class="default">flock</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">LOCK_EX</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// If lock not obtained sleep for 0 - 100 milliseconds, to avoid collision and CPU load<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if(!</span><span class="default">$canWrite</span><span class="keyword">) </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">round</span><span class="keyword">(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">)*</span><span class="default">1000</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } while ((!</span><span class="default">$canWrite</span><span class="keyword">)and((</span><span class="default">microtime</span><span class="keyword">()-</span><span class="default">$startTime</span><span class="keyword">) &lt; </span><span class="default">1000</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//file was locked so now we can store information<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$canWrite</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$dataToSave</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">flock</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">LOCK_UN</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93807""></a>
  <div class="note">
   <strong class="user">prometheus</strong>
   <a href="#93807" class="date">30-Sep-2009 09:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made a small test to check differencies between parse_ini_file and json_decode and I surprised a little bit.<br />
<br />
Here are my test files...<br />
parseini-test.ini:<br />
[global]<br />
a = 1<br />
b = 2<br />
c = "Lorem Ipsum"<br />
d = "Dolor Sit Amet"<br />
e = 3.14<br />
<br />
jsondecode-test.json:<br />
{<br />
&nbsp;&nbsp;&nbsp; "a": 1,<br />
&nbsp;&nbsp;&nbsp; "b": 2,<br />
&nbsp;&nbsp;&nbsp; "c": "Lorem Ipsum",<br />
&nbsp;&nbsp;&nbsp; "d": "Dolor Sit Amet",<br />
&nbsp;&nbsp;&nbsp; "e": 3.14<br />
}<br />
<br />
And source codes are...<br />
parseini.php:<br />
<span class="default">&lt;?php<br />
<br />
$s </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">100000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
{<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'./parseini-test.ini'</span><span class="keyword">);<br />
unset(</span><span class="default">$a</span><span class="keyword">);<br />
}<br />
</span><span class="default">$e </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
echo </span><span class="default">$e</span><span class="keyword">-</span><span class="default">$s</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
jsondecode.php:<br />
<span class="default">&lt;?php<br />
<br />
$s </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">100000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
{<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'./jsondecode-test.json'</span><span class="keyword">), </span><span class="default">TRUE</span><span class="keyword">);<br />
unset(</span><span class="default">$a</span><span class="keyword">);<br />
}<br />
</span><span class="default">$e </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
echo </span><span class="default">$e</span><span class="keyword">-</span><span class="default">$s</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
These tests ran for three times (the third result is near to average in my experiences):<br />
- parseini.php: 3.24759721756<br />
- jsondecode.php: 3.289290905<br />
<br />
My conclusion:<br />
I`m going to use the json_decode() for reading config files because no significant difference in running time between parse_ini_file() and json_decode() + file_get_contents() but JSON is a more powerful format for storing well typed (parse_ini_file parses 3.14 as string, json_decode as float) and well structured configuration settings. As a note: json_decode is sensitive for associative keys` quotation, use quotes at all time in keys` names.<br />
<br />
Test ran on PHP 5.2.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93148""></a>
  <div class="note">
   <strong class="user">flacroix897 at hotmail dot com</strong>
   <a href="#93148" class="date">25-Aug-2009 10:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Make sure you use double-quotes when using spaces in a value as of 5.3.<br />
<br />
Consider the following INI file:<br />
<br />
&nbsp;&nbsp; key = tested on php5<br />
<br />
with the following code:<br />
<br />
&nbsp;&nbsp; $res = parse_ini_file('myini.ini');<br />
&nbsp;&nbsp; var_dump($res);<br />
<br />
In 5.2, this will give you:<br />
<br />
&nbsp;&nbsp; array(1) {<br />
&nbsp;&nbsp; &nbsp; ["key"]=&gt;<br />
&nbsp;&nbsp; &nbsp; string(14) "tested on php5"<br />
&nbsp;&nbsp; }<br />
<br />
In 5.3, this will give you:<br />
<br />
&nbsp;&nbsp; Warning: syntax error, unexpected BOOL_TRUE in Unknown on line 1 in test.php on line 3<br />
&nbsp;&nbsp; bool(false)<br />
<br />
This is because the 'on' word is a reserved keyword for boolean TRUE. The documentation now states that a string that contains any non-alphanumeric character should be enclosed in double-quotes (a space is not alphanumeric).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92085""></a>
  <div class="note">
   <strong class="user">rmcleod79 [at] talktalk ~dot~ net</strong>
   <a href="#92085" class="date">08-Jul-2009 01:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a simple settings class that parses an ini file for settings. It has a private constructor so that it can only be instantiated through the getInstance method, this means that there can only ever be one settings object at a time.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">Settings </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private static </span><span class="default">$instance</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$settings</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$ini_file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">settings </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$ini_file</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">getInstance</span><span class="keyword">(</span><span class="default">$ini_file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(! isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance </span><span class="keyword">= new </span><span class="default">Settings</span><span class="keyword">(</span><span class="default">$ini_file</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__get</span><span class="keyword">(</span><span class="default">$setting</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$setting</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">settings</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">settings</span><span class="keyword">[</span><span class="default">$setting</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">settings </span><span class="keyword">as </span><span class="default">$section</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$setting</span><span class="keyword">, </span><span class="default">$section</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$section</span><span class="keyword">[</span><span class="default">$setting</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
settings.ini<br />
<br />
[General]<br />
<br />
url = "<a href="http://www.example.com" rel="nofollow" target="_blank">http://www.example.com</a>"<br />
<br />
[Database]<br />
<br />
host = localhost<br />
username = user<br />
password = password<br />
db = cms<br />
adapter = mysqli<br />
<br />
Using the class<br />
<br />
<span class="default">&lt;?php<br />
<br />
$settings </span><span class="keyword">= </span><span class="default">Settings</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">(</span><span class="comment">/*path to settings.ini*/</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$settings</span><span class="keyword">-&gt;</span><span class="default">url</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$settings</span><span class="keyword">-&gt;</span><span class="default">Database</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$settings</span><span class="keyword">-&gt;</span><span class="default">db</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Output would be:<br />
<br />
<a href="http://www.example.com" rel="nofollow" target="_blank">http://www.example.com</a><br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [host] =&gt; localhost<br />
&nbsp;&nbsp;&nbsp; [username] =&gt; user<br />
&nbsp;&nbsp;&nbsp; [password] =&gt; password<br />
&nbsp;&nbsp;&nbsp; [db] =&gt; cms<br />
&nbsp;&nbsp;&nbsp; [adapter] =&gt; mysqli<br />
)<br />
<br />
cms</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91629""></a>
  <div class="note">
   <strong class="user">joe at u13 dot net</strong>
   <a href="#91629" class="date">20-Jun-2009 12:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm not sure why, but for some reason php's ini functions always leave out entries for me. <br />
<br />
To solve this problem, I wrote my own ini parsing function, intended to be a replacement for parse_ini_file('file.ini', true);<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">new_parse_ini</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// if cannot open file, return false<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ini </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// to hold the categories, and within them the entries<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cats </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$ini </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (@</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\[(.+)\]/'</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } elseif (@</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/(.+)=(.+)/'</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cats</span><span class="keyword">[</span><span class="default">$last</span><span class="keyword">][</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]] = </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$cats</span><span class="keyword">;<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The usage follows the Example #2 on <a href="http://us3.php.net/manual/en/function.parse-ini-file.php , except without the second parameter being " rel="nofollow" target="_blank">http://us3.php.net/manual/en/function.parse-ini-file.php , except without the second parameter being </a>'true'.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90624""></a>
  <div class="note">
   <strong class="user">jeremygiberson at gmail dot com</strong>
   <a href="#90624" class="date">30-Apr-2009 04:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a quick parse_ini_file wrapper to add extend support to save typing and redundancy.<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Parses INI file adding extends functionality via ":base" postfix on namespace.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param string $filename<br />
&nbsp;&nbsp; &nbsp; * @return array<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">parse_ini_file_extended</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p_ini </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$config </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$p_ini </span><span class="keyword">as </span><span class="default">$namespace </span><span class="keyword">=&gt; </span><span class="default">$properties</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$extends</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">, </span><span class="default">$namespace</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$extends </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$extends</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// create namespace if necessary<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(!isset(</span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">])) </span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// inherit base namespace<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(isset(</span><span class="default">$p_ini</span><span class="keyword">[</span><span class="default">$extends</span><span class="keyword">])){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$p_ini</span><span class="keyword">[</span><span class="default">$extends</span><span class="keyword">] as </span><span class="default">$prop </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">][</span><span class="default">$prop</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// overwrite / set current namespace values<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$properties </span><span class="keyword">as </span><span class="default">$prop </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">][</span><span class="default">$prop</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$config</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Treats this ini:<br />
<span class="default">&lt;?php <br />
</span><span class="comment">/*<br />
[base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=default<br />
<br />
[users:base]<br />
database=users<br />
<br />
[archive : base]<br />
database=archive<br />
*/<br />
</span><span class="default">?&gt;<br />
</span>As if it were like this:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
[base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=default<br />
<br />
[users:base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=users<br />
<br />
[archive : base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=archive<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89867""></a>
  <div class="note">
   <strong class="user">prikkeldraad at gmail dot com</strong>
   <a href="#89867" class="date">26-Mar-2009 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When PHP dies without any warning or message when parsing the ini-file, check the values of the file. All non alphanumeric values need to be quoted.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87605""></a>
  <div class="note">
   <strong class="user">pBakhuis at googles mail dot com (gmail)</strong>
   <a href="#87605" class="date">12-Dec-2008 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To those who were like me looking if this could be used to create an array out of commandline output I offer you the function below (I used it to parse mplayer output).<br />
<br />
If you want it behave exactly the same as parse_ini_file you'll obviously have to add some code to feed the different sections to this one. Hope it's of help to someone!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* The return is very similar to that of parse_ini_file, but this works off files<br />
&nbsp;* <br />
&nbsp;* Below is an example of what it does, where the first<br />
&nbsp;* value is what you'd normally want to do, and the second and third things that might<br />
&nbsp;* happen and in case it does it's good to know what is going on.<br />
&nbsp;* <br />
&nbsp;* $anArray = array( 'default=theValue', 'setting=', 'something=value=value' );<br />
&nbsp;* explodeExplode( '=', $anArray );<br />
&nbsp;* <br />
&nbsp;* the return will be <br />
&nbsp;* array( 'default' =&gt; 'theValue', 'setting' =&gt; '', 'something' =&gt; 'value=value' );<br />
&nbsp;* <br />
&nbsp;* So the oddities here are, text after the second $string occurence dissapearing<br />
&nbsp;* and empty values resulting in an empty string.<br />
&nbsp;* <br />
&nbsp;* @return $returnArray array array( 'setting' =&gt; 'value' )<br />
&nbsp;* @param $string Object<br />
&nbsp;* @param $array Object<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">explodeExplode</span><span class="keyword">( </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$array </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$returnArray </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$arrayValue </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmpArray </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$arrayValue </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$tmpArray </span><span class="keyword">) == </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$tmpArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$tmpArray </span><span class="keyword">) == </span><span class="default">2 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$tmpArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="default">$tmpArray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$tmpArray </span><span class="keyword">) &gt; </span><span class="default">2 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$implodeBack </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$firstLoop&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$tmpArray </span><span class="keyword">as </span><span class="default">$tmpValue </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$firstLoop </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$firstLoop </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$implodeBack</span><span class="keyword">[] = </span><span class="default">$tmpValue</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$implodeBack </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$tmpArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="default">implode</span><span class="keyword">( </span><span class="string">'='</span><span class="keyword">, </span><span class="default">$implodeBack </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$returnArray</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86410""></a>
  <div class="note">
   <strong class="user">Bill Brown - macnimble.com</strong>
   <a href="#86410" class="date">16-Oct-2008 07:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Working on a project for a client recently, I needed a way to set a default configuration INI file, but also wanted to allow the client to override the settings through the use of a custom INI file.<br />
<br />
I thought array_merge or array_merge_recursive would do the trick for me, but it fails to override settings in the way that I wanted. I wrote my own function to do what I wanted. It's nothing spectacular, but thought I'd post it here in case it saved someone else some time.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">ini_merge </span><span class="keyword">(</span><span class="default">$config_ini</span><span class="keyword">, </span><span class="default">$custom_ini</span><span class="keyword">) {<br />
&nbsp; foreach (</span><span class="default">$custom_ini </span><span class="keyword">AS </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">):<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">)):<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$config_ini</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">ini_merge</span><span class="keyword">(</span><span class="default">$config_ini</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">], </span><span class="default">$custom_ini</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; else:<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$config_ini</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; endif;<br />
&nbsp; endforeach;<br />
&nbsp; return </span><span class="default">$config_ini</span><span class="keyword">;<br />
};<br />
</span><span class="default">$CONFIG_INI </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'../config.ini'</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">$CUSTOM_INI </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'ini/custom.ini'</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">$INI </span><span class="keyword">= </span><span class="default">ini_merge</span><span class="keyword">(</span><span class="default">$CONFIG_INI</span><span class="keyword">, </span><span class="default">$CUSTOM_INI</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This allowed me to put the default INI file above the web root with information that requires extra security (database connection info, etc.) and a writable INI file within the structure of the site without affecting the default settings of the default config.ini file.<br />
<br />
Anyway, hope it helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84886""></a>
  <div class="note">
   <strong class="user">david dot dyess at gmail dot com</strong>
   <a href="#84886" class="date">04-Aug-2008 12:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is another way to group values in the ini:<br />
<br />
my.ini:<br />
<br />
[singles]<br />
test = a test<br />
test2 = another test<br />
test3 = this is a test too<br />
<br />
[multiples]<br />
tests[] = a test<br />
tests[] = another test<br />
tests[] = this is a test too<br />
<br />
my.php:<br />
<br />
<span class="default">&lt;?php $init </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'my.ini'</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
The same as:<br />
<br />
<span class="default">&lt;?php<br />
$init</span><span class="keyword">[</span><span class="string">'test'</span><span class="keyword">] = </span><span class="string">'a test'</span><span class="keyword">;<br />
</span><span class="default">$init</span><span class="keyword">[</span><span class="string">'test2'</span><span class="keyword">] = </span><span class="string">'another test'</span><span class="keyword">;<br />
</span><span class="default">$init</span><span class="keyword">[</span><span class="string">'test3'</span><span class="keyword">] = </span><span class="string">'this is a test too'</span><span class="keyword">;<br />
</span><span class="default">$init</span><span class="keyword">[</span><span class="string">'tests'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="string">'a test'</span><span class="keyword">;<br />
</span><span class="default">$init</span><span class="keyword">[</span><span class="string">'tests'</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">] = </span><span class="string">'another test'</span><span class="keyword">;<br />
</span><span class="default">$init</span><span class="keyword">[</span><span class="string">'tests'</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">] = </span><span class="string">'this is a test too'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
This works with the bool set to true also, can be useful with loops. Works with the bool set to true as well.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84348""></a>
  <div class="note">
   <strong class="user">juampii_4 at hotmail dot com</strong>
   <a href="#84348" class="date">09-Jul-2008 08:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
class.parseini.php<br />
<span class="default">&lt;?php<br />
</span><span class="comment">##By juan pablo tosso<br />
</span><span class="keyword">class </span><span class="default">Parser<br />
</span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">printini</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$sector</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file</span><span class="keyword">=</span><span class="default">$file</span><span class="keyword">.</span><span class="string">".ini"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$is</span><span class="keyword">=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$is</span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$is</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$is</span><span class="keyword">) &amp;&amp; </span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$is</span><span class="keyword">[</span><span class="default">$sector</span><span class="keyword">][</span><span class="default">$var</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">"error"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Ini.ini:<br />
[test]<br />
foo=bar<br />
<br />
[test2]<br />
foo1=bar1<br />
foo2=bar2<br />
foo bar=something else<br />
<br />
just in another file write:<br />
<br />
include("class.parseini.php");<br />
$new= new Parser();<br />
echo $new-&gt;printini("ini", "test2", "foo1");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78815""></a>
  <div class="note">
   <strong class="user">goulven.ch AT gmail DOT com</strong>
   <a href="#78815" class="date">29-Oct-2007 06:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning: parse_ini_files cannot cope with values containing the equal sign (=).<br />
<br />
The following function supports sections, comments, arrays, and key-value pairs outside of any section.<br />
Beware that similar keys will overwrite one another (unless in different sections).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parse_ini </span><span class="keyword">( </span><span class="default">$filepath </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ini </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">( </span><span class="default">$filepath </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$ini </span><span class="keyword">) == </span><span class="default">0 </span><span class="keyword">) { return array(); }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sections </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$globals </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$ini </span><span class="keyword">as </span><span class="default">$line </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">( </span><span class="default">$line </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Comments<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">$line </span><span class="keyword">== </span><span class="string">'' </span><span class="keyword">|| </span><span class="default">$line</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">';' </span><span class="keyword">) { continue; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Sections<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">$line</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">'[' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sections</span><span class="keyword">[] = </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Key-value pair<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">list( </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value </span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">( </span><span class="string">'='</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">( </span><span class="default">$key </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$i </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Array values<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) == </span><span class="string">'[]' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$globals</span><span class="keyword">[ </span><span class="default">$key </span><span class="keyword">][] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$globals</span><span class="keyword">[ </span><span class="default">$key </span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Array values<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) == </span><span class="string">'[]' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">- </span><span class="default">1 </span><span class="keyword">][ </span><span class="default">$key </span><span class="keyword">][] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">- </span><span class="default">1 </span><span class="keyword">][ </span><span class="default">$key </span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for( </span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$i</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++ ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[ </span><span class="default">$sections</span><span class="keyword">[ </span><span class="default">$j </span><span class="keyword">] ] = </span><span class="default">$values</span><span class="keyword">[ </span><span class="default">$j </span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result </span><span class="keyword">+ </span><span class="default">$globals</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Example usage:<br />
<span class="default">&lt;?php<br />
$stores </span><span class="keyword">= </span><span class="default">parse_ini</span><span class="keyword">(</span><span class="string">'stores.ini'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$stores </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
An example ini file:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
;Commented line start with ';'<br />
global_value1 = a string value<br />
global_value1 = another string value<br />
<br />
; empty lines are discarded<br />
[Section1]<br />
key = value<br />
; whitespace around keys and values is discarded too<br />
otherkey=other value<br />
otherkey=yet another value<br />
; this key-value pair will overwrite the former.<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78723""></a>
  <div class="note">
   <strong class="user">www.onphp5.com</strong>
   <a href="#78723" class="date">24-Oct-2007 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Looks like in PHP 5.3.0 special characters like \n are extrapolated into real newlines. Gotta use \\n.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78221""></a>
  <div class="note">
   <strong class="user">arnapou</strong>
   <a href="#78221" class="date">03-Oct-2007 06:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I didn't find a simple ini class so I wrote that class to read and write ini files.<br />
I hope it could help you.<br />
<br />
Read file : $ini = INI::read('myfile.ini');<br />
Write file : INI::write('myfile.ini', $ini);<br />
<br />
Features : <br />
- support [] syntax for arrays<br />
- support . in keys like bar.foo.something = value<br />
- true and false string are automatically converted in booleans<br />
- integers strings are automatically converted in integers<br />
- keys are sorted when writing<br />
- constants are replaced but they should be written in the ini file between braces : {MYCONSTANT}<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">INI </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; WRITE<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">write</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$ini</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">) as </span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="string">'['</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">"]\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="default">INI</span><span class="keyword">::</span><span class="default">write_get_string</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="string">''</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; write get string<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">write_get_string</span><span class="keyword">(&amp; </span><span class="default">$ini</span><span class="keyword">, </span><span class="default">$prefix</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ksort</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$ini </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="default">INI</span><span class="keyword">::</span><span class="default">write_get_string</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="default">$prefix</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="default">$prefix</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">' = '</span><span class="keyword">.</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="string">"\\\n"</span><span class="keyword">, </span><span class="default">INI</span><span class="keyword">::</span><span class="default">set_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)).</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; manage keys<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">set_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$val </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) { return </span><span class="string">'true'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$val </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) { return </span><span class="string">'false'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; READ<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">read</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ini </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">= </span><span class="string">'default'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$lines </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) !== </span><span class="string">';'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\r"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^\[(.*)\]/'</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">= </span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">$multi </span><span class="keyword">=== </span><span class="string">'' </span><span class="keyword">&amp;&amp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^([a-z0-9_.\[\]-]+)\s*=\s*(.*)$/i'</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">$m</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">) !== </span><span class="string">"\\"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">INI</span><span class="keyword">::</span><span class="default">manage_keys</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$section</span><span class="keyword">], </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">$multi </span><span class="keyword">!== </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">) === </span><span class="string">"\\"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">INI</span><span class="keyword">::</span><span class="default">manage_keys</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$section</span><span class="keyword">], </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$multi</span><span class="keyword">.</span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$multi </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$buf </span><span class="keyword">= </span><span class="default">get_defined_constants</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$consts </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$buf</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">] as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$consts</span><span class="keyword">[</span><span class="string">'{'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'}'</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">, array(</span><span class="string">'INI'</span><span class="keyword">, </span><span class="string">'replace_consts'</span><span class="keyword">), </span><span class="default">$consts</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$ini</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; manage keys<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">get_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^-?[0-9]$/i'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">)) { return </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">); } <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) === </span><span class="string">'true'</span><span class="keyword">) { return </span><span class="default">true</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) === </span><span class="string">'false'</span><span class="keyword">) { return </span><span class="default">false</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^"(.*)"$/i'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) { return </span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^\'(.*)\'$/i'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) { return </span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; manage keys<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">get_key</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^[0-9]$/i'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">)) { return </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">); }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; manage keys<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">manage_keys</span><span class="keyword">(&amp; </span><span class="default">$ini</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^([a-z0-9_-]+)\.(.*)$/i'</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">INI</span><span class="keyword">::</span><span class="default">manage_keys</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]], </span><span class="default">$m</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^([a-z0-9_-]+)\[(.*)\]$/i'</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$m</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] !== </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]][</span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_key</span><span class="keyword">(</span><span class="default">$m</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">])] = </span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ini</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]][] = </span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ini</span><span class="keyword">[</span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_key</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)] = </span><span class="default">INI</span><span class="keyword">::</span><span class="default">get_value</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; *&nbsp; replace utility<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static function </span><span class="default">replace_consts</span><span class="keyword">(&amp; </span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78060""></a>
  <div class="note">
   <strong class="user">thuylnt</strong>
   <a href="#78060" class="date">26-Sep-2007 02:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I need to read a ini file, modify some values in some sections, and save it. But the important thing is, i want to keep all the comments, the new lines in the right order. So i modified function parse_ini_file_quotes_safe and write_ini_file.<br />
I think they work fine.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">read_ini_file</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, &amp;</span><span class="default">$r</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$null </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">=</span><span class="default">$null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$first_char </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sec</span><span class="keyword">=</span><span class="default">$null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$comment_chars</span><span class="keyword">=</span><span class="string">";#"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num_comments </span><span class="keyword">= </span><span class="string">"0"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num_newline </span><span class="keyword">= </span><span class="string">"0"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Read to end of file with the newlines still attached into $f<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= @</span><span class="default">file</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$f </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return -</span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Process all lines from 0 to count($f)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;@</span><span class="default">count</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w</span><span class="keyword">=@</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$first_char </span><span class="keyword">= @</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$w</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)==</span><span class="string">"["</span><span class="keyword">) and (@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">))==</span><span class="string">"]"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sec</span><span class="keyword">=@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,@</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">)-</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num_comments </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num_newline </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if ((</span><span class="default">stristr</span><span class="keyword">(</span><span class="default">$comment_chars</span><span class="keyword">, </span><span class="default">$first_char</span><span class="keyword">) == </span><span class="default">true</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[</span><span class="default">$sec</span><span class="keyword">][</span><span class="string">"Comment_"</span><span class="keyword">.</span><span class="default">$num_comments</span><span class="keyword">]=</span><span class="default">$w</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num_comments </span><span class="keyword">= </span><span class="default">$num_comments </span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Look for the = char to allow us to split the section into key and value<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w</span><span class="keyword">=@</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">$w</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$k</span><span class="keyword">=@</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$w</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v</span><span class="keyword">=@</span><span class="default">trim</span><span class="keyword">(@</span><span class="default">implode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">$w</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// look for the new lines<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ((@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)==</span><span class="string">"\""</span><span class="keyword">) and (@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)==</span><span class="string">"\""</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v</span><span class="keyword">=@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,@</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">)-</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[</span><span class="default">$sec</span><span class="keyword">][</span><span class="default">$k</span><span class="keyword">]=</span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[</span><span class="default">$sec</span><span class="keyword">][</span><span class="string">"Newline_"</span><span class="keyword">.</span><span class="default">$num_newline</span><span class="keyword">]=</span><span class="default">$w</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num_newline </span><span class="keyword">= </span><span class="default">$num_newline </span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">write_ini_file</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$assoc_arr</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$content </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$assoc_arr </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$elem</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$elem</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$key </span><span class="keyword">!= </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$content </span><span class="keyword">.= </span><span class="string">"["</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">"]\r\n"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$elem </span><span class="keyword">as </span><span class="default">$key2</span><span class="keyword">=&gt;</span><span class="default">$elem2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">beginsWith</span><span class="keyword">(</span><span class="default">$key2</span><span class="keyword">,</span><span class="string">'Comment_'</span><span class="keyword">) == </span><span class="default">1 </span><span class="keyword">&amp;&amp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">beginsWith</span><span class="keyword">(</span><span class="default">$elem2</span><span class="keyword">,</span><span class="string">';'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$content </span><span class="keyword">.= </span><span class="default">$elem2</span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">beginsWith</span><span class="keyword">(</span><span class="default">$key2</span><span class="keyword">,</span><span class="string">'Newline_'</span><span class="keyword">) == </span><span class="default">1 </span><span class="keyword">&amp;&amp; (</span><span class="default">$elem2 </span><span class="keyword">== </span><span class="string">''</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$content </span><span class="keyword">.= </span><span class="default">$elem2</span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$content </span><span class="keyword">.= </span><span class="default">$key2</span><span class="keyword">.</span><span class="string">" = "</span><span class="keyword">.</span><span class="default">$elem2</span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$content </span><span class="keyword">.= </span><span class="default">$key</span><span class="keyword">.</span><span class="string">" = "</span><span class="keyword">.</span><span class="default">$elem</span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return -</span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">$content</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return -</span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">beginsWith</span><span class="keyword">( </span><span class="default">$str</span><span class="keyword">, </span><span class="default">$sub </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$str</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">$sub </span><span class="keyword">) ) === </span><span class="default">$sub </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76082""></a>
  <div class="note">
   <strong class="user">yarco dot w at gmail dot com</strong>
   <a href="#76082" class="date">29-Jun-2007 01:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
parse_ini_file can't deal with const which cancate a string. For example, if test.ini file is<br />
<br />
classPath = ROOT/lib<br />
<br />
If you:<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'ROOT'</span><span class="keyword">, </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">));<br />
<br />
</span><span class="default">$buf </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'test.ini'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
const ROOT would't be parsed.<br />
<br />
But my version could work find.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// array parse_ini_file ( string $filename [, bool $process_sections] )<br />
</span><span class="keyword">function </span><span class="default">parse_ini</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$process_sections </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp; function </span><span class="default">replace_process</span><span class="keyword">(&amp; </span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$consts</span><span class="keyword">), </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$consts</span><span class="keyword">), </span><span class="default">$item</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="default">$buf </span><span class="keyword">= </span><span class="default">get_defined_constants</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">); </span><span class="comment">// PHP version &gt; 5.0<br />
&nbsp; </span><span class="default">$consts </span><span class="keyword">= </span><span class="default">$buf</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">];<br />
&nbsp; </span><span class="default">$ini </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$process_sections</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">, </span><span class="string">'replace_process'</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$ini</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'ROOT'</span><span class="keyword">, </span><span class="string">'/test'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">parse_ini</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">).</span><span class="string">'/test.ini'</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75983""></a>
  <div class="note">
   <strong class="user">Adam</strong>
   <a href="#75983" class="date">25-Jun-2007 10:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Arrays can be defined in the ini file by adding '[]' at the end of a key name. For example:<br />
<br />
value1 = 17<br />
value2 = 13<br />
<br />
value3[] = a<br />
value3[] = b<br />
value3[] = c<br />
<br />
Will return:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [value1] =&gt; 17<br />
&nbsp;&nbsp;&nbsp; [value2] =&gt; 13<br />
&nbsp;&nbsp;&nbsp; [value3] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; a<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1] =&gt; b<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [2] =&gt; c<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75356""></a>
  <div class="note">
   <strong class="user">Mildred</strong>
   <a href="#75356" class="date">25-May-2007 12:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote few functions to work with ini files.<br />
<br />
The function make_ini_file($array, &amp;$errors)<br />
The function read_ini($file)<br />
The function prepare_ini($array, $maxdepth=NULL)<br />
<br />
The function prepare_ini($array, $maxdepth=NULL)<br />
This function will take an array as returned by the function read_ini() and will return an array as needed by the function make_ini_file() so that you can write extanded ini files easily.<br />
If maxdepth is not given (or if maxdepth is NULL), this function will try to create sections so the keys in the sections do not have dots. if maxdepth is given, it will create sections with $maxdepth members in them (or less if it is not possible). It won't use the special key name "."<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">prepare_ini</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">, </span><span class="default">$maxdepth</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">prepare_ini__1</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">, </span><span class="default">$arr</span><span class="keyword">, </span><span class="default">$maxdepth</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$res</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">prepare_ini__1</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; &amp;</span><span class="default">$res</span><span class="keyword">, </span><span class="default">$arr</span><span class="keyword">, </span><span class="default">$maxdepth</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$prefix1</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">, </span><span class="default">$prefix2</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">, </span><span class="default">$depth</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$self</span><span class="keyword">=</span><span class="string">'prepare_ini__1'</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$maxdepth</span><span class="keyword">) or </span><span class="default">$depth </span><span class="keyword">&lt; </span><span class="default">$maxdepth</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newprefix </span><span class="keyword">= </span><span class="default">$prefix1 </span><span class="keyword">? </span><span class="string">"</span><span class="default">$prefix1</span><span class="string">.</span><span class="default">$key</span><span class="string">" </span><span class="keyword">: </span><span class="default">$key</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$self</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$maxdepth</span><span class="keyword">, </span><span class="default">$newprefix</span><span class="keyword">, </span><span class="default">$prefix2</span><span class="keyword">, </span><span class="default">$depth</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newprefix </span><span class="keyword">= </span><span class="default">$prefix2 </span><span class="keyword">? </span><span class="string">"</span><span class="default">$prefix1</span><span class="string">.</span><span class="default">$key</span><span class="string">" </span><span class="keyword">: </span><span class="default">$key</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$self</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$maxdepth</span><span class="keyword">, </span><span class="default">$prefix1</span><span class="keyword">, </span><span class="default">$newprefix</span><span class="keyword">, </span><span class="default">$depth</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newprefix </span><span class="keyword">= </span><span class="default">$prefix2 </span><span class="keyword">? </span><span class="string">"</span><span class="default">$prefix2</span><span class="string">.</span><span class="default">$key</span><span class="string">" </span><span class="keyword">: </span><span class="default">$key</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!isset(</span><span class="default">$res</span><span class="keyword">[</span><span class="default">$prefix1</span><span class="keyword">])) </span><span class="default">$res</span><span class="keyword">[</span><span class="default">$prefix1</span><span class="keyword">] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res</span><span class="keyword">[</span><span class="default">$prefix1</span><span class="keyword">][</span><span class="default">$newprefix</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// kate: indent-width 4; tab-width 8; space-indent on;<br />
// kate: replace-tabs off; remove-trailing-space on;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74152""></a>
  <div class="note">
   <strong class="user">mark at hostcobalt dot com</strong>
   <a href="#74152" class="date">27-Mar-2007 12:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
or to prevent the file being viewed you can just use a .htaccess file and add this line<br />
<br />
&lt;files *.ini&gt;<br />
order deny,allow<br />
deny from all<br />
&lt;/files&gt;<br />
<br />
i use a similar thing to prevent my config files being accessed</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71188""></a>
  <div class="note">
   <strong class="user">ant at loadtrax dot com</strong>
   <a href="#71188" class="date">15-Nov-2006 09:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A number of posts mention using pear::Config as a replacement for this function. Note however that internally it uses parse_ini_file to read the ini file, so it suffers from the same limitations.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70847""></a>
  <div class="note">
   <strong class="user">Justin Hall</strong>
   <a href="#70847" class="date">31-Oct-2006 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a simple (but slightly hackish) way of avoiding the character limitations (in values):<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'QUOTE'</span><span class="keyword">, </span><span class="string">'"'</span><span class="keyword">);<br />
</span><span class="default">$test </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'test.ini'</span><span class="keyword">);<br />
<br />
echo </span><span class="string">"&lt;pre&gt;"</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
contents of test.ini:<br />
<br />
park yesterday = "I (walked) | {to} " QUOTE"the"QUOTE " park yesterday &amp; saw ~three~ dogs!"<br />
<br />
output:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">park yesterday</span><span class="keyword">] =&gt; </span><span class="default">I </span><span class="keyword">(</span><span class="default">walked</span><span class="keyword">) | {</span><span class="default">to</span><span class="keyword">} </span><span class="string">"the" </span><span class="default">park yesterday </span><span class="keyword">&amp; </span><span class="default">saw </span><span class="keyword">~</span><span class="default">three</span><span class="keyword">~ </span><span class="default">dogs</span><span class="keyword">!<br />
)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70649""></a>
  <div class="note">
   
   <a href="#70649" class="date">23-Oct-2006 02:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this function won't parse a remote INI file, even with allow_url_fopen turned on.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70041""></a>
  <div class="note">
   <strong class="user">judas dot iscariote at gmail dot com</strong>
   <a href="#70041" class="date">01-Oct-2006 12:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are looking for an OOP way to parse ini files, take a look at Marcus Boerger's&nbsp; IniGroups&nbsp; class available here : <br />
<br />
<a href="http://www.php.net/~helly/php/ext/spl/classIniGroups.html" rel="nofollow" target="_blank">http://www.php.net/~helly/php/ext/spl/classIniGroups.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62184""></a>
  <div class="note">
   <strong class="user">tertillian at yahoo dot com</strong>
   <a href="#62184" class="date">21-Feb-2006 05:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I ran into a snag where I wanted to have an INI file for a library. All attempts to parse the file from the library, apart from hardcoded path qualification, failed because it couldn't find the INI file. Some of the php functions will optionally use the include path. Adding this to the parse_ini_file() function would permit its use in this way and would encourage not putting INI files in document root.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61960""></a>
  <div class="note">
   <strong class="user">nbraczek at bsds dot de</strong>
   <a href="#61960" class="date">15-Feb-2006 04:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beside the mentioned reserved words 'null', 'yes', 'no', 'true', and 'false', also 'none' seems to be a reserved word. Parsing an ini file stops at a key named 'none'.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61875""></a>
  <div class="note">
   <strong class="user">mauder[remove] at [remove]gmail[remove] dot com</strong>
   <a href="#61875" class="date">14-Feb-2006 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful if you put any .ini file in your readable directories, if somebody would know the name (e.g. if your application is widely used), the webserver might return it as plain text.<br />
<br />
For example : your database username and password could be exposed, if it is stored in that file !<br />
<br />
To prevent this from happening :<br />
- give the file .php extension :&nbsp; "my.ini.php"<br />
- put ';&lt;?php' (without quotes and without X between X and php) on first line <br />
- put ';?&gt;' on last line<br />
<br />
The server would run the ini file as being PHP-code, but will do nothing due to bad syntax, preventing the content from being exosed.<br />
On the other hand, it is still a valid .ini file...<br />
<br />
HTH !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57075""></a>
  <div class="note">
   <strong class="user">Julio Lpez Garbayo &lt;sinedeo at gmail dot com&gt;</strong>
   <a href="#57075" class="date">22-Sep-2005 01:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote a replacement function with following changes:<br />
-It allows quotes and double quotes.<br />
-It detects wether your .ini file has sections or not.<br />
-It will read until eof in any case, even if a line contains errors.<br />
<br />
I know it can be improved a lot, so feel free to work on it and, please, notify me if you do.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parse_ini_file_quotes_safe</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">)<br />
{<br />
&nbsp;</span><span class="default">$r</span><span class="keyword">=</span><span class="default">$null</span><span class="keyword">;<br />
&nbsp;</span><span class="default">$sec</span><span class="keyword">=</span><span class="default">$null</span><span class="keyword">;<br />
&nbsp;</span><span class="default">$f</span><span class="keyword">=@</span><span class="default">file</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);<br />
&nbsp;for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;@</span><span class="default">count</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;{<br />
&nbsp; </span><span class="default">$newsec</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$w</span><span class="keyword">=@</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp; if (</span><span class="default">$w</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp; if ((!</span><span class="default">$r</span><span class="keyword">) or (</span><span class="default">$sec</span><span class="keyword">))<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if ((@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)==</span><span class="string">"["</span><span class="keyword">) and (@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">))==</span><span class="string">"]"</span><span class="keyword">) {</span><span class="default">$sec</span><span class="keyword">=@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,@</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">)-</span><span class="default">2</span><span class="keyword">);</span><span class="default">$newsec</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;}<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; if (!</span><span class="default">$newsec</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$w</span><span class="keyword">=@</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">$w</span><span class="keyword">);</span><span class="default">$k</span><span class="keyword">=@</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);unset(</span><span class="default">$w</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]); </span><span class="default">$v</span><span class="keyword">=@</span><span class="default">trim</span><span class="keyword">(@</span><span class="default">implode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">$w</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; if ((@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)==</span><span class="string">"\""</span><span class="keyword">) and (@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)==</span><span class="string">"\""</span><span class="keyword">)) {</span><span class="default">$v</span><span class="keyword">=@</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,@</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">)-</span><span class="default">2</span><span class="keyword">);}<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$sec</span><span class="keyword">) {</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$sec</span><span class="keyword">][</span><span class="default">$k</span><span class="keyword">]=</span><span class="default">$v</span><span class="keyword">;} else {</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]=</span><span class="default">$v</span><span class="keyword">;}<br />
&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;return </span><span class="default">$r</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54737""></a>
  <div class="note">
   <strong class="user">dimk at pisem dot net</strong>
   <a href="#54737" class="date">13-Jul-2005 09:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Class to access ini values at format "section_name.property", for example $myconf-&gt;get("system.name") returns a property "name" in section "system":<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Settings </span><span class="keyword">{<br />
<br />
var </span><span class="default">$properties </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">Settings</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">properties </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">_SETTINGS_FILE</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">get</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="string">"."</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$section_name</span><span class="keyword">, </span><span class="default">$property</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">=&amp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">properties</span><span class="keyword">[</span><span class="default">$section_name</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$property</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">=&amp; </span><span class="default">$properties</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$section</span><span class="keyword">) &amp;&amp; isset(</span><span class="default">$section</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$section</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54140""></a>
  <div class="note">
   <strong class="user">dreamscape</strong>
   <a href="#54140" class="date">24-Jun-2005 09:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I handy function to allow values with new lines if you are PHP4, is the following:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">prepareIniNl</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/(\r\n|\n|\r)/"</span><span class="keyword">, </span><span class="string">"\\n"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Now, when writing your INI file, parse the value through the function and it will turn for example:<br />
<br />
Value line 1<br />
Value line 2<br />
<br />
Into literally:<br />
<br />
Value line 1\nValue line 2<br />
<br />
Which is stored as a single line in the INI file.&nbsp; And when you read the INI file back into PHP, the \n will be parsed and you're value will be back to:<br />
<br />
Value line 1<br />
Value line 2</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53013""></a>
  <div class="note">
   <strong class="user">dawalama at gmail dot com</strong>
   <a href="#53013" class="date">20-May-2005 08:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
* Search_ini_file refined. <br />
*/<br />
</span><span class="keyword">function </span><span class="default">search_ini_file </span><span class="keyword">( </span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$search_param</span><span class="keyword">, </span><span class="default">$return_section </span><span class="keyword">= </span><span class="default">false </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$search_key </span><span class="keyword">=&nbsp;&nbsp; (isset(</span><span class="default">$search_param</span><span class="keyword">[</span><span class="string">'key'</span><span class="keyword">])?</span><span class="default">$search_param</span><span class="keyword">[</span><span class="string">'key'</span><span class="keyword">]:</span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$search_value </span><span class="keyword">= (isset(</span><span class="default">$search_param</span><span class="keyword">[</span><span class="string">'value'</span><span class="keyword">])?</span><span class="default">$search_param</span><span class="keyword">[</span><span class="string">'value'</span><span class="keyword">]:</span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( !(</span><span class="default">$search_key </span><span class="keyword">!==</span><span class="default">false </span><span class="keyword">|| </span><span class="default">$search_value </span><span class="keyword">!==</span><span class="default">false</span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( (</span><span class="default">$search_key </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) &amp;&amp; (</span><span class="default">$search_value </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key_found </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue</span><span class="keyword">[</span><span class="string">'key'</span><span class="keyword">] = </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue</span><span class="keyword">[</span><span class="string">'value'</span><span class="keyword">] = </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while( !</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">4096</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^\[</span><span class="default">$search_key</span><span class="string">\].*?$/s"</span><span class="keyword">,</span><span class="default">$line</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key_found </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue</span><span class="keyword">[</span><span class="string">'key'</span><span class="keyword">] = </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$key_found</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^\[.*?$/"</span><span class="keyword">, </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">))){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$return_section</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$line </span><span class="keyword">!= </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$k</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">) = </span><span class="default">split</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue</span><span class="keyword">[</span><span class="default">$search_key</span><span class="keyword">][</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/;.*$/"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; }&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^</span><span class="default">$search_value</span><span class="string">\s*?=.*$/"</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue</span><span class="keyword">[</span><span class="string">'value'</span><span class="keyword">] = </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; }&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }elseif (</span><span class="default">$search_key </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keyfound </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ( !</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">4096</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^\[</span><span class="default">$search_key</span><span class="string">\].*?$/s"</span><span class="keyword">,</span><span class="default">$line</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue&nbsp; </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$return_section</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue </span><span class="keyword">= Array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keyfound </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$keyfound </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^\[.*?$/"</span><span class="keyword">, </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">))){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$return_section</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$line </span><span class="keyword">!= </span><span class="string">''</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$k</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">) = </span><span class="default">split</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue</span><span class="keyword">[</span><span class="default">$search_key</span><span class="keyword">][</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/;.*$/"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; }&nbsp; }&nbsp; }&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }elseif (</span><span class="default">$search_value </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ( !</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">4096</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^</span><span class="default">$search_value</span><span class="string">\s*?=.*$/"</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$return_section</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$line </span><span class="keyword">!= </span><span class="string">''</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$k</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">) = </span><span class="default">split</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retvalue</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/;.*$/"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; }&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$retvalue</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50741""></a>
  <div class="note">
   <strong class="user">sly at noiretblanc dot org</strong>
   <a href="#50741" class="date">08-Mar-2005 08:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful with the string "none", for example if you want to save a CSS border-style in your config.ini file :<br />
<br />
[style]<br />
borderstyle=none<br />
<br />
will return:<br />
&nbsp;&nbsp; 'style' =&gt; array ( 'borderstyle' =&gt; '' )<br />
<br />
and not <br />
&nbsp;&nbsp; 'style' =&gt; array ( 'borderstyle' =&gt; 'none' )<br />
<br />
The solution is to quote the string none :<br />
[style]<br />
borderstyle="none"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44115""></a>
  <div class="note">
   <strong class="user">hfuecks at phppatterns dot com</strong>
   <a href="#44115" class="date">15-Jul-2004 08:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
parse_ini_file seems to have changed it's signature between PHP 4.3.x and PHP 5.0.0 (can't find any relevant changelog / cvs entries referring to this).<br />
<br />
In PHP 4.3.x and below return value was a boolean FALSE if the ini file could not be found. With PHP 5.0.0 the return value is an empty array if the file is not found.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43457""></a>
  <div class="note">
   <strong class="user">php at isaacschlueter dot com</strong>
   <a href="#43457" class="date">21-Jun-2004 11:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Even better than putting the <span class="default">&lt;?php at the head of the file is to </span><span class="keyword">do </span><span class="default">something like this</span><span class="keyword">:<br />
<br />
--</span><span class="default">config</span><span class="keyword">.</span><span class="default">ini</span><span class="keyword">.</span><span class="default">php</span><span class="keyword">--<br />
; &lt;?</span><span class="default">php </span><span class="keyword">die( </span><span class="string">'Please do not access this page directly.' </span><span class="keyword">); </span><span class="default">?&gt;<br />
</span>; This is the settings page, do not modify the above line.<br />
setting = value<br />
...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37293""></a>
  <div class="note">
   <strong class="user">waikeatNOSPAM at archerlogic dot com</strong>
   <a href="#37293" class="date">09-Nov-2003 06:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found that this function will not work on remote files.<br />
I tried <br />
<br />
$someArray = parse_ini_file("<a href="http://www.example.com/setting.ini" rel="nofollow" target="_blank">http://www.example.com/setting.ini</a>");<br />
<br />
and it reports<br />
<br />
Cannot Open '<a href="http://www.example.com/setting.ini" rel="nofollow" target="_blank">http://www.example.com/setting.ini</a>' for reading ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36476""></a>
  <div class="note">
   <strong class="user">rus dot grafx at usa dot net</strong>
   <a href="#36476" class="date">10-Oct-2003 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Instead of using parse_ini_file() function I would recommend to use PEAR's Config package which is MUCH more flexible (assuming that you don't mind using PEAR and OOP). Have a closer look at <a href="http://pear.php.net/package/Config" rel="nofollow" target="_blank">http://pear.php.net/package/Config</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33249""></a>
  <div class="note">
   <strong class="user">dshearin at excite dot com</strong>
   <a href="#33249" class="date">19-Jun-2003 08:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found another pitfall to watch out for. The key (to the left of the equal sign) can't be the same as one of the predefined values, like yes, no, on, off, etc. I was working on a script that read in an ini file that matched the country codes of top level domains to the full name of the country. I kept getting a parse error everytime it got to the entry for Norway ("no"). I fixed the problem by sticking a dot in front of each of the country codes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31958""></a>
  <div class="note">
   
   <a href="#31958" class="date">10-May-2003 04:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your configuration file holds any sensitive information (such as database login details), remember NOT to place it within your document root folder! A common mistake is to replace config.inc.php files, which are formatted in PHP:<br />
<span class="default">&lt;?php<br />
$database</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] = </span><span class="string">'localhost'</span><span class="keyword">;<br />
</span><span class="comment">// etc...<br />
</span><span class="default">?&gt;<br />
</span><br />
With config.ini files which are written in plain text:<br />
[database]<br />
host = localhost<br />
<br />
The file config.ini can be read by anyone who knows where it's located, if it's under your document root folder. Remember to place it above!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28261""></a>
  <div class="note">
   <strong class="user">kieran dot huggins at rogers dot com</strong>
   <a href="#28261" class="date">07-Jan-2003 10:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a quick note for all those running into trouble escaping double quotes:<br />
<br />
I got around this by "base64_encode()"-ing my content on the way in to the ini file, and "base64_decode()"-ing on the way out.<br />
<br />
Because base64 uses the "=" sign, you will have to encapsulate the entire value in double quotes so the line looks like this:<br />
<br />
&nbsp;&nbsp;&nbsp; varname = "TmlhZ2FyYSBGYWxscywgT04="<br />
<br />
When base64'd, your strings will retain all \n, \t...etc...&nbsp; URL's retain everything perfectly :-)<br />
<br />
I hope some of you find this useful!<br />
<br />
Cheers, Kieran</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27264""></a>
  <div class="note">
   <strong class="user">fbeyer at clickhand dot de</strong>
   <a href="#27264" class="date">29-Nov-2002 09:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Besides the features mentioned above (eg. core constants, booleans), you can also access user-defined constants in ini files! This is handy if you want to create a bit-field, for example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Define pizza toppings<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_HAM'</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_PINEAPPLE'</span><span class="keyword">,&nbsp; &nbsp;&nbsp; </span><span class="default">2</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_ONION'</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">4</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_MOZARELLA'</span><span class="keyword">,&nbsp; &nbsp;&nbsp; </span><span class="default">8</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'PIZZA_GARLIC'</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">16</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Read predefined pizzas<br />
</span><span class="default">$pizzas </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'pizzas.ini'</span><span class="keyword">);<br />
<br />
if (</span><span class="default">$pizzas</span><span class="keyword">[</span><span class="default">$user_pizza</span><span class="keyword">] &amp; </span><span class="default">PIZZA_ONION</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Add onions to the pizza<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
[pizzas]<br />
<br />
; Define pizzas<br />
hawaii = PIZZA_HAM | PIZZA_PINEAPPLE<br />
stinky = PIZZA_ONION | PIZZA_GARLIC</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20204""></a>
  <div class="note">
   <strong class="user">bob at kludgebox dot com</strong>
   <a href="#20204" class="date">26-Mar-2002 10:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
And for the extra-paranoid like myself, add a rule into your httpd.conf file so that *.ini (or *.inc) in my case can't be sent to a browser:<br />
<br />
&lt;Files *.inc&gt;&nbsp; <br />
&nbsp;&nbsp;&nbsp; Order deny,allow<br />
&nbsp;&nbsp;&nbsp; Deny from all<br />
&lt;/Files&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="18216""></a>
  <div class="note">
   <strong class="user">JoshuaStarr at aelana dot com</strong>
   <a href="#18216" class="date">14-Jan-2002 07:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that in all of our attempts you cannot escape a double quote in the value when read with the parse_ini_file() function.<br />
<br />
;============================<br />
; Example Configuration File<br />
;============================<br />
[category]<br />
title = "Best Scripting Language"<br />
desc = "See &lt;a href=\"<a href="http://www.php.net/" rel="nofollow" target="_blank">http://www.php.net/</a>\"&gt;PHP&lt;/a&gt;!"<br />
<br />
If this file is read by parse_ini_file() the link value will not be set because of the escaped double quotes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.move-uploaded-file.html">move_uploaded_file</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.parse-ini-string.html">parse_ini_string</a></div>
 <div class="up"><a href="ref.filesystem.html">Filesystem Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

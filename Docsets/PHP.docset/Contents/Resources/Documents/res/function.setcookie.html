<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Send a cookie</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.pfsockopen.html">pfsockopen</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.setrawcookie.html">setrawcookie</a></div>
 <div class="up"><a href="ref.network.html">Network Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.setcookie" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">setcookie</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">setcookie</span> &mdash; <span class="dc-title">Send a cookie</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.setcookie-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><b>setcookie</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$name</tt></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$value</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$expire</tt><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$path</tt></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$domain</tt></span>
   [, <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$secure</tt><span class="initializer"> = false</span></span>
   [, <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$httponly</tt><span class="initializer"> = false</span></span>
  ]]]]]] )</div>

  <p class="para rdfs-comment">
   <span class="function"><b>setcookie()</b></span> defines a cookie to be sent along with the
   rest of the HTTP headers. Like other headers, cookies must be sent
   <em class="emphasis">before</em> any output from your script (this is a
   protocol restriction). This requires that you place calls to this function
   prior to any output, including <i>&lt;html&gt;</i> and
   <i>&lt;head&gt;</i> tags as well as any whitespace.
  </p>
  <p class="para">
   Once the cookies have been set, they can be accessed on the next page load
   with the <var class="varname"><var class="varname"><a href="reserved.variables.cookies.html" class="classname">$_COOKIE</a></var></var> or
   <var class="varname"><var class="varname">$HTTP_COOKIE_VARS</var></var> arrays.  Note,
   <a href="language.variables.superglobals.html" class="link">superglobals</a>
   such as <var class="varname"><var class="varname"><a href="reserved.variables.cookies.html" class="classname">$_COOKIE</a></var></var> became available in PHP 4.1.0.
   Cookie
   values also exist in <var class="varname"><var class="varname"><a href="reserved.variables.request.html" class="classname">$_REQUEST</a></var></var>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.setcookie-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   All the arguments except the <i><tt class="parameter">name</tt></i> argument are
   optional. You may also replace an argument with an empty string
   (<em class="emphasis">&quot;&quot;</em>) in order to skip that argument.
   Because the <i><tt class="parameter">expire</tt></i> argument is integer, it cannot
   be skipped with an empty string, use a zero (<em class="emphasis">0</em>)
   instead.
  </p>
  <p class="para">
   <a href="http://www.faqs.org/rfcs/rfc6265" class="link external" title="Link : http://www.faqs.org/rfcs/rfc6265">&raquo;&nbsp;RFC 6265</a> provides the normative
   reference on how each <span class="function"><b>setcookie()</b></span> parameter is
   interpreted.
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">name</tt></i></span>
     <dd>

      <p class="para">
       The name of the cookie.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">value</tt></i></span>
     <dd>

      <p class="para">
       The value of the cookie.  This value is stored on the clients computer;
       do not store sensitive information.  Assuming the
       <i><tt class="parameter">name</tt></i> is <i>&#039;cookiename&#039;</i>, this
       value is retrieved through <var class="varname"><var class="varname"><a href="reserved.variables.cookies.html" class="classname">$_COOKIE['cookiename']</a></var></var>
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">expire</tt></i></span>
     <dd>

      <p class="para">
       The time the cookie expires.  This is a Unix timestamp so is
       in number of seconds since the epoch.  In other words, you&#039;ll
       most likely set this with the <span class="function"><a href="function.time.html" class="function">time()</a></span> function
       plus the number of seconds before you want it to expire.  Or
       you might use <span class="function"><a href="function.mktime.html" class="function">mktime()</a></span>.
       <i>time()+60*60*24*30</i> will set the cookie to
       expire in 30 days. If set to 0, or omitted, the cookie will expire at
       the end of the session (when the browser closes).
      </p>
      <p class="para">
       <blockquote class="note"><p><b class="note">Note</b>: 
        <p class="para">
         You may notice the <i><tt class="parameter">expire</tt></i> parameter takes on a
         Unix timestamp, as opposed to the date format <i>Wdy, DD-Mon-YYYY
         HH:MM:SS GMT</i>, this is because PHP does this conversion
         internally.
        </p>
       </p></blockquote>
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">path</tt></i></span>
     <dd>

      <p class="para">
       The path on the server in which the cookie will be available on.
       If set to <i>&#039;/&#039;</i>, the cookie will be available
       within the entire <i><tt class="parameter">domain</tt></i>.  If set to
       <i>&#039;/foo/&#039;</i>, the cookie will only be available
       within the <i>/foo/</i> directory and all
       sub-directories such as <i>/foo/bar/</i> of
       <i><tt class="parameter">domain</tt></i>.  The default value is the
       current directory that the cookie is being set in.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">domain</tt></i></span>
     <dd>

      <p class="para">
       The domain that the cookie is available to. Setting the domain to
       <i>&#039;www.example.com&#039;</i> will make the cookie
       available in the <i>www</i> subdomain and higher subdomains.
       Cookies available to a lower domain, such as
       <i>&#039;example.com&#039;</i> will be available to higher subdomains,
       such as <i>&#039;www.example.com&#039;</i>.
       
       Older browsers still implementing the deprecated
       <a href="http://www.faqs.org/rfcs/rfc2109" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2109">&raquo;&nbsp;RFC 2109</a> may require a leading
       <i>.</i> to match all subdomains.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">secure</tt></i></span>
     <dd>

      <p class="para">
       Indicates that the cookie should only be transmitted over a
       secure HTTPS connection from the client. When set to <b><tt>TRUE</tt></b>, the
       cookie will only be set if a secure connection exists.
       On the server-side, it&#039;s on the programmer to send this
       kind of cookie only on secure connection (e.g. with respect to
       <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER["HTTPS"]</a></var></var>).
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">httponly</tt></i></span>
     <dd>

      <p class="para">
       When <b><tt>TRUE</tt></b> the cookie will be made accessible only through the HTTP
       protocol. This means that the cookie won&#039;t be accessible by
       scripting languages, such as JavaScript. It has been suggested that
       this setting can effectively help to reduce identity theft through
       XSS attacks (although it is not supported by all browsers), but that
       claim is often disputed. Added in PHP 5.2.0.
       <b><tt>TRUE</tt></b> or <b><tt>FALSE</tt></b>
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.setcookie-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   If output exists prior to calling this function,
   <span class="function"><b>setcookie()</b></span> will fail and return <b><tt>FALSE</tt></b>. If
   <span class="function"><b>setcookie()</b></span> successfully runs, it will return <b><tt>TRUE</tt></b>.
   This does not indicate whether the user accepted the cookie.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.setcookie-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   Some examples follow how to send cookies:
   <div class="example" id="example-4056">
    <p><b>Example #1 <span class="function"><b>setcookie()</b></span> send example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'something&nbsp;from&nbsp;somewhere'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">()+</span><span style="color: #0000BB">3600</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;expire&nbsp;in&nbsp;1&nbsp;hour&nbsp;*/<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">()+</span><span style="color: #0000BB">3600</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"/~rasmus/"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   Note that the value portion of the cookie will automatically be
   urlencoded when you send the cookie, and when it is received, it
   is automatically decoded and assigned to a variable by the same
   name as the cookie name. If you don&#039;t want this, you can use
   <span class="function"><a href="function.setrawcookie.html" class="function">setrawcookie()</a></span> instead if you are using PHP 5. To see
   the contents of our test cookie in a script, simply use one of the
   following examples:
  </p>
  <p class="para">
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Print&nbsp;an&nbsp;individual&nbsp;cookie<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">];<br />echo&nbsp;</span><span style="color: #0000BB">$HTTP_COOKIE_VARS</span><span style="color: #007700">[</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">];<br /><br /></span><span style="color: #FF8000">//&nbsp;Another&nbsp;way&nbsp;to&nbsp;debug/test&nbsp;is&nbsp;to&nbsp;view&nbsp;all&nbsp;cookies<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-4057">
    <p><b>Example #2 <span class="function"><b>setcookie()</b></span> delete example</b></p>
    <div class="example-contents"><p>
     When deleting a cookie you should assure that the expiration date
     is in the past, to trigger the removal mechanism in your browser.
     Examples follow how to delete cookies sent in previous example:
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;set&nbsp;the&nbsp;expiration&nbsp;date&nbsp;to&nbsp;one&nbsp;hour&nbsp;ago<br /></span><span style="color: #0000BB">setcookie&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">3600</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">setcookie&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">3600</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"/~rasmus/"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-4058">
    <p><b>Example #3 <span class="function"><b>setcookie()</b></span> and arrays</b></p>
    <div class="example-contents"><p>
     You may also set array cookies by using array notation in the
     cookie name. This has the effect of setting as many cookies as
     you have array elements, but when the cookie is received by your
     script, the values are all placed in an array with the cookie&#039;s
     name:
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;set&nbsp;the&nbsp;cookies<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"cookie[three]"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"cookiethree"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"cookie[two]"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"cookietwo"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"cookie[one]"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"cookieone"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;after&nbsp;the&nbsp;page&nbsp;reloads,&nbsp;print&nbsp;them&nbsp;out<br /></span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">'cookie'</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">'cookie'</span><span style="color: #007700">]&nbsp;as&nbsp;</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$name</span><span style="color: #DD0000">&nbsp;:&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">&nbsp;&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
three : cookiethree
two : cookietwo
one : cookieone
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.setcookie-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead valign="middle">
      <tr valign="middle">
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody valign="middle" class="tbody">
      <tr valign="middle">
       <td align="left">5.2.0</td>
       <td align="left">
        The <i><tt class="parameter">httponly</tt></i> parameter was added.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.setcookie-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    You can use output buffering to send output prior to the
    call of this function, with the overhead of all of your output to the
    browser being buffered in the server until you send it. You can do this
    by calling <span class="function"><a href="function.ob-start.html" class="function">ob_start()</a></span> and
    <span class="function"><a href="function.ob-end-flush.html" class="function">ob_end_flush()</a></span> in your script, or setting the
    <i>output_buffering</i> configuration directive on in your
    <var class="filename">php.ini</var> or server configuration files.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    If the PHP directive <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>
    is set to <i>on</i> then cookie values will also be made into
    variables.  In our examples below, <var class="varname"><var class="varname">$TestCookie</var></var> will
    exist.  It&#039;s recommended to use <var class="varname"><var class="varname"><a href="reserved.variables.cookies.html" class="classname">$_COOKIE</a></var></var>.
   </p>
  </p></blockquote>
  <p class="para">
   Common Pitfalls:
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      Cookies will not become visible until the next loading of a page that
      the cookie should be visible for.  To test if a cookie was successfully
      set, check for the cookie on a next loading page before the cookie
      expires.  Expire time is set via the <i><tt class="parameter">expire</tt></i>
      parameter.  A nice way to debug the existence of cookies is by
      simply calling <i>print_r($_COOKIE);</i>.
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Cookies must be deleted with the same parameters as they were set with.
      If the value argument is an empty string, or <b><tt>FALSE</tt></b>, and all other arguments
      match a previous call to setcookie, then the cookie with the specified
      name will be deleted from the remote client.
      This is internally achieved by setting value to &#039;deleted&#039; and expiration
      time to one year in past.
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Because setting a cookie with a value of <b><tt>FALSE</tt></b> will try to delete the cookie,
      you should not use boolean values. Instead, use <em class="emphasis">0</em> for <b><tt>FALSE</tt></b>
      and <em class="emphasis">1</em> for <b><tt>TRUE</tt></b>.
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Cookies names can be set as array names and will be available to your
      PHP scripts as arrays but separate cookies are stored on the user&#039;s
      system. Consider <span class="function"><a href="function.explode.html" class="function">explode()</a></span> to set one cookie with
      multiple names and values. It is not recommended to use
      <span class="function"><a href="function.serialize.html" class="function">serialize()</a></span> for this purpose, because it can result
      in security holes.
     </span>
    </li>
   </ul>
  </p>
  <p class="simpara">
   Multiple calls to <span class="function"><b>setcookie()</b></span> are performed in the order called.
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.setcookie-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.header.html" class="function" rel="rdfs-seeAlso">header()</a> - Send a raw HTTP header</span></li>
    <li class="member"><span class="function"><a href="function.setrawcookie.html" class="function" rel="rdfs-seeAlso">setrawcookie()</a> - Send a cookie without urlencoding the cookie value</span></li>
    <li class="member"><a href="features.cookies.html" class="link">cookies section</a></li>
    <li class="member"><a href="http://www.faqs.org/rfcs/rfc6265" class="link external" title="Link : http://www.faqs.org/rfcs/rfc6265">&raquo;&nbsp;RFC 6265</a></li>
    <li class="member"><a href="http://www.faqs.org/rfcs/rfc2109" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2109">&raquo;&nbsp;RFC 2109</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="106054""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#106054" class="date">06-Oct-2011 12:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Internet Explorer 8 and Internet Explorer 9 (IE8 and IE9) are still not accepting cookies from localhost.<br />
<br />
The simplest way around this is adding an entry to your hosts file e.g. 127.0.0.1 www.mytestsite.com<br />
<br />
Another pitfall that caught me twice now :<br />
The system time on one of my virtual machines sometimes starts lagging behind (because no time synchronization is set up). When defining the cookie lifetime with time()+3600,<br />
the timestamp will be in the past compared to host machine and IE and Chrome will just ignore the cookie.<br />
So check your server time if for some reason setcookie doesn't seem to work on IE or Chrome...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105738""></a>
  <div class="note">
   <strong class="user">vanclute at gmail dot com</strong>
   <a href="#105738" class="date">11-Sep-2011 11:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have been tearing my hair out wondering why a cookie would not delete.&nbsp; Despite countless discussions of reasons this can happen all over the internet, none of them addresses my case.&nbsp; Here is what was happening:<br />
<br />
My cookies have been formed kindof as an array, and the name of the cookie to be deleted is being passed in a variable, so I was using this to attempt to delete the cookie (stripped to the minimum for simplicity of the example):<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; setcookie</span><span class="keyword">(</span><span class="string">"</span><span class="default">$cookiename</span><span class="keyword">[</span><span class="default">id</span><span class="keyword">]</span><span class="string">"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
But it simply would not work.&nbsp; Ultimately what DID work was this:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; setcookie</span><span class="keyword">(</span><span class="default">$cookiename</span><span class="keyword">.</span><span class="string">"[id]"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
So I had to concatenate the variable to the "element id" and then the cookies deleted without any issue.<br />
<br />
I hope this saves someone else from a sleepless night!!<br />
<br />
Jonathan</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105120""></a>
  <div class="note">
   <strong class="user">mkmohsinali at gmail dot com</strong>
   <a href="#105120" class="date">28-Jul-2011 11:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
#cookies.php<br />
/*This code will demonstrate use of cookies with PHP<br />
It is very easy to understand and is better for beginner to<br />
understand and get idea about power of cookies when used<br />
with PHP.Here we give user a form to choose colors he/she<br />
likes for website and when he/she visits site again within one<br />
hour his/her settings are saved and read from cookie <br />
and he/she doesn't have to set the page color and page<br />
text color again.You can change time from 3600<br />
seconds to whatever you deem appropriate in your case.<br />
if you don't understand anything please email me*/<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">#checking if form has been submitted<br />
</span><span class="keyword">if (isset(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'submitted'</span><span class="keyword">])){<br />
</span><span class="comment">#if yes (form is submitted) assign values from POST array to variables<br />
</span><span class="default">$newbgColor</span><span class="keyword">=</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'bgColor'</span><span class="keyword">];<br />
</span><span class="default">$newtxtColor</span><span class="keyword">=</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'txtColor'</span><span class="keyword">];<br />
</span><span class="comment">#set cookies<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"bgColor"</span><span class="keyword">,</span><span class="default">$newbgColor</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()+</span><span class="default">3600</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"txtColor"</span><span class="keyword">,</span><span class="default">$newtxtColor</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()+</span><span class="default">3600</span><span class="keyword">);<br />
<br />
}<br />
</span><span class="comment">#in case user has come for first time and cookies are not set then<br />
</span><span class="keyword">if ((!isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'bgColor'</span><span class="keyword">]) ) &amp;&amp; (!isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'txtColor'</span><span class="keyword">]))){<br />
</span><span class="default">$bgColor </span><span class="keyword">= </span><span class="string">"Black"</span><span class="keyword">;<br />
</span><span class="default">$txtColor</span><span class="keyword">=</span><span class="string">"White"</span><span class="keyword">;<br />
}<br />
</span><span class="comment">#if cookies are set then use them<br />
</span><span class="keyword">else{<br />
</span><span class="default">$bgColor </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'bgColor'</span><span class="keyword">];<br />
</span><span class="default">$txtColor </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'txtColor'</span><span class="keyword">];<br />
}<br />
</span><span class="default">?&gt;<br />
</span>&lt;!-- HTML Page--&gt;<br />
&lt;html&gt;<br />
&lt;body bgcolor="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$bgColor ?&gt;</span>" text="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$txtColor ?&gt;</span>"&gt; <br />
&lt;form action= "<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">]; </span><span class="default">?&gt;</span>" method ="POST"&gt;<br />
&lt;p&gt;Body Color:&lt;/p&gt;<br />
&lt;select name=bgColor&gt;<br />
&lt;option value ="Red"&gt;Red&lt;/option&gt;<br />
&lt;option value ="Green" selected&gt;Green&lt;/option&gt;<br />
&lt;option value ="Blue"&gt;Blue&lt;/option&gt;<br />
&lt;option value ="Yellow"&gt;Yellow&lt;/option&gt;<br />
&lt;option value ="Black"&gt;Black&lt;/option&gt;<br />
&lt;option value ="Brown"&gt;Brown&lt;/option&gt;<br />
&lt;option value ="White"&gt;White&lt;/option&gt;<br />
&lt;/select&gt;<br />
&lt;p&gt;Text Color:&lt;/p&gt;<br />
&lt;select name=txtColor&gt;<br />
&lt;tion value ="Red"&gt;Red&lt;/option&gt;<br />
&lt;option value ="Green" selected&gt;Green&lt;/option&gt;<br />
&lt;option value ="Blue"&gt;Blue&lt;/option&gt;<br />
&lt;option value ="Yellow"&gt;Yellow&lt;/option&gt;<br />
&lt;option value ="Black"&gt;Black&lt;/option&gt;<br />
&lt;option value ="Brown"&gt;Brown&lt;/option&gt;<br />
&lt;option value ="White"&gt;White&lt;/option&gt;<br />
&lt;/select&gt;<br />
&lt;input type ="hidden" name="submitted" value="true"&gt;&lt;/br&gt;<br />
&lt;input type="submit" value="remind"&gt;<br />
&lt;/form&gt;<br />
&lt;/body&gt;<br />
&lt;/html&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104885""></a>
  <div class="note">
   <strong class="user">MrXCol</strong>
   <a href="#104885" class="date">13-Jul-2011 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're having problem with IE not accepting session cookies this could help:<br />
<br />
It seems the IE (6, 7, 8 and 9) do not accept the part 'Expire=0' when setting a session cookie. To fix it just don't put any expire at all. The default behavior when the 'Expire' is not set is to set the cookie as a session one. <br />
<br />
(Firefox doesn't complains, btw.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104198""></a>
  <div class="note">
   <strong class="user">chris at styl dot ee</strong>
   <a href="#104198" class="date">31-May-2011 08:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was searching for a simple example of creating a cookie, storing a random number and updating it on refresh. I couldn't find one so I had to figure it out on my own....<br />
<br />
- - - - <br />
One thing to *NOTE* is technically you can't update a cookie, you can only overwrite it with a new one with the same name.<br />
<br />
- - - -<br />
<br />
This creates a random number, stores it in a cookie, then references it on refresh, checks for duplicates and does necessary correction, then stores it again, rinse and repeat...<br />
<br />
<span class="default">&lt;?php<br />
ob_start</span><span class="keyword">();<br />
</span><span class="default">$MaxCount </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;</span><span class="comment">// set the max of the counter, in my tests "4" = (0,1,2,3) I adjusted below (+1) to get a "real" 4 (0,1,2,3,4) this is in reality 5 keys to humans, you can adjust script to eliminate "0", but my script makes use of the "0"<br />
<br />
</span><span class="default">$random </span><span class="keyword">=(</span><span class="default">rand</span><span class="keyword">()%(</span><span class="default">$MaxCount</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">));</span><span class="comment">//give me a random number limited by the max, adding "1" because computers start counting at "0"<br />
<br />
</span><span class="keyword">if(!isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'random'</span><span class="keyword">])){</span><span class="comment">// check if random number cookie is not set<br />
&nbsp;&nbsp;&nbsp; //echo"not set";<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'random'</span><span class="keyword">, </span><span class="default">$random</span><span class="keyword">);</span><span class="comment">//set the cookie for the first time<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}else{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lastRandom</span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'random'</span><span class="keyword">]; </span><span class="comment">//hold the last number if it was set before<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$lastRandom </span><span class="keyword">== </span><span class="default">$random</span><span class="keyword">){</span><span class="comment">//some logic to avoid repeats<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">if(</span><span class="default">$random </span><span class="keyword">&lt; </span><span class="default">$MaxCount</span><span class="keyword">){</span><span class="comment">//if below max, add 1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$random</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "under the max, adding 1, ";&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}elseif(</span><span class="default">$random </span><span class="keyword">&gt;= (</span><span class="default">$MaxCount</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)){</span><span class="comment">// if for some reason the random number is more than max or equal to it -1, and an additional -1 for max count in initial var (so in reality this -1 from intial max var, and -1 from $random which should be the same number)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$random</span><span class="keyword">--;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "hit the max, subtracting 1, ";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$random</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "no case match, adding 1, ";&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo "(".$lastRandom.", ".$random. "), they matched initally - was it fixed?";<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}else{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo "(".$lastRandom.", ".$random. "), they DO NOT match";<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'random'</span><span class="keyword">, </span><span class="default">$random</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo"is set: {$_COOKIE['random']}";<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">ob_end_flush</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103629""></a>
  <div class="note">
   <strong class="user">bocian941 at pawno dot pl</strong>
   <a href="#103629" class="date">24-Apr-2011 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My 2 functions to use "live cookies":<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">SetCookieLive</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$expire </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$path </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">, </span><span class="default">$httponly</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">, </span><span class="default">$httponly</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">RemoveCookieLive</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102436""></a>
  <div class="note">
   <strong class="user">jacobkamphansen at gmail dot com</strong>
   <a href="#102436" class="date">14-Feb-2011 05:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've been pulling my hair for a couple of minutes (read: hours) and finally figured out why setcookie in my case, returned the "headers already sent"-error:<br />
<br />
The file in question was orignally saved as ANSI in Notepad and worked flawlessly, but when saved with UTF-8-encoding, it didn't work. So after trying phpDesigner 7, I was able to both save the file in UTF-8 AND remove the BOM (byte-order-mark which is output BEFORE the cookie is set and thereby fails everything).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102352""></a>
  <div class="note">
   <strong class="user">jdknock (at) gMaIl (dot) com</strong>
   <a href="#102352" class="date">09-Feb-2011 09:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IE7 can have trouble with settings cookies that are embedded in an iframe. The problem lies with a W3C standard called Platform for Privacy Preferences or P3P for short.<br />
<br />
To overcome, include the header:<br />
<br />
header('P3P:CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"');<br />
<br />
before setting the cookie.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100174""></a>
  <div class="note">
   <strong class="user">karamfil dot pc at gmail dot com</strong>
   <a href="#100174" class="date">29-Sep-2010 05:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware of underscores in the hostname, because IE won't save cookies.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100094""></a>
  <div class="note">
   <strong class="user">RC</strong>
   <a href="#100094" class="date">24-Sep-2010 07:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of your banging your head as to why a cookie is not present when Internet Explorer 6 prints, the explanation is quite interesting. After a bit of investigation, a cookie with an expiration time other than 0 fails to be passed from IE6 to the server when printing. A cookie with an expiration time of 0 is sent.<br />
<br />
Therefore:<br />
<br />
setcookie("TestCookie", $value, time()+3600); //will not be sent from Print / Print Preview in IE6<br />
<br />
setcookie("TestCookie", $value, 0); //will be sent from Print / Print Preview in IE6<br />
<br />
I'll let everyone figure out who's bright idea it was to not send normal expiring cookies when printing in IE6...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99845""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#99845" class="date">10-Sep-2010 03:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A period in a cookie name (like user.name) seems to show up in the $_COOKIE array as an underscore (so user_name). This means that for example $_COOKIE["user_name"] must be used to read a cookie that has been set with setcookie("user.name" ...), which is already rather confusing. <br />
<br />
Furthermore the variable $_COOKIE["user_name"] will retain the value set by setcookie("user.name" ...) and no amount of calling setcookie("user_name" ...) will alter this value. This is rather trivially fixed by clearing the "user.name" cookie, but it can take a while to realize this since there's only "user_name" in $_COOKIE.<br />
<br />
Hope this saves someone some time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99452""></a>
  <div class="note">
   <strong class="user">Turion</strong>
   <a href="#99452" class="date">18-Aug-2010 06:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For some reason once I set $path = '/', the cookies won't set unless I also specify $domain = ''....<br />
<br />
Hope this helps somebody...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99010""></a>
  <div class="note">
   <strong class="user">matt at jadu dot co dot uk</strong>
   <a href="#99010" class="date">21-Jul-2010 03:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having problems with Internet Explorer not setting a cookie but Firefox will set the cookie, ensure that the date on your server is todays date and time and not a date in past!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98096""></a>
  <div class="note">
   <strong class="user">danjr33 AT [google]mail.com</strong>
   <a href="#98096" class="date">25-May-2010 04:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I haven't seen any notes yet on this, so I wanted to give an example of setting a cookie and having the value available BEFORE you reload the page.<br />
First, a disclaimer: this is only a workaround and it does not verify that the cookie was properly saved.<br />
<br />
In some cases, it may be important to be able to access a cookie on the same page load. For example for my website I was using $_COOKIE['language'] to store and check the current interface language for the user. When this was changed I needed to use the new value on the SAME page load, and I didn't want to add a conditional statement to the later code.<br />
<br />
This function is exactly identical to setcookie() except that it also sets $_COOKIE['cookiename'] to "cookievalue" and that will then be available on the same page load.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">setcookielive</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">, </span><span class="default">$httponly</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//set a cookie as usual, but ALSO add it to $_COOKIE so the current page load has access<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">,</span><span class="default">$expire</span><span class="keyword">,</span><span class="default">$path</span><span class="keyword">,</span><span class="default">$domain</span><span class="keyword">,</span><span class="default">$secure</span><span class="keyword">,</span><span class="default">$httponly</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97944""></a>
  <div class="note">
   <strong class="user">jay at w3prodigy dot com</strong>
   <a href="#97944" class="date">17-May-2010 12:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can also delete cookies by supplying setcookie an empty value.<br />
<br />
setcookie("w3p_cookie", "");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96995""></a>
  <div class="note">
   <strong class="user">jay at w3prodigy dot com</strong>
   <a href="#96995" class="date">26-Mar-2010 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To avoid the browser delay when working with cookies, you can create your cookie during the initialization process of your web site. If someone visits *any* page of your site, you should create that cookie with a default value after checking for the default value. Later, when you're working with the cookie, set it to what you need it to and it will be available on the next page the user visits.<br />
<br />
This helps avoid forcing a browser reload on the client-side. A more refined method of working with cookies is to use my example above and then interact with the cookies using javascript.<br />
<br />
To review:<br />
<br />
Perform a conditional check to ensure the cookie does not exist and create it with a controlled default value. (You can later check for the default value when adding meaningful data)<br />
<br />
<span class="default">&lt;?php<br />
$cookie_name </span><span class="keyword">= </span><span class="string">"mytestcookie"</span><span class="keyword">;<br />
if( !isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$cookie_name</span><span class="keyword">]) &amp;&amp; empty(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$cookie_name</span><span class="keyword">]) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"</span><span class="default">$cookie_name</span><span class="string">"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The cookie "mytestcookie" is now accessibly readable and writeable.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96813""></a>
  <div class="note">
   <strong class="user">nospam at oneillsoftware dot com dot au</strong>
   <a href="#96813" class="date">17-Mar-2010 02:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A note on setting cookie expiry times, particularly example #2 in which an attempt is made to delete the cookie by setting the expiry to 1 hour (3600 seconds) in the past.<br />
<br />
The function &lt;? time(); ?&gt; returns the current LOCAL time on the server.<br />
<br />
Suppose a server is located in New York with a UTC offset of -4. A client connecting from say Australia which has a UTC offset of +10 is 14 hours into the future from the point of view of the server in NY. If the American server attempts to set a session cookie which expires in say 1 hour, this would be interpreted by the client in Australia as a time 13 hours in the past. Naturally, the cookie is deleted on arrival and (depending on the script) the user might never be able to get past the login-correct page.<br />
<br />
Now looking at the inverse example:<br />
<br />
Suppose a server is located in Australia with a UTC offset of +10. A client connecting from New York with an offset of UTC-4 is 14 hours in the past as viewed from the Australian server. <br />
<br />
If the Australian server attempts to clear a cookie as in example #2, like so:<br />
&lt;?<br />
setcookie ("TestCookie", "", time() - 3600);<br />
?&gt;<br />
<br />
the client will receive a time that is 13 hours into the FUTURE, and as a result, the cookie will not be cleared.<br />
<br />
This is a potential security risk if sensitive (which really shouldn't be there in the first place...) or session data (which should be cleared on the server) is left in the cookie.<br />
<br />
A good minimum value for deleting cookies that takes into account all timezones is 25 hours in the past (3600 * 25), rather than 3600.<br />
<br />
Of course this would all be a lot easier if every browser was guaranteed to implement cookie expiration in UTC.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96251""></a>
  <div class="note">
   <strong class="user">Hjalmar W</strong>
   <a href="#96251" class="date">17-Feb-2010 03:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When setting a cookie on a page that redirects, the cookie must be set after the call to header('Location: ....');<br />
<br />
Such as:<br />
<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">'Location: <a href="http://www.example.com/" rel="nofollow" target="_blank">http://www.example.com/</a>'</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'asite'</span><span class="keyword">, </span><span class="default">$site</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()+</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'site.com'</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94398""></a>
  <div class="note">
   <strong class="user">dbessoudo at gmail dot com</strong>
   <a href="#94398" class="date">02-Nov-2009 08:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
setcookie - value = "deleted" on IE<br />
<br />
&nbsp; setcookie(session_name(), '', time()-42000, '/');<br />
<br />
When "setcookie" is passed an empty value (ie, ''), it changes the value to the string "deleted" and sets the date to exactly one year and one second in the past, ignoring the expiration parameter.*<br />
<br />
So, I'm guessing that if a client machine has its time set to more than a year in the past or if the browser is somehow broken, then a site visitor could potentially send a PHPSESSID with a value of "deleted".&nbsp; This will cause PHP to create a "sess_deleted" file in the sessions directory.<br />
<br />
In my case, I was seeing several incidents per minute, with each user clobbering the other's session data causing all kinds of security and identity issues.&nbsp; Two changes seemed to have solved the problem:<br />
<br />
1) Use session_id() in place of '' in setcookie, as well as pick a date that's far in the past (in this case Jan 1, 1970, 8:00:01AM):<br />
<br />
&nbsp;&nbsp;&nbsp; setcookie(session_name(), session_id(), 1, '/');<br />
<br />
2) Use session_regenerate_id() when logging a user in or otherwise changing their authority level.<br />
<br />
Hope this helps somebody.<br />
<br />
Rob<br />
<br />
* Here is the relevant code in head.c:<br />
<br />
&nbsp;&nbsp;&nbsp; if (value &amp;&amp; value_len == 0) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; /*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * MSIE doesn't delete a cookie when you set it to a null value&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * so in order to force cookies to be deleted, even on MSIE, we&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * pick an expiry date 1 year and 1 second in the past&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; time_t t = time(NULL) - 31536001;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; dt = php_format_date("D, d-M-Y H:i:s T", sizeof("D, d-M-Y H:i:s T")-1, t, 0 TSRMLS_CC);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; sprintf(cookie, "Set-Cookie: %s=deleted; expires=%s", name, dt);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94390""></a>
  <div class="note">
   <strong class="user">Eric</strong>
   <a href="#94390" class="date">01-Nov-2009 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The server my php code is running on has sessions disabled so I am forced to store a fair bit of arbitrary data in cookies.&nbsp; Using array names was impractical and problematic, so I implemented a splitting routine.&nbsp; I do not serialize any class instances, just arrays and simple objects.<br />
<br />
In a nutshell, when setting a cookie value, I serialize it, gzcompress it, base64 encode it, break it into pieces and store it as a set of cookies.&nbsp; To fetch the cookie value I get the named piece then iterate through piece names rebuilding the base64 data, then reverse the rest of the process.&nbsp; The only other trick is deleting the pieces correctly.<br />
<br />
Sessions are better, but if they are not available this is a viable alternative.&nbsp; I chose gz over bz for compression because it looked faster with only slightly worse ratios.<br />
<br />
Here is a simplified version of my implementation.&nbsp; This is a good starting point but is not suitable for most uses.&nbsp; For example, the domain and path are hard coded and no return values are checked for validity.<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">( </span><span class="string">'COOKIE_PORTIONS' </span><span class="keyword">, </span><span class="string">'_piece_' </span><span class="keyword">);<br />
<br />
function </span><span class="default">clearpieces</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">$inFirst </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$expire </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">()-</span><span class="default">3600</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for ( </span><span class="default">$index </span><span class="keyword">= </span><span class="default">$inFirst </span><span class="keyword">; </span><span class="default">array_key_exists</span><span class="keyword">( </span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index </span><span class="keyword">, </span><span class="default">$_COOKIE </span><span class="keyword">) ; </span><span class="default">$index </span><span class="keyword">+= </span><span class="default">1 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">( </span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">$expire </span><span class="keyword">, </span><span class="string">'/' </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset( </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index</span><span class="keyword">] );<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function </span><span class="default">clearcookie</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">clearpieces</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()-</span><span class="default">3600 </span><span class="keyword">, </span><span class="string">'/' </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; unset( </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$inKey</span><span class="keyword">] );<br />
}<br />
<br />
function </span><span class="default">storecookie</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">$inValue </span><span class="keyword">, </span><span class="default">$inExpire </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">( </span><span class="default">$inValue </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">gzcompress</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$split </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">, </span><span class="default">4000 </span><span class="keyword">);</span><span class="comment">//4k pieces<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">( </span><span class="default">$split </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for ( </span><span class="default">$index </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">; </span><span class="default">$index </span><span class="keyword">&lt; </span><span class="default">$count </span><span class="keyword">; </span><span class="default">$index </span><span class="keyword">+= </span><span class="default">1 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">setcookie</span><span class="keyword">( ( </span><span class="default">$index </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">) ? </span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index </span><span class="keyword">: </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">$split</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] , </span><span class="default">$inExpire </span><span class="keyword">, </span><span class="string">'/' </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">clearpieces</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">$count </span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">fetchcookie</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$inKey</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for ( </span><span class="default">$index </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">; </span><span class="default">array_key_exists</span><span class="keyword">( </span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index </span><span class="keyword">, </span><span class="default">$_COOKIE </span><span class="keyword">) ; </span><span class="default">$index </span><span class="keyword">+= </span><span class="default">1 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">.= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">base64_decode</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">gzuncompress</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">unserialize</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94030""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#94030" class="date">12-Oct-2009 11:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After 2 hours of head scratching, I finally came across a PHP bug filed in 2002 about sending multiple Set-Cookie headers. <br />
This may be a no-brainer to some, but make sure you set the 2nd param of header() to false if you wish to send multiple Set-Cookie headers to the browser, otherwise only the last Set-Cookie header will exist.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93996""></a>
  <div class="note">
   <strong class="user">bluebike</strong>
   <a href="#93996" class="date">10-Oct-2009 01:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want your cookie to persist indefinitely, use pow(2,31)-1 as the expires value. That seems to be the largest value that is accepted.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93712""></a>
  <div class="note">
   <strong class="user">LexyFivethousandTwothousandTwo at yahoo dot com</strong>
   <a href="#93712" class="date">23-Sep-2009 05:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your isset($_COOKIE['cookieName']) call fails even though <br />
the setcookie("cookieName", $cookieValue, time(),..)&nbsp; returned<br />
success, try replacing the timeout value with "0".&nbsp; I just spent<br />
an entire day on this strange problem.&nbsp; I am using IE8. This<br />
same call worked OK in the past with a timeout value of <br />
time() + 360.&nbsp; Anyway, changing it to "0" fixed the problem. <br />
<br />
--Alex.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93641""></a>
  <div class="note">
   <strong class="user">jah</strong>
   <a href="#93641" class="date">20-Sep-2009 02:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As &lt;info at daniel-marschall dot de&gt; points out, firefox will prepend a period (full-stop) to the domain value if the period is not already present.<br />
This is because firefox expects the domain parameter value, if present, to be a domain name and not a host name.<br />
<br />
So using setcookie() with a domain value of www.example.com is not correct if www is a host name.<br />
If you want to restrict the cookie to a single host, supply the domain parameter as an empty string, for example (note the rightmost parameter):<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="string">"TestCookie"</span><span class="keyword">, </span><span class="string">"SomeValue"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()+</span><span class="default">3600</span><span class="keyword">, </span><span class="string">"/~rasmus/"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92804""></a>
  <div class="note">
   <strong class="user">info at daniel-marschall dot de</strong>
   <a href="#92804" class="date">10-Aug-2009 07:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful when setting a domain value. The browsers have curious results (I tested with FireFox 3 only!).<br />
<br />
If session.cookie_domain is "", then your browser will probably make the cookie only available for your domain "www.example.com". That's secure since subdomains probably cannot access the cookie.<br />
<br />
If the session.cookie_domain has a value, for example "www.example.com", all browsers which are according to the RFC, will add a "." prefix to the domain. So "www.example.com" will be converted to ".www.example.com" by the browser. Now the cookie is not as secure as the cookie above since it is also accessable at subdomains.<br />
<br />
Strange...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91537""></a>
  <div class="note">
   <strong class="user">doricee at yahoo dot com</strong>
   <a href="#91537" class="date">15-Jun-2009 09:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When checking for whitespace make sure to check for a byte order mark.&nbsp; Many text editors hide this char and it will cause errors with setcookie.<br />
<br />
<span class="default">&lt;?php setcookie</span><span class="keyword">(</span><span class="string">"test"</span><span class="keyword">, </span><span class="string">"cookietest"</span><span class="keyword">);</span><span class="default">?&gt;<br />
</span><br />
&lt;U+FEFF&gt;<span class="default">&lt;?php setcookie</span><span class="keyword">(</span><span class="string">"test"</span><span class="keyword">, </span><span class="string">"cookietest"</span><span class="keyword">);</span><span class="default">?&gt;<br />
</span><br />
<a href="http://en.wikipedia.org/wiki/Byte-order_mark" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Byte-order_mark</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91507""></a>
  <div class="note">
   <strong class="user">jesdisciple{ at t}gmail{d dot t}com</strong>
   <a href="#91507" class="date">13-Jun-2009 05:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who are writing their own replacement functions to comply with RFC 2109 / 2965 (and the PHP maintainers), note that your Max-Age value should technically be ignored, or at best treated as an ordinary value, unless you set Version=1.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91140""></a>
  <div class="note">
   <strong class="user">laffen</strong>
   <a href="#91140" class="date">27-May-2009 01:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the $_COOKIE variable not will hold multiple cookies with the same name. It is legitimate to set two cookies with the same name to the same host where the sub domain is different. <br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="string">"testcookie"</span><span class="keyword">, </span><span class="string">"value1hostonly"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">(), </span><span class="string">"/"</span><span class="keyword">, </span><span class="string">".example.com"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"testcookie"</span><span class="keyword">, </span><span class="string">"value2subdom"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">(), </span><span class="string">"/"</span><span class="keyword">, </span><span class="string">"subdom.example.com"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>The next request from the browser will have both cookies in the $_SERVER['HTTP_COOKIE'] variable, but only one of them will be found in the $_COOKIE variable. Requests to subdom.example.com will have both cookies, while browser request to example.com or www.example.com only sends the cookie with the "value1hostonly" value.<br />
<br />
<span class="default">&lt;?php<br />
$kaker </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">";"</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_COOKIE'</span><span class="keyword">]);<br />
foreach(</span><span class="default">$kaker </span><span class="keyword">as </span><span class="default">$val</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$k </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) . </span><span class="string">" =&gt; " </span><span class="keyword">. </span><span class="default">$k</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
}<br />
<br />
</span><span class="comment">// output<br />
</span><span class="default">testcookie </span><span class="keyword">=&gt; </span><span class="default">value1hostonly<br />
testcookie </span><span class="keyword">=&gt; </span><span class="default">value2subdom<br />
<br />
?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91071""></a>
  <div class="note">
   <strong class="user">Arthur Lui</strong>
   <a href="#91071" class="date">23-May-2009 11:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Also note that you should specify the path as '/' if you want the cookie to apply to the entire site, especially if the location of the file where you create the cookies isn't at the root.<br />
<br />
The file that created the cookies was /assets/php/login.php and was creating cookies for the path "/assets/php/" only so it drove me nuts when I went to the homepage and the cookie wasn't accessible from there.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90616""></a>
  <div class="note">
   <strong class="user">mm at turkmenweb dot com</strong>
   <a href="#90616" class="date">30-Apr-2009 09:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware of "Last-Modified" header when dealing with cookies.<br />
If you are explicitly setting Last-Modified to a past time (a few hours, mins ago, or etc) then even though browser will update your cookie, it won't reflect on your page (if you say &lt;?=$_COOKIE['yourcookie']?&gt; , browser will still print old value). I have seen this in Firefox 3, and in IE8.<br />
<br />
Here is the code:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">if(isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'hide'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'hide'</span><span class="keyword">]==</span><span class="string">'y'</span><span class="keyword">){<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"TmhabarMainNewsHide"</span><span class="keyword">, </span><span class="string">'y'</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()+</span><span class="default">3600</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">1000</span><span class="keyword">,</span><span class="string">"/"</span><span class="keyword">,</span><span class="string">".tmhabar.com"</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
}<br />
elseif(isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'hide'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'hide'</span><span class="keyword">]==</span><span class="string">'n'</span><span class="keyword">){<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"TmhabarMainNewsHide"</span><span class="keyword">, </span><span class="string">'n' </span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()+</span><span class="default">3600</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">1000</span><span class="keyword">,</span><span class="string">"/"</span><span class="keyword">,</span><span class="string">".tmhabar.com"</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$last_modified </span><span class="keyword">= </span><span class="default">filemtime</span><span class="keyword">(</span><span class="string">'inc/somefile.html'</span><span class="keyword">);<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Last-Modified: "</span><span class="keyword">.</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"D, d M Y H:i:s"</span><span class="keyword">, </span><span class="default">$last_modified</span><span class="keyword">).</span><span class="string">" GMT"</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'TmhabarMainNewsHide'</span><span class="keyword">];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Last-Modified header above is being set to a time in the past (last modification time of a certain file). In the browser, after the '/?hide=y' call, output still remains 'n' -&gt; as if cookie value hasn't changed. When you go to Firefox's "View Page Info", there cookie is set to 'y' (which is an expected behavior). Doesn't matter how many times I refreshed the page, or followed other inner links of the page, cookie value never changed. It only changes if you CTRL+F5 in the browser.<br />
<br />
I guess this is an expected behavior of a browser, not to update the page if it's last-modified header is set to back in time. But on the other hand, dynamic values should change in page. So, just be aware :) Btw, everything worked perfectly once I have commented out the 'header("Last-Modified: "....' line in the code above.<br />
<br />
Hope this helps someone. Peace.<br />
Muhammed Mamedov</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90347""></a>
  <div class="note">
   <strong class="user">Steve</strong>
   <a href="#90347" class="date">17-Apr-2009 01:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware, the example below works fine on my testing server but didn't work on my providers server;<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="string">"SessionID"</span><span class="keyword">,</span><span class="string">"a test cookie"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Once the cookie is set my entire web site fails with messages<br />
similar to.<br />
<br />
&nbsp;"An appropriate representation of the requested resource could not be found on this server."<br />
<br />
I'd used similar code for years on another site, but where the value was numeric, I'd made a minor change to generate a random string for the session ID and then got this issue.<br />
<br />
The solution is not to use the cookie name "SessionID", i.e.<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="string">"SessionToken"</span><span class="keyword">,</span><span class="string">"a test cookie"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
works fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90084""></a>
  <div class="note">
   <strong class="user">dan at reverb-marketing dot com</strong>
   <a href="#90084" class="date">05-Apr-2009 11:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Consider adding a version number to your cookie string.&nbsp; That way if your site gets an upgrade and the contents of your cookie change then it won't create (as big of) a headache for old users.<br />
<br />
<span class="default">&lt;?php<br />
$foo</span><span class="keyword">=</span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'remember_me'</span><span class="keyword">]);<br />
if(</span><span class="default">$foo</span><span class="keyword">[</span><span class="string">'version'</span><span class="keyword">]==</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment">// original cookie.&nbsp; Ignore it?&nbsp; Process it differently?<br />
&nbsp; </span><span class="default">old_and_busted</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">[</span><span class="string">'data'</span><span class="keyword">]);<br />
} else if(</span><span class="default">$foo</span><span class="keyword">[</span><span class="string">'version'</span><span class="keyword">]==</span><span class="default">2</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment">// new cookie, proceed as normal<br />
&nbsp; </span><span class="default">new_hotness</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">[</span><span class="string">'data'</span><span class="keyword">]);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88926""></a>
  <div class="note">
   <strong class="user">maksymus007 at gmail dot com</strong>
   <a href="#88926" class="date">13-Feb-2009 06:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To resolve problem of time difference between time on server and on client, just set a cookie with maximum lifetime and as one of its fields set local server time, that will be compared while cookie is read.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88847""></a>
  <div class="note">
   <strong class="user">paul at webtop-designs dot com</strong>
   <a href="#88847" class="date">10-Feb-2009 11:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying to send cookies and keep getting a message about headers already sent but you cannot find where, check your files...a single space after the closing ?&gt; in php is classed as output and will cause this issue.<br />
<br />
Zend Framework users will note the new technique and not closing your files at all...that is to combat this same problem.<br />
<br />
Make sure that ?&gt; are the very last 2 characters of your file.<br />
<br />
//erlin</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88803""></a>
  <div class="note">
   <strong class="user">erikinc at bredband dot net</strong>
   <a href="#88803" class="date">08-Feb-2009 01:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When working with encryption and setcookie( ) the decryption might fail in an seemingly random manner, making the cookie seem corrupt. This is due to the fact that php url-encodes the data before sending it to the client, and may therefore effectively be changing the ciphertext. A decryption of a changed ciphertext will render the plaintext unreadable. Due to the fact that this error only occurs when the ciphertext acctually contains characters needing encoding can make it very hard to identify.<br />
<br />
One way to solve this problem, is to implement the url-encoding in the script, by using urlencode( ) and urldecode( ). <br />
Prior to setting the cookie, use urlencode( ): <br />
<span class="default">&lt;?php<br />
<br />
$ciphertext </span><span class="keyword">= </span><span class="default">$myEncryptionObject</span><span class="keyword">-&gt;</span><span class="default">encrypt</span><span class="keyword">( </span><span class="default">$plaintext </span><span class="keyword">);<br />
</span><span class="default">$safeCiphertext </span><span class="keyword">= </span><span class="default">urlencode</span><span class="keyword">( </span><span class="default">$ciphertext </span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">( </span><span class="string">"myCookie"</span><span class="keyword">, </span><span class="default">$safeCiphertext</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
And then using urldecode( ) prior to decryption of the ciphertext:<br />
<span class="default">&lt;?php<br />
<br />
$safeData </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[ </span><span class="string">"myCookie" </span><span class="keyword">];<br />
</span><span class="default">$ciphertext </span><span class="keyword">= </span><span class="default">urldecode</span><span class="keyword">( </span><span class="default">$safeData </span><span class="keyword">);<br />
</span><span class="default">$plaintext </span><span class="keyword">= </span><span class="default">$myEncryptionObject</span><span class="keyword">-&gt;</span><span class="default">decrypt</span><span class="keyword">( </span><span class="default">$ciphertext </span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87525""></a>
  <div class="note">
   <strong class="user">Frank</strong>
   <a href="#87525" class="date">08-Dec-2008 07:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One note on storing information in an "array" in a cookie:<br />
<br />
You CANNOT access that array as a normal array.<br />
<br />
So for example if you store:<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="string">"cookie[three]"</span><span class="keyword">, </span><span class="string">"cookiethree"</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"cookie[two]"</span><span class="keyword">, </span><span class="string">"cookietwo"</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"cookie[one]"</span><span class="keyword">, </span><span class="string">"cookieone"</span><span class="keyword">);<br />
<br />
</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">cookie</span><span class="keyword">][</span><span class="default">one</span><span class="keyword">] </span><span class="default">returns nothing</span><span class="keyword">.<br />
</span><span class="default">?&gt;<br />
</span><br />
You MUST use foreach to grab all the information listed in the example above.<br />
<br />
Not sure if this is a bug in php or a "feature."<br />
<br />
Hopefully, this can save others some time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85664""></a>
  <div class="note">
   <strong class="user">bogdan at moongate dot ro</strong>
   <a href="#85664" class="date">11-Sep-2008 02:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware of the Cookie Monster (<a href="http://preview.tinyurl.com/5964ho" rel="nofollow" target="_blank">http://preview.tinyurl.com/5964ho</a>) -- always set $secure to true for cookies set within secure environments (i.e. when your code is being accessed via HTTPS).<br />
<br />
Also be advised that PHP's session manager doesn't do that automatically -- by default starting a session within a secure environment sets a cookie which is then accessible via non-secure channels. For sessions started in secure environments use:<br />
<br />
<span class="default">&lt;?php INI_Set</span><span class="keyword">(</span><span class="string">'session.cookie_secure'</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
before starting the session.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85523""></a>
  <div class="note">
   <strong class="user">Link dot random at gmail dot com</strong>
   <a href="#85523" class="date">03-Sep-2008 02:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Platform: Windows XP SP2, IIS5.2, Php5.2.5:<br />
<br />
I've had my share of sessioning problems and all of them came from the fact that i'm using Php Designer 2007 as my php editor.. Cookies must be sent before any output from your script including &lt;html&gt; and &lt;head&gt; tags as well as any whitespaces, well this php editor was sending a sort of data before the headers that i want to send which cause to have the given error: "Cannot send session Cookie - headers already sent", even after using output buffers to fixe the problem of the time the cookies are sent i still had the same problem.<br />
Solution? Don't use any editor..! notepad is all you need... Used notepad, and it worked like magic!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84721""></a>
  <div class="note">
   <strong class="user">php at gigadepot dot com</strong>
   <a href="#84721" class="date">27-Jul-2008 10:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use a multiple cookie name with the function bellow<br />
<br />
example : <br />
<br />
createcookie("member[name]","jack");<br />
<br />
don't work with array<br />
<br />
error with "rawurlencode($name)"<br />
<br />
I'm use : createcookie(array('member'=&gt;'name'),'jack');<br />
<br />
<span class="default">&lt;?php<br />
createCookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$maxage</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">,</span><span class="default">$domain</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">, </span><span class="default">$HTTPOnly</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) <br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$k</span><span class="keyword">,</span><span class="default">$v</span><span class="keyword">)&nbsp; &nbsp; =&nbsp; &nbsp; </span><span class="default">each</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name&nbsp; &nbsp; </span><span class="keyword">=&nbsp; &nbsp; </span><span class="default">$k</span><span class="keyword">.</span><span class="string">'['</span><span class="keyword">.</span><span class="default">$v</span><span class="keyword">.</span><span class="string">']'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'output_buffering'</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Abort the method if headers have already been sent, except when output buffering has been enabled <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">headers_sent</span><span class="keyword">() &amp;&amp; (bool) </span><span class="default">$ob </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">|| </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$ob</span><span class="keyword">) == </span><span class="string">'off' </span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( !empty(</span><span class="default">$domain</span><span class="keyword">) ) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Fix the domain to accept domains with and without 'www.'. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">strtolower</span><span class="keyword">( </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">) ) == </span><span class="string">'www.' </span><span class="keyword">) </span><span class="default">$domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Add the dot prefix to ensure compatibility with subdomains <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) != </span><span class="string">'.' </span><span class="keyword">) </span><span class="default">$domain </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$domain</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Remove port information. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="string">':'</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$port </span><span class="keyword">!== </span><span class="default">false </span><span class="keyword">) </span><span class="default">$domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Prevent "headers already sent" error with utf8 support (BOM) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //if ( utf8_support ) header('Content-Type: text/html; charset=utf-8'); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Set-Cookie: '</span><span class="keyword">.</span><span class="default">$name</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$domain</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Domain='</span><span class="keyword">.</span><span class="default">$domain</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$maxage</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Max-Age='</span><span class="keyword">.</span><span class="default">$maxage</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$path</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Path='</span><span class="keyword">.</span><span class="default">$path</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(!</span><span class="default">$secure </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Secure'</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(!</span><span class="default">$HTTPOnly </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; HttpOnly'</span><span class="keyword">), </span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Set-Cookie: '</span><span class="keyword">.</span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">).</span><span class="string">'='</span><span class="keyword">.</span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$domain</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Domain='</span><span class="keyword">.</span><span class="default">$domain</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$maxage</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Max-Age='</span><span class="keyword">.</span><span class="default">$maxage</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$path</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Path='</span><span class="keyword">.</span><span class="default">$path</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(!</span><span class="default">$secure </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Secure'</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(!</span><span class="default">$HTTPOnly </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; HttpOnly'</span><span class="keyword">), </span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82695""></a>
  <div class="note">
   <strong class="user">jphansen at uga dot edu</strong>
   <a href="#82695" class="date">22-Apr-2008 05:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you'd like to set a cookie for a prolonged time, here's an example for a cooking lasting 1 year, which passes seconds--60 seconds * 60 minutes * 24 hours * 365 days = 1 year--as the $expire argument.<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()+(</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">365</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81398""></a>
  <div class="note">
   <strong class="user">isooik at gmail-antispam dot com</strong>
   <a href="#81398" class="date">26-Feb-2008 05:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a more advanced version of the php setcookie() alternative function:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * A better alternative (RFC 2109 compatible) to the php setcookie() function<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param string Name of the cookie<br />
&nbsp;&nbsp; &nbsp; * @param string Value of the cookie<br />
&nbsp;&nbsp; &nbsp; * @param int Lifetime of the cookie<br />
&nbsp;&nbsp; &nbsp; * @param string Path where the cookie can be used<br />
&nbsp;&nbsp; &nbsp; * @param string Domain which can read the cookie<br />
&nbsp;&nbsp; &nbsp; * @param bool Secure mode?<br />
&nbsp;&nbsp; &nbsp; * @param bool Only allow HTTP usage?<br />
&nbsp;&nbsp; &nbsp; * @return bool True or false whether the method has successfully run<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">createCookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$maxage</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">, </span><span class="default">$HTTPOnly</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'output_buffering'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Abort the method if headers have already been sent, except when output buffering has been enabled<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">headers_sent</span><span class="keyword">() &amp;&amp; (bool) </span><span class="default">$ob </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">|| </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$ob</span><span class="keyword">) == </span><span class="string">'off' </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( !empty(</span><span class="default">$domain</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Fix the domain to accept domains with and without 'www.'.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">strtolower</span><span class="keyword">( </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">) ) == </span><span class="string">'www.' </span><span class="keyword">) </span><span class="default">$domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Add the dot prefix to ensure compatibility with subdomains<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) != </span><span class="string">'.' </span><span class="keyword">) </span><span class="default">$domain </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$domain</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Remove port information.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="string">':'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$port </span><span class="keyword">!== </span><span class="default">false </span><span class="keyword">) </span><span class="default">$domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Prevent "headers already sent" error with utf8 support (BOM)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //if ( utf8_support ) header('Content-Type: text/html; charset=utf-8');<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Set-Cookie: '</span><span class="keyword">.</span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">).</span><span class="string">'='</span><span class="keyword">.</span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$domain</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Domain='</span><span class="keyword">.</span><span class="default">$domain</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$maxage</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Max-Age='</span><span class="keyword">.</span><span class="default">$maxage</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$path</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Path='</span><span class="keyword">.</span><span class="default">$path</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(!</span><span class="default">$secure </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Secure'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(!</span><span class="default">$HTTPOnly </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; HttpOnly'</span><span class="keyword">), </span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Regards,<br />
Isaak</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80964""></a>
  <div class="note">
   <strong class="user">sebasg37 at gmail dot com</strong>
   <a href="#80964" class="date">08-Feb-2008 07:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As said, you can avoid the annoying "headers already sent in line..", using the ob_start() (function that serves as buffer) doing this:<br />
<br />
<span class="default">&lt;?php<br />
ob_start</span><span class="keyword">();<br />
<br />
echo </span><span class="string">"somtehing"</span><span class="keyword">;<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"cookie"</span><span class="keyword">, </span><span class="string">"value"</span><span class="keyword">); </span><span class="comment">/* if you didn't add the ob_start() function at this point the headers would have been already sent and the cookie have not been saved */<br />
<br />
</span><span class="default">ob_end_flush</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80849""></a>
  <div class="note">
   <strong class="user">dave at shout411 dot com</strong>
   <a href="#80849" class="date">03-Feb-2008 05:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
firefox will permit a short cookie length, eg +60<br />
IE6 (all i tested as yet) will not create the cookie for +60<br />
It will though accept +120 (two minutes)<br />
d.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79659""></a>
  <div class="note">
   <strong class="user">globexdesigns at gmail dot com</strong>
   <a href="#79659" class="date">06-Dec-2007 04:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Quotes are important when giving cookies parameters. If it looks like you can't delete your cookies, or cookies doesn't delete verify that both your cookies names are consistent.<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="default">mycookie</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() + </span><span class="default">3600</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"mycookie"</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">() - </span><span class="default">3600</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The above is wrong. But the examples are right:<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="string">"mycookie"</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() + </span><span class="default">3600</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"mycookie"</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">() - </span><span class="default">3600</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="default">mycookie</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() + </span><span class="default">3600</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">mycookie</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">() - </span><span class="default">3600</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79488""></a>
  <div class="note">
   <strong class="user">Alexander Fleischer</strong>
   <a href="#79488" class="date">29-Nov-2007 08:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using $httponly also prevents the browser to pass a cookie to the java class loader. If a session cookie is required to access java .class / .jar files, loading of the applet will fail. In this case, session.cookie_httponly may be switched off.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79350""></a>
  <div class="note">
   <strong class="user">soeren dot spreng at gmail dot com</strong>
   <a href="#79350" class="date">22-Nov-2007 02:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware: The Internet Explorer doesn't accept Cookies with an expiretime, which is to long. time() + time() for example doesn't work and the Cookie won't be created!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78833""></a>
  <div class="note">
   <strong class="user">amalinovski at yahoo dot com</strong>
   <a href="#78833" class="date">30-Oct-2007 12:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Problem with setcookie() and UTF-8 recognizing by browser:<br />
- If you want to use UTF-8 characters in your php file, some editors insert special bytes in the very beginning of the file. This prevents setcookie() from working, because these special bytes are sent to the browser BEFORE the header, and you get "Header already sent" error;<br />
- If you delete these bytes (with a hex editor), setcookie() will work fine, but the browser will STOP recognizing UTF-8 encoding automatically! The user will need to set the encoding to UTF-8 manually to see your page correctly.<br />
Here's how to get out of this:<br />
<br />
Instead of:<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="string">"aaa"</span><span class="keyword">, </span><span class="string">"bbb"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>&lt;html&gt;<br />
&lt;head&gt;<br />
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;<br />
<br />
Write this:<br />
<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">"Content-Type: text/html; charset=utf-8"</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"aaa"</span><span class="keyword">, </span><span class="string">"bbb"</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>&lt;html&gt;<br />
&lt;head&gt;<br />
...<br />
<br />
(make sure you have no special bytes before "&lt;?")</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78624""></a>
  <div class="note">
   <strong class="user">mikeh at view22 dot com</strong>
   <a href="#78624" class="date">19-Oct-2007 11:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Observed: session cookies were expiring even though the session was still active.&nbsp; (To test, set a cookie expiry of 5 seconds and keep hitting the page every second.&nbsp; The session will expire and create a new SESSID after 5 seconds despite the fact that you hit the page only a second ago.)<br />
<br />
Calling this function before starting the session fixed it.&nbsp; It copies the cookie contents back to itself while forcing an update to the expiry time in the cookie.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">FreshenSessionCookie</span><span class="keyword">(</span><span class="default">$lifetimeSeconds</span><span class="keyword">, </span><span class="default">$cookieName </span><span class="keyword">= </span><span class="string">'PHPSESSID'</span><span class="keyword">) <br />
{<br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$cookieName</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$cookieName</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$timeout </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">()+</span><span class="default">$lifetimeSeconds</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$cookieName</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">,&nbsp; </span><span class="default">$timeout</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77276""></a>
  <div class="note">
   <strong class="user">cwillard at fastmail dot fm</strong>
   <a href="#77276" class="date">22-Aug-2007 07:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're looking to set multiple values in your cookie (rather than setting multiple cookies) you might find these useful.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">build_cookie</span><span class="keyword">(</span><span class="default">$var_array</span><span class="keyword">) {<br />
&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$var_array</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$var_array </span><span class="keyword">as </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$data</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">.= (</span><span class="default">$data</span><span class="keyword">!=</span><span class="string">""</span><span class="keyword">) ? </span><span class="default">$index</span><span class="keyword">.</span><span class="string">"="</span><span class="keyword">.</span><span class="default">$data</span><span class="keyword">.</span><span class="string">"|" </span><span class="keyword">: </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">,</span><span class="string">"|"</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">break_cookie </span><span class="keyword">(</span><span class="default">$cookie_string</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$array</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"|"</span><span class="keyword">,</span><span class="default">$cookie_string</span><span class="keyword">);<br />
&nbsp; foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$stuff</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$stuff</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">$stuff</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$stuff</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]]=</span><span class="default">$stuff</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Hopefully someone finds these useful.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76395""></a>
  <div class="note">
   <strong class="user">bluewaterbob</strong>
   <a href="#76395" class="date">12-Jul-2007 11:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you are having problems seeing cookies sometimes or deleting cookies sometimes, despite following the advice below, make sure you are setting the cookie with the domain argument. Set it with the dot before the domain as the examples show: ".example.com".&nbsp; I wasn't specifying the domain, and finally realized I was setting the cookie when the browser url had the <a href="http://www.example.com and later trying to delete it when the url didn" rel="nofollow" target="_blank">http://www.example.com and later trying to delete it when the url didn</a>'t have the www. ie. <a href="http://example.com. This also caused the page to be unable to find the cookie when the www. wasn" rel="nofollow" target="_blank">http://example.com. This also caused the page to be unable to find the cookie when the www. wasn</a>'t in the domain.&nbsp; (When you add the domain argument to the setcookie code that creates the cookie, make sure you also add it to the code that deletes the cookie.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75343""></a>
  <div class="note">
   <strong class="user">jonathan dot bergeron at rve dot ulaval dot ca</strong>
   <a href="#75343" class="date">24-May-2007 12:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
About the delete part, I found that Firefox only remove the cookie when you submit the same values for all parameters, except the date, which sould be in the past. Submiting blank values didn't work for me.<br />
<br />
Example :<br />
- set -<br />
<br />
<span class="default">&lt;?php setcookie</span><span class="keyword">( </span><span class="string">"name"</span><span class="keyword">, </span><span class="string">"value"</span><span class="keyword">, </span><span class="string">"future_timestamp"</span><span class="keyword">, </span><span class="string">"path"</span><span class="keyword">, </span><span class="string">"domain" </span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
- delete -<br />
<span class="default">&lt;?php setcookie</span><span class="keyword">( </span><span class="string">"name"</span><span class="keyword">, </span><span class="string">"value"</span><span class="keyword">, </span><span class="string">"past_timestamp"</span><span class="keyword">, </span><span class="string">"path"</span><span class="keyword">, </span><span class="string">"domain" </span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
Jonathan</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74401""></a>
  <div class="note">
   <strong class="user">anonIMouS</strong>
   <a href="#74401" class="date">10-Apr-2007 01:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This code sets cookie with Max-Age.<br />
See to:<br />
<a href="http://www.zend.com/zend/week/week198.php#Heading3" rel="nofollow" target="_blank">http://www.zend.com/zend/week/week198.php#Heading3</a><br />
<a href="http://www.faqs.org/rfcs/rfc2109.html" rel="nofollow" target="_blank">http://www.faqs.org/rfcs/rfc2109.html</a><br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">set_cookie</span><span class="keyword">(</span><span class="default">$Name</span><span class="keyword">, </span><span class="default">$Value </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$MaxAge </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$Path </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$Domain </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$Secure </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$HTTPOnly </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Set-Cookie: ' </span><span class="keyword">. </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$Name</span><span class="keyword">) . </span><span class="string">'=' </span><span class="keyword">. </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$Value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (empty(</span><span class="default">$MaxAge</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Max-Age=' </span><span class="keyword">. </span><span class="default">$MaxAge</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (empty(</span><span class="default">$Path</span><span class="keyword">)&nbsp;&nbsp; ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; path=' </span><span class="keyword">. </span><span class="default">$Path</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (empty(</span><span class="default">$Domain</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; domain=' </span><span class="keyword">. </span><span class="default">$Domain</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (!</span><span class="default">$Secure&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; secure'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (!</span><span class="default">$HTTPOnly&nbsp; &nbsp;&nbsp; </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; HttpOnly'</span><span class="keyword">), </span><span class="default">false</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment"># examples:<br />
</span><span class="default">set_cookie</span><span class="keyword">(</span><span class="string">"TestCookie"</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">3600</span><span class="keyword">);&nbsp; </span><span class="comment">/* expire in 1 hour */<br />
</span><span class="default">set_cookie</span><span class="keyword">(</span><span class="string">"TestCookie"</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">3600</span><span class="keyword">, </span><span class="string">"/~rasmus/"</span><span class="keyword">, </span><span class="string">".example.com"</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74231""></a>
  <div class="note">
   <strong class="user">Marcin Wiazowski</strong>
   <a href="#74231" class="date">30-Mar-2007 12:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
'session.cookie_domain' should be set to empty string for all local domain names, not only for 'localhost' (but should not be empty for local IP addresses):<br />
<br />
<span class="default">&lt;?php<br />
ini_set</span><span class="keyword">(</span><span class="string">'session.cookie_domain'</span><span class="keyword">, (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">],</span><span class="string">'.'</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) ? </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74126""></a>
  <div class="note">
   <strong class="user">mike</strong>
   <a href="#74126" class="date">26-Mar-2007 08:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful of using the same cookie name in subdirectories. Setting a simple cookie <br />
<br />
<span class="default">&lt;?php setcookie</span><span class="keyword">(</span><span class="string">"region"</span><span class="keyword">, </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'set_region'</span><span class="keyword">]); </span><span class="default">?&gt;<br />
</span><br />
both in the root / and for instance in this case /admin/ will create 2 cookies with different paths. In reading the cookies back only the first one is read regardless of path.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74046""></a>
  <div class="note">
   
   <a href="#74046" class="date">21-Mar-2007 02:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you only want to do something once per unique visitor, you can test if a cookie is set, and if not, set the cookie and perform the action. This being the poorman's version, it has a problem, where if a user is blocking cookies they will appear as a first time visitor each time. What you can do to avoid this is to set a test cookie first and check that it exists. If it exists, then check to see if your second cookie has been set. If the first one is set, but the second isn't, then you know this is a first time visitor.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73484""></a>
  <div class="note">
   <strong class="user">gabe at fijiwebdesign dot com</strong>
   <a href="#73484" class="date">25-Feb-2007 07:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to delete all cookies on your domain, you may want to use the value of:<br />
<br />
<span class="default">&lt;?php $_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_COOKIE'</span><span class="keyword">] </span><span class="default">?&gt;<br />
</span><br />
rather than:<br />
<br />
<span class="default">&lt;?php $_COOKIE ?&gt;<br />
</span><br />
to dertermine the cookie names. <br />
If cookie names are in Array notation, eg: user[username] <br />
Then PHP will automatically create a corresponding array in $_COOKIE. Instead use $_SERVER['HTTP_COOKIE'] as it mirrors the actual HTTP Request header. <br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// unset cookies<br />
</span><span class="keyword">if (isset(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_COOKIE'</span><span class="keyword">])) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cookies </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">';'</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_COOKIE'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$cookies </span><span class="keyword">as </span><span class="default">$cookie</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$cookie</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$parts</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()-</span><span class="default">1000</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()-</span><span class="default">1000</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73107""></a>
  <div class="note">
   
   <a href="#73107" class="date">08-Feb-2007 05:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
something that wasn't made clear to me here and totally confused me for a while was that domain names must contain at least two dots (.), hence 'localhost' is invalid and the browser will refuse to set the cookie! instead for localhost you should use false.<br />
<br />
to make your code work on both localhost and a proper domain, you can do this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$domain </span><span class="keyword">= (</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">] != </span><span class="string">'localhost'</span><span class="keyword">) ? </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">] : </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'cookiename'</span><span class="keyword">, </span><span class="string">'data'</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()+</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">365</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72960""></a>
  <div class="note">
   <strong class="user">brian dot powell at insetsolutions dot com</strong>
   <a href="#72960" class="date">05-Feb-2007 06:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is problem I ran into during a recent bout with IE7 and cookies.&nbsp; IE will not delete a cookie value if the time is set to the past.&nbsp; It will hold the value no matter how far in the past you set the "expire" value.&nbsp; IE7 is the only browser I have had problems with - so here is the solution I came up with.<br />
<br />
<span class="default">&lt;?PHP<br />
<br />
</span><span class="comment">//check to see how to set the cookie<br />
</span><span class="default">$Browsertype </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_USER_AGENT'</span><span class="keyword">];<br />
</span><span class="default">$Parts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$Browsertype</span><span class="keyword">);<br />
</span><span class="default">$MSIE </span><span class="keyword">= </span><span class="default">array_search</span><span class="keyword">(</span><span class="string">"MSIE"</span><span class="keyword">,</span><span class="default">$Parts</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
if(</span><span class="default">$MSIE</span><span class="keyword">)<br />
{<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"name"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()+</span><span class="default">20000</span><span class="keyword">);<br />
}<br />
else<br />
{<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"name"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()-</span><span class="default">20000</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="string">".domain.com" </span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72456""></a>
  <div class="note">
   <strong class="user">ahmetantmen at msn dot com</strong>
   <a href="#72456" class="date">19-Jan-2007 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can be sure about the cookie files contents weren't changed.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$Seperator </span><span class="keyword">= </span><span class="string">'--'</span><span class="keyword">;<br />
</span><span class="default">$uniqueID </span><span class="keyword">= </span><span class="string">'Ju?hG&amp;F0yh9?=/6*GVfd-d8u6f86hp'</span><span class="keyword">;<br />
</span><span class="default">$Data </span><span class="keyword">= </span><span class="string">'Ahmet '</span><span class="keyword">.</span><span class="default">md5</span><span class="keyword">(</span><span class="string">'123456789'</span><span class="keyword">);<br />
<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'VerifyUser'</span><span class="keyword">, </span><span class="default">$Data</span><span class="keyword">.</span><span class="default">$Seperator</span><span class="keyword">.</span><span class="default">md5</span><span class="keyword">(</span><span class="default">$Data</span><span class="keyword">.</span><span class="default">$uniqueID</span><span class="keyword">));<br />
<br />
if (</span><span class="default">$_COOKIE</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$Cut </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$Seperator</span><span class="keyword">, </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'VerifyUser'</span><span class="keyword">]);<br />
&nbsp;&nbsp; if (</span><span class="default">md5</span><span class="keyword">(</span><span class="default">$Cut</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">].</span><span class="default">$uniqueID</span><span class="keyword">) === </span><span class="default">$Cut</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'VerifyUser'</span><span class="keyword">] = </span><span class="default">$Cut</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; die(</span><span class="string">'Cookie data is invalid!!!'</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
}<br />
<br />
echo </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'VerifyUser'</span><span class="keyword">];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Create a unique id for your site and create a hash with md5($Data.$uniqueID). Attacker can understant that it must be re-hash after change cookie content.<br />
But doesn't. Because cannot guess your unique id. Seperate your hash and data with seperator and send that cookie. Control that hash of returned value and your unique id's is same returned hash. Otherwise you have to stop attack. Sorry for my poor english!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72313""></a>
  <div class="note">
   <strong class="user">stovenator at gmail dot com</strong>
   <a href="#72313" class="date">12-Jan-2007 06:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having issues with IE7 and setcookie(), be sure to verify that the cookie is set via http for http sites, and https for https site. <br />
<br />
Also, if the time is incorrect on your server, IE7 will also disallow those cookies from being set.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72180""></a>
  <div class="note">
   
   <a href="#72180" class="date">05-Jan-2007 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you ever find yourself in a situation where you need to overwrite a non-PHP application's session cookie, you can do that with the following line:<br />
<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">"Set-Cookie: SIDNAME=</span><span class="default">$overwrite</span><span class="string">; path=/; secure"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
I couldn't get setcookie() to do this for all major web browsers, but manually sending the header did the trick. Note: Remove secure if you aren't mandating SSL connections.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72062""></a>
  <div class="note">
   <strong class="user">felixcca at yahoo dot ca</strong>
   <a href="#72062" class="date">31-Dec-2006 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found out recently that assigning FALSE to a cookie will destroy it.<br />
<br />
I thought it might interest some of you.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71743""></a>
  <div class="note">
   <strong class="user">kurtubba at gmail dot com</strong>
   <a href="#71743" class="date">13-Dec-2006 05:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When setting a top level domain ex ".mydomain.com" you must add the secure arg so it should look like<br />
<br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="string">"TestCookie"</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()+</span><span class="default">3600</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="string">".example.com"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
<br />
ignoring the secure arg makes IE ignores the cookie<br />
to get the top level domain use<br />
<br />
<span class="default">&lt;?php<br />
$myDomain </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">'^[^\.]*\.([^\.]*)\.(.*)$'</span><span class="keyword">, </span><span class="string">'\1.\2'</span><span class="keyword">,</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">]);<br />
</span><span class="default">?&gt;<br />
</span><br />
<br />
to avoid localhost switch use<br />
<br />
<span class="default">&lt;?php<br />
$phpCkDmn </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">] != </span><span class="string">"localhost" </span><span class="keyword">? </span><span class="default">$myDomain </span><span class="keyword">: </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71591""></a>
  <div class="note">
   <strong class="user">paul nospam AT nospam sitepoint dot com</strong>
   <a href="#71591" class="date">06-Dec-2006 08:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note when setting "array cookies" that a separate cookie is set for each element of the array.<br />
<br />
On high traffic sites, this can substantially increase the size of subsequent HTTP requests from clients (including requests for static content on the same domain).<br />
<br />
More importantly though, the cookie specification says that browsers need only accept 20 cookies per domain.&nbsp; This limit is increased to 50 by Firefox, and to 30 by Opera, but IE6 and IE7 enforce the limit of 20 cookie per domain.&nbsp; Any cookies beyond this limit will either knock out an older cookie or be ignored/rejected by the browser.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70959""></a>
  <div class="note">
   <strong class="user">hansel at gretel dot com</strong>
   <a href="#70959" class="date">06-Nov-2006 08:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following code snippet combines abdullah's and Charles Martin's examples into a powerful combination function (and fixes at least one bug in the process):<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">function </span><span class="default">set_cookie_fix_domain</span><span class="keyword">(</span><span class="default">$Name</span><span class="keyword">, </span><span class="default">$Value </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$Expires </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$Path </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$Domain </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$Secure </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$HTTPOnly </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if (!empty(</span><span class="default">$Domain</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Fix the domain to accept domains with and without 'www.'.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">)) == </span><span class="string">'www.'</span><span class="keyword">)&nbsp; </span><span class="default">$Domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Domain</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$Domain </span><span class="keyword">= </span><span class="string">'.' </span><span class="keyword">. </span><span class="default">$Domain</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Remove port information.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$Port </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$Domain</span><span class="keyword">, </span><span class="string">':'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$Port </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">)&nbsp; </span><span class="default">$Domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$Port</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Set-Cookie: ' </span><span class="keyword">. </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$Name</span><span class="keyword">) . </span><span class="string">'=' </span><span class="keyword">. </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$Value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (empty(</span><span class="default">$Expires</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; expires=' </span><span class="keyword">. </span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">'D, d-M-Y H:i:s'</span><span class="keyword">, </span><span class="default">$Expires</span><span class="keyword">) . </span><span class="string">' GMT'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (empty(</span><span class="default">$Path</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; path=' </span><span class="keyword">. </span><span class="default">$Path</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (empty(</span><span class="default">$Domain</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; domain=' </span><span class="keyword">. </span><span class="default">$Domain</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (!</span><span class="default">$Secure </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; secure'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (!</span><span class="default">$HTTPOnly </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; HttpOnly'</span><span class="keyword">), </span><span class="default">false</span><span class="keyword">);<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Basically, if the domain parameter is supplied, it is converted to support a broader range of domains.&nbsp; This behavior may or may not be desireable (e.g. could be a security problem depending on the server) but it makes cookie handling oh-so-much-nicer (IMO).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68666""></a>
  <div class="note">
   <strong class="user">adruff at gmail dot com</strong>
   <a href="#68666" class="date">05-Aug-2006 10:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you intend to use persistent cookies (vice session cookies that are deleted when the browser is closed) be aware:<br />
1) Firefox appears to require that you include all paramaters, or it will ignore the expiration and treat the cookie as a session cookie<br />
2) My version of firefox (1.5.0.6) defaults to 'keep cookies until i close firefox' , which essentially makes every cookie a session cookie. This of course sucks for devs, but i suppose is supposed to be a security feature for the end user. If the user wants to configure firefox to respect the expiration date and retain cookies beyond the session, the user must change it to 'keep cookies until they expire'.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="67191""></a>
  <div class="note">
   <strong class="user">gareth at gw126 dot com</strong>
   <a href="#67191" class="date">05-Jun-2006 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can use cookies to prevent a browser refresh repeating some action from a form post... (providing the client is cookie enabled!)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//Flag up repeat actions (like credit card transaction, etc)<br />
</span><span class="keyword">if(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lastpost</span><span class="keyword">= isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'lastpost'</span><span class="keyword">]) ? </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'lastpost'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$lastpost</span><span class="keyword">!=</span><span class="default">md5</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'lastpost'</span><span class="keyword">, </span><span class="default">md5</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">)));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'_REPEATED'</span><span class="keyword">]=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'_REPEATED'</span><span class="keyword">]=</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">//At this point, if $_POST['_REPEATED']==1, then&nbsp; the user<br />
//has hit the refresh button; so don't do any actions that you don't<br />
//want to repeat!<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope that helps :)<br />
<br />
Gareth</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55380""></a>
  <div class="note">
   <strong class="user">simon at ruderich dot com</strong>
   <a href="#55380" class="date">01-Aug-2005 02:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to delete a session cookie, you can do it with this code:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; session_start</span><span class="keyword">();<br />
<br />
&nbsp; </span><span class="comment">// many code<br />
<br />
&nbsp; </span><span class="default">$sessionName </span><span class="keyword">= </span><span class="default">session_name</span><span class="keyword">();<br />
&nbsp; </span><span class="default">$sessionCookie </span><span class="keyword">= </span><span class="default">session_get_cookie_params</span><span class="keyword">();<br />
<br />
&nbsp; </span><span class="default">session_destroy</span><span class="keyword">();<br />
<br />
&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$sessionName</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$sessionCookie</span><span class="keyword">[</span><span class="string">'lifetime'</span><span class="keyword">], </span><span class="default">$sessionCookie</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">], </span><span class="default">$sessionCookie</span><span class="keyword">[</span><span class="string">'domain'</span><span class="keyword">], </span><span class="default">$sessionCookie</span><span class="keyword">[</span><span class="string">'secure'</span><span class="keyword">]);<br />
&nbsp;</span><span class="default">?&gt;<br />
</span><br />
This works also well if the session cookie params or the session name were changed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52648""></a>
  <div class="note">
   <strong class="user">terry at scribendi dot com</strong>
   <a href="#52648" class="date">08-May-2005 07:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A few comments have suggested using serialize() to set object or array data into a cookie.&nbsp; There are a couple of reasons to be carefull with that technique:<br />
<br />
Security: If the cookie is human readable, then it is also fairly easy for end users to play around with it.&nbsp; Wrapping your cookie setting and getting in an encryption routine will prevent tampering, and make sure that your cookies don't make any sense to any client-side exploits or other sites they get sent to thanks to browser bugs.<br />
<br />
Bulk: If you serialize even a fairly simple class, then you get a lot of data.&nbsp; Large cookies will make browser requests fat and slow, and some browsers have a limit on cookie size, so think about what data you really need to persist, and create __sleep() and __wakeup() methods to package the data into the shortest possible form.&nbsp; You can get better and faster results when you write your own __sleep() and __wakup() to implode() or pack() your data, than by using zlib compress() on the serialized object.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51705""></a>
  <div class="note">
   <strong class="user">Carl V</strong>
   <a href="#51705" class="date">07-Apr-2005 08:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to delete all the cookies set by your domain, you may run the following:<br />
<br />
<span class="default">&lt;?php<br />
$cookiesSet </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$_COOKIE</span><span class="keyword">);<br />
for (</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$cookiesSet</span><span class="keyword">);</span><span class="default">$x</span><span class="keyword">++) </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$cookiesSet</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">],</span><span class="string">""</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()-</span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Very useful when doing logout scripts and the cookie name may have changed (long story).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50957""></a>
  <div class="note">
   <strong class="user">Alchaemist</strong>
   <a href="#50957" class="date">14-Mar-2005 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
setcookie + header Location + IIS 5 = Trouble<br />
<br />
It took me a long time to figure out what was causing a missing cookie in one system while it worked perfectly in another...<br />
<br />
See this one: <a href="http://support.microsoft.com/kb/q176113/" rel="nofollow" target="_blank">http://support.microsoft.com/kb/q176113/</a><br />
<br />
In short, this WILL NEVER WORK IN IIS 5:<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">"Pragma: no-cache"</span><span class="keyword">);<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Location: <a href="http://www.example.com/" rel="nofollow" target="_blank">http://www.example.com/</a>'</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'AA'</span><span class="keyword">,</span><span class="string">'1'</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'BB'</span><span class="keyword">,</span><span class="string">'2'</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">() + </span><span class="default">24 </span><span class="keyword">* </span><span class="default">3600</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
You will ONLY get the Location Header, everything else will be "cut out" by IIS 5 CGI implementation.<br />
<br />
Solutions:<br />
1- Migrate to Apache/IIS6/Whatever<br />
2- Use a Non Parsed Header Script (nph-*.php)<br />
3- Try with header('Refresh: 0; $URL');<br />
<br />
I hope this helps somebody not to spend hours knocking his/her head.<br />
<br />
Alchaemist</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37732""></a>
  <div class="note">
   <strong class="user">apex at xepa dot nl</strong>
   <a href="#37732" class="date">24-Nov-2003 06:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note on setting cookies allowing access to sites:<br />
<br />
If you are not using something "personal" from the computer that you are sending the cookie too watch out.&nbsp; Via javascript it is possible to steal cookies from other users.&nbsp; Thus allowing the stealer to login to your site as another user that might not have access otherwise.&nbsp; Try to add something like the user's ip in the cookie and allowing access from that ip only with the stored cookie data.<br />
<br />
[Editor's note: ... or simply use sessions. You can't be sure that the visitor will use the same IP the next visit. Not even on the next request (thanks to proxy servers)]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36202""></a>
  <div class="note">
   <strong class="user">Jrg Aldinger</strong>
   <a href="#36202" class="date">30-Sep-2003 04:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using your cookies on a webserver that is not on the standard port 80, you should NOT include the :[port] in the "Cookie domain" parameter, since this would not be recognized correctly.<br />
I had the issue working on a project that runs on multiple servers (development, production, etc.). One of the servers is running on a different port (together with other websites that run on the same server but on different ports).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35647""></a>
  <div class="note">
   <strong class="user">dave at fubra dot com</strong>
   <a href="#35647" class="date">09-Sep-2003 12:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There are several characters that dont work correctly if part of the cookie name, I in particular ran into problems using = as part of the cookie name ie/<br />
<br />
<span class="default">&lt;?php setcookie</span><span class="keyword">(</span><span class="string">'dE4fR='</span><span class="keyword">, </span><span class="default">$foo</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
this was as a result of base64_encode() ing a variable to use as the name. The cookie was being set fine but the = is stored as a little square character in the cookie which prevent proper retreival.<br />
<br />
The solution for me was to use md5() instead of base64_encode() but any other method which avoids the = sign should also solve the problem</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31170""></a>
  <div class="note">
   <strong class="user">soreman at abv dot bg</strong>
   <a href="#31170" class="date">11-Apr-2003 03:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you experience problems on Microsoft Information Server (IIS) when setting a cookie via PHP and when PHP is running as a CGI binary it is not setting the cookie. After spending many hours on what the problem is here is what happens:<br />
<br />
When you invoke setcookie and redirect to another page you will not have your cookie set, because it seems that IIS doesn't set the cookie unless you actually send some contents to the browser. Therefore if you want to set a cookie and then redirect to another page you will have to do the redirection via JavaScript and/or HTML if you want your script to work on IIS.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27819""></a>
  <div class="note">
   <strong class="user">mleer at sp dot nl</strong>
   <a href="#27819" class="date">19-Dec-2002 02:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
P3P is a good idea. But.<br />
IE 6 features an inadequate definition of third party cookies.<br />
If your site is hosted on server A and your PHP stuff is coming in a framesetting from server B your setcookie-attempts will be blocked when default privacy settings are deployed. Your secondparty-cookie will be regarded as a thirdparty-cookie.<br />
<br />
So what you do is not read the P3P-Internet Explorer 6-manual at MS but send a header like<br />
<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">'P3P: CP="NOI ADM DEV PSAi COM NAV OUR OTRo STP IND DEM"'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
before doing the setcookie-thing. This will enable your cookie to survive any IE-6 privacy settings.<br />
<br />
You won't do this if you're working for some doubleclick institution, because if you do, you... you...well... you are not a very nice person!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="17361""></a>
  <div class="note">
   <strong class="user">robert at ourwebhome dot com</strong>
   <a href="#17361" class="date">05-Dec-2001 03:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Internet Exploer 6 now requires sites that set cookies to have P3P policies.<br />
<br />
From the Microsoft page:<br />
"Internet Explorer 6 implements advanced cookie filtering that is based on the Platform for Privacy Preferences (P3P) specification. By default, Internet Explorer 6 blocks third-party cookies that do not have a compact policy (a condensed computer-readable privacy statement) or third-party cookies that have a compact policy which specifies that personally identifiable information is used without your implicit consent. First-party cookies that have a compact policy which specifies that personally identifiable information is used without implicit consent are downgraded (deleted when you close Internet Explorer). First-party cookies that do not have a compact policy are leashed (restricted so that they can only be read in the first-party context)."<br />
<br />
See:<br />
<a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q260971&amp;GSSNB=1" rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx?scid=kb;EN-US;q260971&amp;GSSNB=1</a><br />
<br />
For more about P3P:<br />
<a href="http://www.w3.org/P3P/" rel="nofollow" target="_blank">http://www.w3.org/P3P/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.pfsockopen.html">pfsockopen</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.setrawcookie.html">setrawcookie</a></div>
 <div class="up"><a href="ref.network.html">Network Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

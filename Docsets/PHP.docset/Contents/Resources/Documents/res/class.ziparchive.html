<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>The ZipArchive class</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="zip.examples.html">Examples</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="ziparchive.addemptydir.html">ZipArchive::addEmptyDir</a></div>
 <div class="up"><a href="book.zip.html">Zip</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="class.ziparchive" class="reference">
 <h1 class="title">The <a href="class.ziparchive.html" class="classname">ZipArchive</a> class</h1>
 
 
 <div class="partintro"><p class="verinfo">(No version information available, might only be in SVN)</p>
 

  <div class="section" id="ziparchive.intro">
   <h2 class="title">Introduction</h2>
   <p class="para">
    A file archive, compressed with Zip.
   </p>
  </div>

 
  <div class="section" id="ziparchive.synopsis">
   <h2 class="title">Class synopsis</h2>


   <div class="classsynopsis">
    <div class="ooclass"></div>


    <div class="classsynopsisinfo">
     <span class="ooclass">
      <b class="classname">ZipArchive</b>
     </span>
     {</div>

    <div class="classsynopsisinfo classsynopsisinfo_comment">/* Properties */</div>

    
    <div class="classsynopsisinfo classsynopsisinfo_comment">/* Methods */</div>
    <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><a href="ziparchive.addemptydir.html" class="methodname">addEmptyDir</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$dirname</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><a href="ziparchive.addfile.html" class="methodname">addFile</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$filename</tt></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$localname</tt><span class="initializer"> = <b><tt>NULL</tt></b></span></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$start</tt><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$length</tt><span class="initializer"> = 0</span></span>
  ]]] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><a href="ziparchive.addfromstring.html" class="methodname">addFromString</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$localname</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$contents</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><a href="ziparchive.close.html" class="methodname">close</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><a href="ziparchive.deleteindex.html" class="methodname">deleteIndex</a></span>
    ( <span class="methodparam"><span class="type">int</span> <tt class="parameter">$index</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><a href="ziparchive.deletename.html" class="methodname">deleteName</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$name</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><a href="ziparchive.extractto.html" class="methodname">extractTo</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$destination</tt></span>
   [, <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <tt class="parameter">$entries</tt></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><a href="ziparchive.getarchivecomment.html" class="methodname">getArchiveComment</a></span>
    ([ <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><a href="ziparchive.getcommentindex.html" class="methodname">getCommentIndex</a></span>
    ( <span class="methodparam"><span class="type">int</span> <tt class="parameter">$index</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><a href="ziparchive.getcommentname.html" class="methodname">getCommentName</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$name</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.getfromindex.html" class="methodname">getFromIndex</a></span>
    ( <span class="methodparam"><span class="type">int</span> <tt class="parameter">$index</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$length</tt><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ]] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.getfromname.html" class="methodname">getFromName</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$name</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$length</tt><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ]] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><a href="ziparchive.getnameindex.html" class="methodname">getNameIndex</a></span>
    ( <span class="methodparam"><span class="type">int</span> <tt class="parameter">$index</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><a href="ziparchive.getstatusstring.html" class="methodname">getStatusString</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><a href="ziparchive.getstream.html" class="methodname">getStream</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$name</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.locatename.html" class="methodname">locateName</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$name</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.open.html" class="methodname">open</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$filename</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><a href="ziparchive.renameindex.html" class="methodname">renameIndex</a></span>
    ( <span class="methodparam"><span class="type">int</span> <tt class="parameter">$index</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$newname</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><a href="ziparchive.renamename.html" class="methodname">renameName</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$name</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$newname</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.setarchivecomment.html" class="methodname">setArchiveComment</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$comment</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.setcommentindex.html" class="methodname">setCommentIndex</a></span>
    ( <span class="methodparam"><span class="type">int</span> <tt class="parameter">$index</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$comment</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.setcommentname.html" class="methodname">setCommentName</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$name</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$comment</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.statindex.html" class="methodname">statIndex</a></span>
    ( <span class="methodparam"><span class="type">int</span> <tt class="parameter">$index</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.statname.html" class="methodname">statName</a></span>
    ( <span class="methodparam"><span class="type"><span class="type name">name</span></span> <tt class="parameter">$name</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.unchangeall.html" class="methodname">unchangeAll</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.unchangearchive.html" class="methodname">unchangeArchive</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.unchangeindex.html" class="methodname">unchangeIndex</a></span>
    ( <span class="methodparam"><span class="type">int</span> <tt class="parameter">$index</tt></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="type">mixed</span> <span class="methodname"><a href="ziparchive.unchangename.html" class="methodname">unchangeName</a></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$name</tt></span>
   )</div>

    
   }</div>


  </div>


  <div class="section" id="ziparchive.props">
   <h2 class="title">Properties</h2>
   <dl>

    <dt id="ziparchive.props.status">
     <span class="term"><var class="varname"><var class="varname">status</var></var></span>
     <dd>

      <p class="para">Status of the Zip Archive</p>
     </dd>

    </dt>

    <dt id="ziparchive.props.statussys">
     <span class="term"><var class="varname"><var class="varname">statusSys</var></var></span>
     <dd>

      <p class="para">System status of the Zip Archive</p>
     </dd>

    </dt>

    <dt id="ziparchive.props.numfiles">
     <span class="term"><var class="varname"><var class="varname">numFiles</var></var></span>
     <dd>

      <p class="para">Number of files in archive</p>
     </dd>

    </dt>

    <dt id="ziparchive.props.filename">
     <span class="term"><var class="varname"><var class="varname">filename</var></var></span>
     <dd>

      <p class="para">File name in the file system</p>
     </dd>

    </dt>

    <dt id="ziparchive.props.comment">
     <span class="term"><var class="varname"><var class="varname">comment</var></var></span>
     <dd>

      <p class="para">Comment for the archive</p>
     </dd>

    </dt>

   </dl>

  </div>

 </div>


 










































































































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="ziparchive.addemptydir.html">ZipArchive::addEmptyDir</a> â€” Add a new directory</li><li><a href="ziparchive.addfile.html">ZipArchive::addFile</a> â€” Adds a file to a ZIP archive from the given path</li><li><a href="ziparchive.addfromstring.html">ZipArchive::addFromString</a> â€” Add a file to a ZIP archive using its contents</li><li><a href="ziparchive.close.html">ZipArchive::close</a> â€” Close the active archive (opened or newly created)</li><li><a href="ziparchive.deleteindex.html">ZipArchive::deleteIndex</a> â€” delete an entry in the archive using its index</li><li><a href="ziparchive.deletename.html">ZipArchive::deleteName</a> â€” delete an entry in the archive using its name</li><li><a href="ziparchive.extractto.html">ZipArchive::extractTo</a> â€” Extract the archive contents</li><li><a href="ziparchive.getarchivecomment.html">ZipArchive::getArchiveComment</a> â€” Returns the Zip archive comment</li><li><a href="ziparchive.getcommentindex.html">ZipArchive::getCommentIndex</a> â€” Returns the comment of an entry using the entry index</li><li><a href="ziparchive.getcommentname.html">ZipArchive::getCommentName</a> â€” Returns the comment of an entry using the entry name</li><li><a href="ziparchive.getfromindex.html">ZipArchive::getFromIndex</a> â€” Returns the entry contents using its index</li><li><a href="ziparchive.getfromname.html">ZipArchive::getFromName</a> â€” Returns the entry contents using its name</li><li><a href="ziparchive.getnameindex.html">ZipArchive::getNameIndex</a> â€” Returns the name of an entry using its index</li><li><a href="ziparchive.getstatusstring.html">ZipArchive::getStatusString</a> â€” Returns the status error message, system and/or zip messages</li><li><a href="ziparchive.getstream.html">ZipArchive::getStream</a> â€” Get a file handler to the entry defined by its name (read only).</li><li><a href="ziparchive.locatename.html">ZipArchive::locateName</a> â€” Returns the index of the entry in the archive</li><li><a href="ziparchive.open.html">ZipArchive::open</a> â€” Open a ZIP file archive</li><li><a href="ziparchive.renameindex.html">ZipArchive::renameIndex</a> â€” Renames an entry defined by its index</li><li><a href="ziparchive.renamename.html">ZipArchive::renameName</a> â€” Renames an entry defined by its name</li><li><a href="ziparchive.setarchivecomment.html">ZipArchive::setArchiveComment</a> â€” Set the comment of a ZIP archive</li><li><a href="ziparchive.setcommentindex.html">ZipArchive::setCommentIndex</a> â€” Set the comment of an entry defined by its index</li><li><a href="ziparchive.setcommentname.html">ZipArchive::setCommentName</a> â€” Set the comment of an entry defined by its name</li><li><a href="ziparchive.statindex.html">ZipArchive::statIndex</a> â€” Get the details of an entry defined by its index.</li><li><a href="ziparchive.statname.html">ZipArchive::statName</a> â€” Get the details of an entry defined by its name.</li><li><a href="ziparchive.unchangeall.html">ZipArchive::unchangeAll</a> â€” Undo all changes done in the archive</li><li><a href="ziparchive.unchangearchive.html">ZipArchive::unchangeArchive</a> â€” Revert all global changes done in the archive.</li><li><a href="ziparchive.unchangeindex.html">ZipArchive::unchangeIndex</a> â€” Revert all changes done to an entry at the given index</li><li><a href="ziparchive.unchangename.html">ZipArchive::unchangeName</a> â€” Revert all changes done to an entry with the given name.</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="106062""></a>
  <div class="note">
   <strong class="user">webmaster at sebastiangrinke dot info</strong>
   <a href="#106062" class="date">06-Oct-2011 01:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a simple function which zips folders with all sub folders or only a simple file... the $data var can be a string or an array...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">public function </span><span class="default">un_zip</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">,</span><span class="default">$arcpf</span><span class="keyword">,</span><span class="default">$mode</span><span class="keyword">=</span><span class="string">'zip'</span><span class="keyword">,</span><span class="default">$obj</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absoluterpfad </span><span class="keyword">= </span><span class="string">'YOUR_BASE_PATH'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arcpf </span><span class="keyword">= </span><span class="default">$absoluterpfad</span><span class="keyword">.</span><span class="default">DS</span><span class="keyword">.</span><span class="default">$arcpf</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">)==</span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$archiv </span><span class="keyword">= new </span><span class="default">ZipArchive</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$archiv</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="default">$arcpf</span><span class="keyword">,</span><span class="default">ZipArchive</span><span class="keyword">::</span><span class="default">CREATE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{</span><span class="default">$archiv </span><span class="keyword">=&amp; </span><span class="default">$obj</span><span class="keyword">;}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$mode</span><span class="keyword">==</span><span class="string">'zip'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)==</span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$dtmp</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$archiv </span><span class="keyword">=&amp; </span><span class="default">un_zip</span><span class="keyword">(</span><span class="default">$dtmp</span><span class="keyword">,</span><span class="default">$arcpf</span><span class="keyword">,</span><span class="string">'zip'</span><span class="keyword">,&amp;</span><span class="default">$archiv</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)==</span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$archiv</span><span class="keyword">-&gt;</span><span class="default">addEmptyDir</span><span class="keyword">(</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$absoluterpfad</span><span class="keyword">.</span><span class="default">DS</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$data</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bad </span><span class="keyword">= array(</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">'..'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">array_diff</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">,</span><span class="default">$bad</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$files </span><span class="keyword">as </span><span class="default">$ftmp</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">.</span><span class="default">DS</span><span class="keyword">.</span><span class="default">$ftmp</span><span class="keyword">)==</span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$archiv</span><span class="keyword">-&gt;</span><span class="default">addEmptyDir</span><span class="keyword">(</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$absoluterpfad</span><span class="keyword">.</span><span class="default">DS</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$data</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$ftmp</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$archiv </span><span class="keyword">=&amp; </span><span class="default">un_zip</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">.</span><span class="default">DS</span><span class="keyword">.</span><span class="default">$ftmp</span><span class="keyword">,</span><span class="default">$arcpf</span><span class="keyword">,</span><span class="string">'zip'</span><span class="keyword">,&amp;</span><span class="default">$archiv</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }elseif(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">.</span><span class="default">DS</span><span class="keyword">.</span><span class="default">$ftmp</span><span class="keyword">)==</span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$archiv</span><span class="keyword">-&gt;</span><span class="default">addFile</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">.</span><span class="default">DS</span><span class="keyword">.</span><span class="default">$ftmp</span><span class="keyword">,</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$absoluterpfad</span><span class="keyword">.</span><span class="default">DS</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$data</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$ftmp</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }elseif(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)==</span><span class="default">true</span><span class="keyword">){</span><span class="default">$archiv</span><span class="keyword">-&gt;</span><span class="default">addFile</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">,</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$absoluterpfad</span><span class="keyword">.</span><span class="default">DS</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$data</span><span class="keyword">));}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">)==</span><span class="default">false</span><span class="keyword">){</span><span class="default">$archiv</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{return </span><span class="default">$archiv</span><span class="keyword">;}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$mode</span><span class="keyword">==</span><span class="string">'unzip'</span><span class="keyword">){</span><span class="default">$archiv</span><span class="keyword">-&gt;</span><span class="default">extractTo</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);}<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105312""></a>
  <div class="note">
   <strong class="user">Jerry dot Saravia at emc dot com</strong>
   <a href="#105312" class="date">08-Aug-2011 01:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following code can be used to get a list of all the file names in a zip file.<br />
<br />
<span class="default">&lt;?php<br />
$za </span><span class="keyword">= new </span><span class="default">ZipArchive</span><span class="keyword">();<br />
<br />
</span><span class="default">$za</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">'theZip.zip'</span><span class="keyword">);<br />
<br />
for( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$za</span><span class="keyword">-&gt;</span><span class="default">numFiles</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++ ){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$stat </span><span class="keyword">= </span><span class="default">$za</span><span class="keyword">-&gt;</span><span class="default">statIndex</span><span class="keyword">( </span><span class="default">$i </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">basename</span><span class="keyword">( </span><span class="default">$stat</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] ) . </span><span class="default">PHP_EOL </span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105126""></a>
  <div class="note">
   <strong class="user">anonymous at example dot net</strong>
   <a href="#105126" class="date">28-Jul-2011 11:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
status - libzip error code (ER_*)<br />
statusSys - copy of errno (E*) or zlib error code<br />
<br />
ER_OK&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; N No error<br />
ER_MULTIDISK&nbsp; &nbsp; N Multi-disk zip archives not supported<br />
ER_RENAME&nbsp; &nbsp; &nbsp;&nbsp; S Renaming temporary file failed<br />
ER_CLOSE&nbsp; &nbsp; &nbsp; &nbsp; S Closing zip archive failed<br />
ER_SEEK&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; S Seek error<br />
ER_READ&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; S Read error<br />
ER_WRITE&nbsp; &nbsp; &nbsp; &nbsp; S Write error<br />
ER_CRC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; N CRC error<br />
ER_ZIPCLOSED&nbsp; &nbsp; N Containing zip archive was closed<br />
ER_NOENT&nbsp; &nbsp; &nbsp; &nbsp; N No such file<br />
ER_EXISTS&nbsp; &nbsp; &nbsp;&nbsp; N File already exists<br />
ER_OPEN&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; S Can't open file<br />
ER_TMPOPEN&nbsp; &nbsp; &nbsp; S Failure to create temporary file<br />
ER_ZLIB&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Z Zlib error<br />
ER_MEMORY&nbsp; &nbsp; &nbsp;&nbsp; N Malloc failure<br />
ER_CHANGED&nbsp; &nbsp; &nbsp; N Entry has been changed<br />
ER_COMPNOTSUPP&nbsp; N Compression method not supported<br />
ER_EOF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; N Premature EOF<br />
ER_INVAL&nbsp; &nbsp; &nbsp; &nbsp; N Invalid argument<br />
ER_NOZIP&nbsp; &nbsp; &nbsp; &nbsp; N Not a zip archive<br />
ER_INTERNAL&nbsp; &nbsp;&nbsp; N Internal error<br />
ER_INCONS&nbsp; &nbsp; &nbsp;&nbsp; N Zip archive inconsistent<br />
ER_REMOVE&nbsp; &nbsp; &nbsp;&nbsp; S Can't remove file<br />
ER_DELETED&nbsp; &nbsp; &nbsp; N Entry has been deleted</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100268""></a>
  <div class="note">
   <strong class="user">h-fate at gmx dot net</strong>
   <a href="#100268" class="date">05-Oct-2010 04:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be wary that there are several algorithms to generate a zip file. I found that Office OpenXML files created with ZipArchive are not recognized by Excel 2007, for example.<br />
<br />
You have to use a different class to zip in this case, such as PclZip.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98441""></a>
  <div class="note">
   <strong class="user">hardcorevenom at gmx dot com</strong>
   <a href="#98441" class="date">15-Jun-2010 03:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Read a file from an archive to a variable.<br />
A warning is printed automatically in case of a CRC32 mismatch, which we capture, so we can print our own error message.<br />
<br />
<span class="default">&lt;?php<br />
$zip </span><span class="keyword">= new </span><span class="default">ZipArchive</span><span class="keyword">();<br />
if (</span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">'archive.zip'</span><span class="keyword">)) {<br />
&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">getStream</span><span class="keyword">(</span><span class="string">'myfile.txt'</span><span class="keyword">); </span><span class="comment">//file inside archive<br />
&nbsp; </span><span class="keyword">if(!</span><span class="default">$fp</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; die(</span><span class="string">"Error: can't get stream to zipped file"</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$stat </span><span class="keyword">= </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">statName</span><span class="keyword">(</span><span class="string">'myfile.txt'</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">$buf </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">; </span><span class="comment">//file buffer<br />
&nbsp; </span><span class="default">ob_start</span><span class="keyword">(); </span><span class="comment">//to capture CRC error message<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$buf </span><span class="keyword">.= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">2048</span><span class="keyword">); </span><span class="comment">//reading more than 2156 bytes seems to disable internal CRC32 verification (bug?)<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">ob_get_contents</span><span class="keyword">();<br />
&nbsp; </span><span class="default">ob_end_clean</span><span class="keyword">();<br />
&nbsp; if(</span><span class="default">stripos</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">, </span><span class="string">"CRC error"</span><span class="keyword">) != </span><span class="default">FALSE</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'CRC32 mismatch, current '</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"%08X"</span><span class="keyword">, </span><span class="default">crc32</span><span class="keyword">(</span><span class="default">$buf</span><span class="keyword">)); </span><span class="comment">//current CRC<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">', expected '</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"%08X"</span><span class="keyword">, </span><span class="default">$stat</span><span class="keyword">[</span><span class="string">'crc'</span><span class="keyword">]); </span><span class="comment">//expected CRC<br />
&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
&nbsp; </span><span class="comment">//Done, unpacked file is stored in $buf<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
To create a corrupt file, change a byte in a zip file using a hex editor.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="zip.examples.html">Examples</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="ziparchive.addemptydir.html">ZipArchive::addEmptyDir</a></div>
 <div class="up"><a href="book.zip.html">Zip</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

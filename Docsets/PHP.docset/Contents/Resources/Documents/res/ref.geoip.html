<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>GeoIP Functions</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="geoip.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.geoip-continent-code-by-name.html">geoip_continent_code_by_name</a></div>
 <div class="up"><a href="book.geoip.html">GeoIP</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="ref.geoip" class="reference">
 <h1 class="title">GeoIP Functions</h1>
 


























































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.geoip-continent-code-by-name.html">geoip_continent_code_by_name</a> â€” Get the two letter continent code</li><li><a href="function.geoip-country-code-by-name.html">geoip_country_code_by_name</a> â€” Get the two letter country code</li><li><a href="function.geoip-country-code3-by-name.html">geoip_country_code3_by_name</a> â€” Get the three letter country code</li><li><a href="function.geoip-country-name-by-name.html">geoip_country_name_by_name</a> â€” Get the full country name</li><li><a href="function.geoip-database-info.html">geoip_database_info</a> â€” Get GeoIP Database information</li><li><a href="function.geoip-db-avail.html">geoip_db_avail</a> â€” Determine if GeoIP Database is available</li><li><a href="function.geoip-db-filename.html">geoip_db_filename</a> â€” Returns the filename of the corresponding GeoIP Database</li><li><a href="function.geoip-db-get-all-info.html">geoip_db_get_all_info</a> â€” Returns detailed information about all GeoIP database types</li><li><a href="function.geoip-id-by-name.html">geoip_id_by_name</a> â€” Get the Internet connection type</li><li><a href="function.geoip-isp-by-name.html">geoip_isp_by_name</a> â€” Get the Internet Service Provider (ISP) name</li><li><a href="function.geoip-org-by-name.html">geoip_org_by_name</a> â€” Get the organization name</li><li><a href="function.geoip-record-by-name.html">geoip_record_by_name</a> â€” Returns the detailed City information found in the GeoIP Database</li><li><a href="function.geoip-region-by-name.html">geoip_region_by_name</a> â€” Get the country code and region</li><li><a href="function.geoip-region-name-by-code.html">geoip_region_name_by_code</a> â€” Returns the region name for some country and region code combo</li><li><a href="function.geoip-time-zone-by-country-and-region.html">geoip_time_zone_by_country_and_region</a> â€” Returns the time zone for some country and region code combo</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="104168""></a>
  <div class="note">
   <strong class="user">josh at innurve dot com dot au</strong>
   <a href="#104168" class="date">28-May-2011 08:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're having trouble making the GeoIP PHP functions recognise the location of your GeoIP database, the following block of code will show you all the directories in which the PHP functions are looking... so you'll need to shift your files around to suit it:<br />
<br />
<span class="default">&lt;?php<br />
print_r</span><span class="keyword">( </span><span class="default">geoip_db_get_all_info</span><span class="keyword">() );<br />
</span><span class="default">?&gt;<br />
</span><br />
and it'll output an array of 13 or so elements, looking something like this:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [available] =&gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [description] =&gt; GeoIP Country Edition<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [filename] =&gt; /usr/share/GeoIP/GeoIP.dat<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [available] =&gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [description] =&gt; GeoIP City Edition, Rev 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [filename] =&gt; /usr/share/GeoIP/GeoIPCity.dat<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [available] =&gt; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [description] =&gt; GeoIP Region Edition, Rev 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [filename] =&gt; /usr/share/GeoIP/GeoIPRegion.dat<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
.. and so on.<br />
<br />
"available" will be 1 when the GeoIP file has been found and loaded.<br />
<br />
NOTE: if you download the GeoLiteCity.dat.gz file from MaxMind, just decompress it and rename it to GeoIPCity.dat and use the GEOIP_CITY_EDITION_REV1 constant and it'll work fine in PHP.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103270""></a>
  <div class="note">
   <strong class="user">nospam dot guilhem at nospam dot answeb dot net</strong>
   <a href="#103270" class="date">05-Apr-2011 02:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello,<br />
<br />
While trying to update the GeoIP.dat file under debian, I've found out that automatic updates via the geoipupdate (in geoip-bin package) is not available for the free edition. Here is a one-liner script that will do it. You can put it in a crontab, it will download the .dat file only if it has change :<br />
<br />
cd /usr/share/GeoIP &amp;&amp; wget GEOIP_URL -N &amp;&amp; cat GeoIP.dat.gz | gzip -d &gt; GeoIP.dat<br />
<br />
Note : GEOIP_URL is to be found on the page <a href="http://www.maxmind.com/app/geoip_country, under the Binary Format section (The php note system won" rel="nofollow" target="_blank">http://www.maxmind.com/app/geoip_country, under the Binary Format section (The php note system won</a>'t allow me to put the full URL here<br />
<br />
Crontab line could be :<br />
<br />
@weekly cd /usr/share/GeoIP &amp;&amp; (..)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87855""></a>
  <div class="note">
   <strong class="user">nandox7 at myrealbox dot com</strong>
   <a href="#87855" class="date">26-Dec-2008 06:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The GeoLiteCity free db works and can resolve city names and other informations.<br />
<br />
Make sure the instructions are followed regarding it's installation.<br />
<br />
<a href="http://www.maxmind.com/app/installation?city=1" rel="nofollow" target="_blank">http://www.maxmind.com/app/installation?city=1</a><br />
<br />
At step 2 the decompress file must be moved and renamed.<br />
The files needs to be called GeoIPCity.dat if not the mod_geoip will not find it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82361""></a>
  <div class="note">
   <strong class="user">thomas {AT} thomasfischer {D0T} BIZ</strong>
   <a href="#82361" class="date">07-Apr-2008 05:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you can use this function to determine the continent of a country:<br />
<br />
function getContinentFromCountry($country)<br />
{<br />
&nbsp;$data = array ("AF"=&gt; "AS","AX"=&gt;"EU","AL"=&gt;"EU", "DZ"=&gt;"AF","AS"=&gt;"OC", "AD"=&gt;"EU","AO"=&gt; "AF" ........);<br />
&nbsp;return $data[$country];<br />
}<br />
<br />
unfortunately this comment's size is restricted, so you will have the rest by yourself<br />
<br />
for example:<br />
getContinentFromCountry("DE") will result in "EU"<br />
<br />
this data is based on <br />
wikipedia's<br />
List_of_countries_by_continent_(data_file)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81502""></a>
  <div class="note">
   <strong class="user">kapouer at melix dot org</strong>
   <a href="#81502" class="date">01-Mar-2008 07:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For Debian etch users : libgeoip is in version 1.4 so get the source from lenny (apt-get build-dep libgeoip;apt-get source libgeoip), compile it on etch (dpkg-buildpackage -rfakeroot in source folder) and install resulting libgeoip1 and libgeo-dev packages (dpkg -i)... Together with php5-dev this package is easy to install (phpize5;./configure --enable-geoip;make;make install)... Then check your install in php with :<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">geoip_database_info</span><span class="keyword">(</span><span class="default">GEOIP_COUNTRY_EDITION</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">geoip_country_code3_by_name</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">]);<br />
</span><span class="default">?&gt;<br />
</span><br />
please note free .dat is in /usr/share/GeoIP/GeoIP.dat<br />
Use geoip-bin package to schedule automatic updates (configure /etc/geoip.default.conf and copy to /etc/geoip.conf, then add a crontab to make the updates...)<br />
hope this helps</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75662""></a>
  <div class="note">
   <strong class="user">php dot comment dot addition at gmail dot com</strong>
   <a href="#75662" class="date">10-Jun-2007 08:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just to clarify the other comments, the maxmind post seems to be out of date / incorrect.&nbsp; <br />
<br />
This module fails to work (ie: resolve cities) with the GeoLite City database from here:<br />
<a href="http://www.maxmind.com/app/geolitecity" rel="nofollow" target="_blank">http://www.maxmind.com/app/geolitecity</a><br />
<br />
The error occurs when calling the function geoip_record_by_name(), which states incorrectly that the required database is not available.&nbsp; I have tested it with the very latest database, for which geoip_database_info() returns&nbsp; the version:<br />
GEO-533LITE 20070601 Build 1 Copyright (c) 2007 MaxMind LLC All Rights Reserved<br />
<br />
It does, however, resolve countries OK via the GeoLite Country database, which you can grab here: <a href="http://www.maxmind.com/app/geoip_country" rel="nofollow" target="_blank">http://www.maxmind.com/app/geoip_country</a><br />
I tested with the version:<br />
<br />
GEO-106FREE 20070601 Build 1 Copyright (c) 2007 MaxMind LLC All Rights Reserved</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73511""></a>
  <div class="note">
   <strong class="user">tjmather at maxmind dot com</strong>
   <a href="#73511" class="date">26-Feb-2007 08:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The geoip_country_*_by_name functions only work with GeoIP Country.&nbsp; The geoip_record_by_name function works with GeoIP City.&nbsp; geoip_region_by_name works with GeoIP Region.&nbsp; So the API should work with all of the GeoIP databases, as long as you call the correct function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72635""></a>
  <div class="note">
   
   <a href="#72635" class="date">26-Jan-2007 05:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I couldn't get it to work with the DMA code database (product ID 137).&nbsp; It seems to only work with the country database.&nbsp; The documentation should contain a warning that this code (as of 0.2.0) is incomplete and that Net_GeoIP should be used for non-country databases.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71223""></a>
  <div class="note">
   <strong class="user">judas dot iscariote at gmail dot com</strong>
   <a href="#71223" class="date">16-Nov-2006 07:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to use this extension in SUSE/openSUSE, it is available here:<br />
<br />
<a href="http://repos.opensuse.org/server:/php:/extensions/" rel="nofollow" target="_blank">http://repos.opensuse.org/server:/php:/extensions/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69631""></a>
  <div class="note">
   <strong class="user">Christian</strong>
   <a href="#69631" class="date">13-Sep-2006 05:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Both, Ubuntu and Debian itself make usage of version 1.3.x of the c libraries, so installation can't be done with the debian packages, because configure stops with:<br />
&nbsp;<br />
== configure: error: You need version 1.4.0 or higher of the C API ==<br />
<br />
so you must download it from maxmind.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69527""></a>
  <div class="note">
   <strong class="user">Matt</strong>
   <a href="#69527" class="date">08-Sep-2006 01:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are a Debian or Ubuntu user, instead of building it from source, you can: <br />
aptitude install libgeoip-dev libgeoip1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="geoip.constants.html">Predefined Constants</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.geoip-continent-code-by-name.html">geoip_continent_code_by_name</a></div>
 <div class="up"><a href="book.geoip.html">GeoIP</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Exceptions</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="language.namespaces.faq.html">FAQ: things you need to know about namespaces</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="language.exceptions.extending.html">Extending Exceptions</a></div>
 <div class="up"><a href="langref.html">Language Reference</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="language.exceptions" class="chapter">
  <h1>Exceptions</h1>
<h2>Table of Contents</h2><ul class="chunklist chunklist_chapter"><li><a href="language.exceptions.extending.html">Extending Exceptions</a></li></ul>


  <p class="para">
   PHP 5 has an exception model similar to that of other programming languages.
   An exception can be <i>throw</i>n, and caught
   (&quot;<i>catch</i>ed&quot;) within PHP. Code may be surrounded in a
   <i>try</i> block, to facilitate the catching of potential
   exceptions. Each <i>try</i> must have at least one
   corresponding <i>catch</i> block. Multiple
   <i>catch</i> blocks can be used to catch different classes of
   exceptions. Normal execution (when no exception is thrown within the
   <i>try</i> block, or when a <i>catch</i> matching
   the thrown exception&#039;s class is not present) will continue after that last catch
   block defined in sequence. Exceptions can be <i>throw</i>n (or
   re-thrown) within a <i>catch</i> block.
  </p>
  <p class="para">
   When an exception is thrown, code following the statement will not be
   executed, and PHP will attempt to find the first matching
   <i>catch</i> block. If an
   exception is not caught, a PHP Fatal Error will be issued with an
   &quot;<i>Uncaught Exception ...</i>&quot; message, unless a handler has
   been defined with <span class="function"><a href="function.set-exception-handler.html" class="function">set_exception_handler()</a></span>.
  </p>
  <p class="para">
   The thrown object must be an instance of the <a href="class.exception.html" class="classname">Exception</a>
   class or a subclass of <a href="class.exception.html" class="classname">Exception</a>. Trying to throw an
   object that is not will result in a PHP Fatal Error.
  </p>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    Internal PHP functions mainly use
    <a href="errorfunc.configuration.html#ini.error-reporting" class="link">Error reporting</a>, only modern
    <a href="language.oop5.html" class="link">Object oriented</a>
    extensions use exceptions. However, errors can be simply translated to
    exceptions with <a href="class.errorexception.html" class="link">ErrorException</a>.
   </p>
  </p></blockquote>
  <div class="tip"><b class="tip">Tip</b>
   <p class="para">
    The <a href="intro.spl.html" class="link">Standard PHP Library (SPL)</a> provides a
    good number of <a href="spl.exceptions.html" class="link">built-in exceptions</a>.
   </p>
  </div>
   <div class="example" id="example-255">
    <p><b>Example #1 Throwing an Exception</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">inverse</span><span style="color: #007700">(</span><span style="color: #0000BB">$x</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">$x</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #0000BB">Exception</span><span style="color: #007700">(</span><span style="color: #DD0000">'Division&nbsp;by&nbsp;zero.'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;return&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">/</span><span style="color: #0000BB">$x</span><span style="color: #007700">;<br />}<br /><br />try&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">inverse</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">inverse</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Caught&nbsp;exception:&nbsp;'</span><span style="color: #007700">,&nbsp;&nbsp;</span><span style="color: #0000BB">$e</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">(),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Continue&nbsp;execution<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'Hello&nbsp;World'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
0.2
Caught exception: Division by zero.
Hello World
</pre></div>
    </div>
   </div>
   <div class="example" id="example-256">
    <p><b>Example #2 Nested Exception</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">MyException&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Exception&nbsp;</span><span style="color: #007700">{&nbsp;}<br /><br />class&nbsp;</span><span style="color: #0000BB">Test&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">testing</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #0000BB">MyException</span><span style="color: #007700">(</span><span style="color: #DD0000">'foo!'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">MyException&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;rethrow&nbsp;it&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">throw&nbsp;</span><span style="color: #0000BB">$e</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$e</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$foo&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Test</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$foo</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">testing</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(4) &quot;foo!&quot;
</pre></div>
    </div>
   </div>
   
  

 </div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="106696""></a>
  <div class="note">
   <strong class="user">Sawsan</strong>
   <a href="#106696" class="date">28-Nov-2011 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
the following is an example of a re-thrown exception and the using of getPrevious function:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$name </span><span class="keyword">= </span><span class="string">"Name"</span><span class="keyword">;<br />
<br />
</span><span class="comment">//check if the name contains only letters, and does not contain the word name<br />
<br />
</span><span class="keyword">try<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; try<br />
&nbsp;&nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/[^a-z]/i'</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"</span><span class="default">$name</span><span class="string"> contains character other than a-z A-Z"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">), </span><span class="string">'name'</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"</span><span class="default">$name</span><span class="string"> contains the word name"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo </span><span class="string">"The Name is valid"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; catch(</span><span class="default">Exception $e</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"insert name again"</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; }<br />
&nbsp;<br />
catch (</span><span class="default">Exception $e</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; if (</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getPrevious</span><span class="keyword">())<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"The Previous Exception is: "</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getPrevious</span><span class="keyword">()-&gt;</span><span class="default">getMessage</span><span class="keyword">().</span><span class="string">"&lt;br/&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; echo </span><span class="string">"The Exception is: "</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">().</span><span class="string">"&lt;br/&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105102""></a>
  <div class="note">
   <strong class="user">alex dowgailenko [at] g mail . com</strong>
   <a href="#105102" class="date">27-Jul-2011 12:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use the set_error_handler() to throw exceptions of errors, you may encounter issues with __autoload() functionality saying that your class doesn't exist and that's it.<br />
<br />
If you do this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">MyException </span><span class="keyword">extends </span><span class="default">Exception<br />
</span><span class="keyword">{<br />
}<br />
<br />
class </span><span class="default">Tester<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">foobar</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; try<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">helloWorld</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } catch (</span><span class="default">MyException $e</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Problem in foobar'</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; protected function </span><span class="default">helloWorld</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">MyException</span><span class="keyword">(</span><span class="string">'Problem in helloWorld()'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$tester </span><span class="keyword">= new </span><span class="default">Tester</span><span class="keyword">;<br />
try<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tester</span><span class="keyword">-&gt;</span><span class="default">foobar</span><span class="keyword">();<br />
} catch (</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getTraceAsString</span><span class="keyword">();<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
The trace will only show $tester-&gt;foobar() and not the call made to $tester-&gt;helloWorld().<br />
<br />
In other words, if you pass a previous exception to a new one, the previous exception's stack trace is taken into account in the new exception.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104791""></a>
  <div class="note">
   <strong class="user">contact at xpertmailer dot com</strong>
   <a href="#104791" class="date">07-Jul-2011 06:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To continue the execution code after throw new Exception, goto operator can be used, like this:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">try {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'one'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'-error-'</span><span class="keyword">); </span><span class="default">a</span><span class="keyword">:<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'two'</span><span class="keyword">;<br />
} catch (</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; goto </span><span class="default">a</span><span class="keyword">;<br />
}<br />
</span><span class="comment">//output: one-error-two<br />
</span><span class="default">?&gt;<br />
</span>But, goto operator can NOT be evaluate or get a value:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">eval(</span><span class="string">'goto a;'</span><span class="keyword">); </span><span class="comment">//Fatal error: 'goto' to undefined label 'a'<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="string">'a'</span><span class="keyword">;<br />
goto </span><span class="default">$b</span><span class="keyword">; </span><span class="comment">//Parse error: syntax error, unexpected T_VARIABLE, expecting T_STRING<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103819""></a>
  <div class="note">
   <strong class="user">Johan</strong>
   <a href="#103819" class="date">05-May-2011 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Custom error handling on entire pages can avoid half rendered pages for the users:<br />
<br />
<span class="default">&lt;?php<br />
ob_start</span><span class="keyword">();<br />
try {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/*contains all page logic <br />
&nbsp;&nbsp;&nbsp; and throws error if needed*/<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">...<br />
} catch (</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">ob_end_clean</span><span class="keyword">();<br />
&nbsp; </span><span class="default">displayErrorPage</span><span class="keyword">(</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">());<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99803""></a>
  <div class="note">
   <strong class="user">fabian dot pijcke at gmail dot com</strong>
   <a href="#99803" class="date">08-Sep-2010 02:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful when you set variables inside a try block, they are still declared outside the block.<br />
<br />
Note that it is the case for every block constructions in PHP, but it can be useful to be aware of it :)<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">try {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="string">"blabla"</span><span class="keyword">;<br />
} catch (</span><span class="default">Exception $e</span><span class="keyword">) {}<br />
<br />
echo isset(</span><span class="default">$a</span><span class="keyword">) ? </span><span class="string">":)" </span><span class="keyword">: </span><span class="string">":("</span><span class="keyword">; </span><span class="comment">// Gives ":)"<br />
</span><span class="keyword">echo isset(</span><span class="default">$b</span><span class="keyword">) ? </span><span class="string">":)" </span><span class="keyword">: </span><span class="string">":("</span><span class="keyword">; </span><span class="comment">// Gives ":("<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99702""></a>
  <div class="note">
   <strong class="user">mcnaney at gmail</strong>
   <a href="#99702" class="date">31-Aug-2010 10:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Watch your namespace if you have created your own exception class.<br />
<br />
For example:<br />
<br />
Error.php<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">namespace Global;<br />
class </span><span class="default">Error </span><span class="keyword">extends </span><span class="default">Exception </span><span class="keyword">{}<br />
</span><span class="default">?&gt;<br />
</span><br />
Foo.php<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">namespace </span><span class="default">Foo</span><span class="keyword">;<br />
<br />
try {<br />
&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">();<br />
} catch (</span><span class="default">Error $e</span><span class="keyword">) {<br />
&nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">();<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
You WILL NOT get an error message if Error is not in the Foo namespace. Instead the Exception will be passed upwards.<br />
<br />
Should be:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">try {<br />
&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">();<br />
} catch (Global\</span><span class="default">Error $e</span><span class="keyword">) {<br />
&nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">();<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97963""></a>
  <div class="note">
   <strong class="user">zmunoz at gmail dot com</strong>
   <a href="#97963" class="date">18-May-2010 01:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When catching an exception inside a namespace it is important that you escape to the global space:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;</span><span class="keyword">namespace </span><span class="default">SomeNamespace</span><span class="keyword">;<br />
<br />
&nbsp;class </span><span class="default">SomeClass </span><span class="keyword">{<br />
<br />
&nbsp; function </span><span class="default">SomeFunction</span><span class="keyword">() {<br />
&nbsp;&nbsp; try {<br />
&nbsp;&nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Some Error Message'</span><span class="keyword">);<br />
&nbsp;&nbsp; } catch (\</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">());<br />
&nbsp;&nbsp; }<br />
&nbsp; }<br />
<br />
&nbsp;}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97255""></a>
  <div class="note">
   <strong class="user">mike at clove dot com</strong>
   <a href="#97255" class="date">10-Apr-2010 08:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The PHP documentation has gone from very useful to hideously obstructive.<br />
<br />
The people who are rearranging the doc into little, tiny chunks which are hyperlinked all over the place obviously never write code.<br />
<br />
I just spent 10 minutes trying to find the name of an IO Exception so I can use it in some code I'm writing.<br />
<br />
Old Doc: I would go to the index, click on Exceptions and then scroll down the page (or do a find on IO) and there it would be. 10 seconds tops.<br />
<br />
New Doc: Go to the index click on Predefined Exceptions<br />
&nbsp;Click on Exception - find description of Exception Object - info not there<br />
&nbsp;Back Button<br />
&nbsp;Click on Error Exception - find description of Generic ErrorExeption object<br />
&nbsp;Back Button<br />
&nbsp;Click on SPL Exceptions (what the hell is this? - something new?)<br />
&nbsp;Look at Table of contents: 13 Exception Categories - none of which<br />
&nbsp; looks like an IOException<br />
&nbsp;Click on Predefined Exceptions in the See Also - <br />
&nbsp;&nbsp; Back to Previous Useless Page<br />
<br />
First You completely screw up the Perl Regular Expression page by chopping it into tiny, obscure chunks and now you destroy the exception documentation.<br />
<br />
PLEASE put it back the way it was.<br />
<br />
Or get somebody who actually uses this stuff like a handbook while writing code to fix it<br />
<br />
Or shoot somebody.<br />
<br />
Incredibly frustrated and thinking of rewriting everything in Python,<br />
Mike Howard &lt;mike at clove dot com&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95433""></a>
  <div class="note">
   <strong class="user">test30zxc at gmail dot com</strong>
   <a href="#95433" class="date">03-Jan-2010 04:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using exceptions, code which will store uncaught exceptions might be nice for you, <br />
for example, <br />
PDO throws an exception, but you thought that this is impossible, so you were not even thinking about using try{...}catch(...){...}, <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">exception_handler</span><span class="keyword">(</span><span class="default">$exception</span><span class="keyword">) {<br />
</span><span class="default">ob_start</span><span class="keyword">();<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$GLOBALS</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$exception</span><span class="keyword">);<br />
&nbsp; </span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="string">'exceptions.txt'</span><span class="keyword">, </span><span class="default">ob_get_clean</span><span class="keyword">(). </span><span class="string">"\n"</span><span class="keyword">,</span><span class="default">FILE_APPEND</span><span class="keyword">);<br />
}<br />
</span><span class="default">set_exception_handler</span><span class="keyword">(</span><span class="string">'exception_handler'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
to save a uncatched exception simply write <br />
<span class="default">&lt;?php </span><span class="keyword">throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'error'</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span>somewhere in code. <br />
If we have a lot of exceptions, file will get a huge size in few minutes, <br />
but saving this kind of information may save you from, for example, being sql-injected (attempt to try to inject-sql will be saved)<br />
<br />
PS PDO ofc. must be set to throw exceptions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91159""></a>
  <div class="note">
   <strong class="user">ask at nilpo dot com</strong>
   <a href="#91159" class="date">27-May-2009 12:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you intend on creating a lot of custom exceptions, you may find this code useful.&nbsp; I've created an interface and an abstract exception class that ensures that all parts of the built-in Exception class are preserved in child classes.&nbsp; It also properly pushes all information back to the parent constructor ensuring that nothing is lost.&nbsp; This allows you to quickly create new exceptions on the fly.&nbsp; It also overrides the default __toString method with a more thorough one.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">interface </span><span class="default">IException<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* Protected methods inherited from Exception class */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">getMessage</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Exception message <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">getCode</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// User-defined Exception code<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">getFile</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Source filename<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">getLine</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Source line<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">getTrace</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// An array of the backtrace()<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">getTraceAsString</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Formated string of trace<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; /* Overrideable methods inherited from Exception class */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__toString</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// formated string for display<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$message </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$code </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">);<br />
}<br />
<br />
abstract class </span><span class="default">CustomException </span><span class="keyword">extends </span><span class="default">Exception </span><span class="keyword">implements </span><span class="default">IException<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$message </span><span class="keyword">= </span><span class="string">'Unknown exception'</span><span class="keyword">;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Exception message<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private&nbsp;&nbsp; </span><span class="default">$string</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Unknown<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$code&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// User-defined exception code<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$file</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Source filename of exception<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$line</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Source line of exception<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private&nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Unknown<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$message </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$code </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$message</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">$this</span><span class="keyword">(</span><span class="string">'Unknown '</span><span class="keyword">. </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$message</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__toString</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">) . </span><span class="string">" '</span><span class="keyword">{</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">message</span><span class="keyword">}</span><span class="string">' in </span><span class="keyword">{</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">file</span><span class="keyword">}</span><span class="string">(</span><span class="keyword">{</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">line</span><span class="keyword">}</span><span class="string">)\n"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">. </span><span class="string">"</span><span class="keyword">{</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getTraceAsString</span><span class="keyword">()}</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Now you can create new exceptions in one line:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">TestException </span><span class="keyword">extends </span><span class="default">CustomException </span><span class="keyword">{}<br />
</span><span class="default">?&gt;<br />
</span><br />
Here's a test that shows that all information is properly preserved throughout the backtrace.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">exceptionTest</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; try {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">TestException</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; catch (</span><span class="default">TestException $e</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Caught TestException ('</span><span class="keyword">{</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">()}</span><span class="string">')\n</span><span class="keyword">{</span><span class="default">$e</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; catch (</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Caught Exception ('</span><span class="keyword">{</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">()}</span><span class="string">')\n</span><span class="keyword">{</span><span class="default">$e</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
echo </span><span class="string">'&lt;pre&gt;' </span><span class="keyword">. </span><span class="default">exceptionTest</span><span class="keyword">() . </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Here's a sample output:<br />
<br />
Caught TestException ('Unknown TestException')<br />
TestException 'Unknown TestException' in C:\xampp\htdocs\CustomException\CustomException.php(31)<br />
#0 C:\xampp\htdocs\CustomException\ExceptionTest.php(19): CustomException-&gt;__construct()<br />
#1 C:\xampp\htdocs\CustomException\ExceptionTest.php(43): exceptionTest()<br />
#2 {main}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87695""></a>
  <div class="note">
   <strong class="user">rctay89 at gmail dot com</strong>
   <a href="#87695" class="date">17-Dec-2008 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The internal implementation of Exception.__toString is something like this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">MyException </span><span class="keyword">extends </span><span class="default">Exception </span><span class="keyword">{<br />
&nbsp; public function </span><span class="default">__toString</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="string">"exception '"</span><span class="keyword">.</span><span class="default">__CLASS__ </span><span class="keyword">.</span><span class="string">"' with message '"</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">().</span><span class="string">"' in "</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getFile</span><span class="keyword">().</span><span class="string">":"</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getLine</span><span class="keyword">().</span><span class="string">"\nStack trace:\n"</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getTraceAsString</span><span class="keyword">();<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Useful if you want to customize your exception toString format, but not to deviate too much from the built-in one.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86476""></a>
  <div class="note">
   <strong class="user">Shot (Piotr Szotkowski)</strong>
   <a href="#86476" class="date">21-Oct-2008 12:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
‘Normal execution (when no exception is thrown within the try block, *or when a catch matching the thrown exception’s class is not present*) will continue after that last catch block defined in sequence.’<br />
<br />
‘If an exception is not caught, a PHP Fatal Error will be issued with an “Uncaught Exception …” message, unless a handler has been defined with set_exception_handler().’<br />
<br />
These two sentences seem a bit contradicting about what happens ‘when a catch matching the thrown exception’s class is not present’ (and the second sentence is actually correct).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82316""></a>
  <div class="note">
   <strong class="user">i dot crash17 at gmail dot com</strong>
   <a href="#82316" class="date">04-Apr-2008 08:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As a response to Anonymous on 28-Dec-2007 07:25, please, remember that creating lots of MyXExtension classes is wrong if and only if your object oriented model is not well designed.<br />
<br />
One should (I even think MUST) create as many custom Exception extentions as the design needs, because every different type of exception requires (or will require, even if we haven't think about it) a different response, from showing different messages to the user, to log error messages or even kill the script.<br />
<br />
Forwarding can become confusing if you are using a big number of classes and packages, and is useless if you are using few (unless you are too lasy to write 3, 5 or 10 includes and their respective Exception classes).<br />
<br />
Remember that object orientation was created to give more semantics to the programming code so the programmer understands better what is written without having to excecute the code, so don't do things that go against that, which is the cool thing about object orientation.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81960""></a>
  <div class="note">
   <strong class="user">michael dot ochs at gmx dot net</strong>
   <a href="#81960" class="date">21-Mar-2008 03:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Actually it isn't possible to do:<br />
<span class="default">&lt;?php<br />
someFunction</span><span class="keyword">() OR throw new </span><span class="default">Exception</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
This leads to a T_THROW Syntax Error. If you want to use this kind of exceptions, you can do the following:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">throwException</span><span class="keyword">(</span><span class="default">$message </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">,</span><span class="default">$code </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="default">$message</span><span class="keyword">,</span><span class="default">$code</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">someFunction</span><span class="keyword">() OR </span><span class="default">throwException</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81603""></a>
  <div class="note">
   <strong class="user">chugadie dot geo at yahoo dot com</strong>
   <a href="#81603" class="date">05-Mar-2008 10:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@webmaster at asylum-et dot com<br />
<br />
What Mo is describing is bug 44053 (<a href="http://bugs.php.net/bug.php?id=44053" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=44053</a>) in which exceptions cannot be caught if you are using a custom error handler to catch warnings, notices, etc.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79577""></a>
  <div class="note">
   <strong class="user">omnibus at omnibus dot edu dot pl</strong>
   <a href="#79577" class="date">04-Dec-2007 03:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just to be more precise in what Frank found:<br />
Catch the exceptions always in order from the bottom to the top of the Exception and subclasses class hierarchy. If you have class MyException extending Exception and class My2Exception extending MyException always catch My2Exception before MyException.<br />
<br />
Hope this helps</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79036""></a>
  <div class="note">
   <strong class="user">frank at netventures dot com dot au</strong>
   <a href="#79036" class="date">07-Nov-2007 03:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are going to use multiple catches within a try-catch then do not forget the stacking order of those catches!<br />
<br />
This is important as any classes that extend the Exception class, like MyException in example 20.3, will be caught in the Exception case. This is because your newly extended class also has a class type of Exception. This baffled me for awhile as the examples here worked but mine didn't because my first catch was trying to catch Exception.<br />
<br />
Example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* My1Exception extends Exception<br />
&nbsp;* My2Exception extends Exception<br />
&nbsp;*/<br />
<br />
/**<br />
&nbsp;* This will always fall in the first exception<br />
&nbsp;*/<br />
</span><span class="keyword">try {<br />
&nbsp;&nbsp;&nbsp; throw new </span><span class="default">My1Exception</span><span class="keyword">(</span><span class="string">"My fail english? That's unpossible"</span><span class="keyword">, </span><span class="default">69</span><span class="keyword">);<br />
} catch (</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"Incorrect Exception"</span><span class="keyword">;<br />
} catch (</span><span class="default">My1Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"Correct Exception but I won't be here"</span><span class="keyword">;<br />
} catch (</span><span class="default">My2Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"Again, incorrect"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Whereas here, the catch stacking order was changed so our throw will cascade into the correct catch<br />
&nbsp;*/<br />
</span><span class="keyword">try {<br />
&nbsp;&nbsp;&nbsp; throw new </span><span class="default">My1Exception</span><span class="keyword">(</span><span class="string">"My cat's breath smells like cat food"</span><span class="keyword">, </span><span class="default">69</span><span class="keyword">);<br />
} catch (</span><span class="default">My2Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"Incorrect Exception"</span><span class="keyword">;<br />
} catch (</span><span class="default">My1Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"Correct Exception and I WILL be printed"</span><span class="keyword">;<br />
} catch (</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"Again, incorrect"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
So, ALWAYS keep the Exception catch block at the bottom, then any of the other extended exceptions that extend from Exception, then any of your other extended exceptions that extend from those extended exceptions, etc</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78591""></a>
  <div class="note">
   <strong class="user">hartym dot dont dot like dot spam at gmail dot com</strong>
   <a href="#78591" class="date">18-Oct-2007 04:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@serenity: of course you need to throw exception within the try block, catch will not watch fatal errors, nor less important errors but only exceptions that are instanceof the exception type you're giving. Of course by within the try block, i mean within every functions call happening in try block.<br />
<br />
For example, to nicely handle old mysql errors, you can do something like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">try<br />
{<br />
&nbsp; </span><span class="default">$connection </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(...);<br />
&nbsp; if (</span><span class="default">$connection </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Cannot connect do mysql'</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp;&nbsp; </span><span class="comment">/* ... do whatever you need with database, that may mail and throw exceptions too ... */<br />
<br />
&nbsp;&nbsp; </span><span class="default">mysql_close</span><span class="keyword">(</span><span class="default">$connection</span><span class="keyword">);<br />
}<br />
catch (</span><span class="default">Exception $e</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; </span><span class="comment">/* ... add logging stuff there if you need ... */<br />
<br />
&nbsp; </span><span class="keyword">echo </span><span class="string">"This page cannot be displayed"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
By doing so, you're aiming at the don't repeat yourself (D.R.Y) concept, by managing error handling at only one place for the whole.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75768""></a>
  <div class="note">
   <strong class="user">peter dot goodman at gmail dot com</strong>
   <a href="#75768" class="date">14-Jun-2007 07:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've found that exception destructors are not called unless the exception is caught.<br />
<br />
I've created a simple solution to this problem (calling __destruct() from __toString() ) and have written up a lengthy article detailing one good use case for this method at <a href="http://ioreader.com/2007/06/14/taking-advantage-of-exceptions-in-php5/" rel="nofollow" target="_blank">http://ioreader.com/2007/06/14/taking-advantage-of-exceptions-in-php5/</a><br />
<br />
Also, one of the useful things about using a destructor as a clean up method is that it is called at the end of a catch statement.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72567""></a>
  <div class="note">
   <strong class="user">jon at hackcraft dot net</strong>
   <a href="#72567" class="date">24-Jan-2007 09:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Further to dexen at google dot me dot up with "use destructors to perform a cleanup in case of exception". The fact that PHP5 has destructors, exception handling, and predictable garbage collection (if there's a single reference in scope and the scope is left then the destructor is called immediately) allows for the use of the RAII idiom.<br />
<br />
<a href="http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization and my own http://www.hackcraft.net/RAII/ describe this." rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization and my own http://www.hackcraft.net/RAII/ describe this.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69730""></a>
  <div class="note">
   <strong class="user">dexen at google dot me dot up</strong>
   <a href="#69730" class="date">18-Sep-2006 06:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Summary:<br />
&nbsp;* use destructors to perform a cleanup in case of exception.<br />
<br />
PHP calls method __destruct()&nbsp; on instance of class when variable storing the instance goes out-of-scope (or gets unset). This works for function leave by Exception, aside of plain return. (same as for C++, AFAIK)<br />
<br />
aFunction() {<br />
$i = new LockerClass();<br />
throw new MinorErrorEx('Warn user &amp; perform some other activity');<br />
// $i-&gt;__destruct() gets called before stack unwind begins, unlocking whatever get locked by new LockerClass();<br />
&nbsp;return $bar;<br />
}<br />
<br />
(A lengthy) example:<br />
<br />
Let's say you need to perform a series of operaions on SQL database that should not get disrupted. You lock the tables: <br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">updateStuff</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">DB</span><span class="keyword">::</span><span class="default">query</span><span class="keyword">(</span><span class="string">'LOCK TABLES `a`, `b`, `c` WRITE'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* some SQL Operations */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">someFunction</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* more SQL Operations */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">DB</span><span class="keyword">::</span><span class="default">query</span><span class="keyword">(</span><span class="string">'UNLOCK TABLES'</span><span class="keyword">);<br />
} </span><span class="default">?&gt;<br />
</span><br />
Now, let's supouse that someFunction() may throw an exception. This would leave us with the tables locked, as the second DB::query() will not get called. This pretty much will cause the next query to fail. You can do it like:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">updateStuff</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">DB</span><span class="keyword">::</span><span class="default">query</span><span class="keyword">(</span><span class="string">'LOCK TABLES `a`, `b` WRITE'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* some SQL Operations */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">try {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">someFunction</span><span class="keyword">(); }<br />
&nbsp;&nbsp;&nbsp; catch ( </span><span class="default">Exception $e </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">DB</span><span class="keyword">::</span><span class="default">query</span><span class="keyword">(</span><span class="string">'UNLOCK TABLES'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; throw </span><span class="default">$e</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* more SQL Operations */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">DB</span><span class="keyword">::</span><span class="default">query</span><span class="keyword">(</span><span class="string">'UNLOCK TABLES'</span><span class="keyword">)<br />
} </span><span class="default">?&gt;<br />
</span><br />
However, this is rather ugly as we get code duplication. And what if somebody later modifies updateStuff() function in a way it needs another step of cleanup, but forget to add it to catch () {}? Or when we have multiple things to be cleaned up, of which not all will be valid all the time?<br />
&nbsp;<br />
My solution using destructor: i create an instance of class DB holding a query unlocking tables which will be executed on destruction.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">updateStuff</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$SQLLocker </span><span class="keyword">= </span><span class="default">DB</span><span class="keyword">::</span><span class="default">locker</span><span class="keyword">( </span><span class="comment">/*read lock list*/</span><span class="keyword">array(</span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'b'</span><span class="keyword">), </span><span class="comment">/*write lock list*/</span><span class="keyword">array(</span><span class="string">'b'</span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* some SQL Operations */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">someFunction</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* $SQLLocker gets destructed there if someFunction() throws an exception */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">DB</span><span class="keyword">::</span><span class="default">query</span><span class="keyword">(</span><span class="string">'UNLOCK TABLES'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* other SQL Operations */<br />
&nbsp;&nbsp;&nbsp; /* $SQLLocker gets destructed there if someFunction() does not throw an exception */<br />
</span><span class="keyword">}<br />
<br />
class </span><span class="default">DB </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">locker </span><span class="keyword">( </span><span class="default">$read</span><span class="keyword">, </span><span class="default">$write </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">DB</span><span class="keyword">::</span><span class="default">query</span><span class="keyword">( </span><span class="comment">/*locks*/</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= new </span><span class="default">DB</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret</span><span class="keyword">-&gt;</span><span class="default">onDestruct </span><span class="keyword">= </span><span class="string">'UNLOCK TABLES'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$ret</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">_destructor</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">onDestruct </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">DB</span><span class="keyword">::</span><span class="default">query</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">onDestruct</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68697""></a>
  <div class="note">
   <strong class="user">jazfresh at hotmail.com</strong>
   <a href="#68697" class="date">07-Aug-2006 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes you want a single catch() to catch multiple types of Exception. In a language like Python, you can specify multiple types in a catch(), but in PHP you can only specify one. This can be annoying when you want handle many different Exceptions with the same catch() block.<br />
<br />
However, you can replicate the functionality somewhat, because catch(&lt;classname&gt; $var) will match the given &lt;classname&gt; *or any of it's sub-classes*.<br />
<br />
For example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">DisplayException </span><span class="keyword">extends </span><span class="default">Exception </span><span class="keyword">{};<br />
class </span><span class="default">FileException </span><span class="keyword">extends </span><span class="default">Exception </span><span class="keyword">{};<br />
class </span><span class="default">AccessControl </span><span class="keyword">extends </span><span class="default">FileException </span><span class="keyword">{}; </span><span class="comment">// Sub-class of FileException<br />
</span><span class="keyword">class </span><span class="default">IOError </span><span class="keyword">extends </span><span class="default">FileException </span><span class="keyword">{}; </span><span class="comment">// Sub-class of FileException<br />
<br />
</span><span class="keyword">try {<br />
&nbsp; if(!</span><span class="default">is_readable</span><span class="keyword">(</span><span class="default">$somefile</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; throw new </span><span class="default">IOError</span><span class="keyword">(</span><span class="string">"File is not readable!"</span><span class="keyword">);<br />
&nbsp; if(!</span><span class="default">user_has_access_to_file</span><span class="keyword">(</span><span class="default">$someuser</span><span class="keyword">, </span><span class="default">$somefile</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; throw new </span><span class="default">AccessControl</span><span class="keyword">(</span><span class="string">"Permission denied!"</span><span class="keyword">);<br />
&nbsp; if(!</span><span class="default">display_file</span><span class="keyword">(</span><span class="default">$somefile</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; throw new </span><span class="default">DisplayException</span><span class="keyword">(</span><span class="string">"Couldn't display file!"</span><span class="keyword">);<br />
<br />
} catch (</span><span class="default">FileException $e</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment">// This block will catch FileException, AccessControl or IOError exceptions, but not Exceptions or DisplayExceptions.<br />
&nbsp; </span><span class="keyword">echo </span><span class="string">"File error: "</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">();<br />
&nbsp; exit(</span><span class="default">1</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Corollary: If you want to catch *any* exception, no matter what the type, just use "catch(Exception $var)", because all exceptions are sub-classes of the built-in Exception.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65203""></a>
  <div class="note">
   <strong class="user">fjoggen at gmail dot com</strong>
   <a href="#65203" class="date">26-Apr-2006 01:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This code will turn php errors into exceptions:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">exceptions_error_handler</span><span class="keyword">(</span><span class="default">$severity</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">, </span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$lineno</span><span class="keyword">) { <br />
&nbsp;&nbsp;&nbsp; throw new </span><span class="default">ErrorException</span><span class="keyword">(</span><span class="default">$message</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$severity</span><span class="keyword">, </span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$lineno</span><span class="keyword">); <br />
}<br />
<br />
</span><span class="default">set_error_handler</span><span class="keyword">(</span><span class="string">'exceptions_error_handler'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
However since <span class="default">&lt;?php set_error_handler</span><span class="keyword">()</span><span class="default">?&gt;</span> doesn't work with fatal errors, you will not be able to throw them as Exceptions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52612""></a>
  <div class="note">
   <strong class="user">jd at wuputah dot com</strong>
   <a href="#52612" class="date">06-May-2005 07:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP5 supports exception throwing inside a function, and catching it outside that function call. There is no mention of this in documentation but it works just fine, as tested by this sample code:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">exceptionFunction</span><span class="keyword">() { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Throwing an exception!"</span><span class="keyword">); <br />
}<br />
<br />
try {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">exceptionFunction</span><span class="keyword">();<br />
} catch (</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Exception caught!\n"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The result in PHP 5.0.3 is "Exception caught!"<br />
<br />
Further tests show that nested functions with exceptions, methods throwing exceptions, etc all work the same way. This is like declaring all classes (or methods) in Java as "class ClassName throws Exception". While I consider this a good thing, you should be aware that any thrown exception will propagate up your stack until it is either caught or runs out of stack.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="language.namespaces.faq.html">FAQ: things you need to know about namespaces</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="language.exceptions.extending.html">Extending Exceptions</a></div>
 <div class="up"><a href="langref.html">Language Reference</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

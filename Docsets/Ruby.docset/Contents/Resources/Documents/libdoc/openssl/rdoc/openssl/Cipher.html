<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <!-- RD version: 0.9.4  -->
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
  <title>Class: OpenSSL::Cipher (Ruby 1.9.2) </title>
  <!-- raw_prefix  = '..'   -->
  <link rel="stylesheet" href="../css/obf.css" >

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/rubydoc.js" type="text/javascript" charset="utf-8"></script> 

 
<script src="../js/highlight.min.js"></script>
<script> 
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
  </script> 
</head>

<body id="top" class="class">
<div id="actionbar" style='display:none' >
<div class='wrapper'>
<ul class='grids g0'>
  <li class='grid-2' ><a href='/' target='_top' >Home</a></li>
  <li class='grid-2' ><a href='/core' target='_top' >Core</a></li>
  <li class='grid-2' ><a href='/stdlib' target='_top' >Std-lib</a></li>
  <li class='grid-2' ><a href='/downloads' target='_top' >Downloads</a></li>
  <li class='grid-7 right' id='rd-action-search'><form id="searchbox_011815814100681837392:wnccv6st5qk" action="/search.html"><input type="hidden" name="cx" value="011815814100681837392:wnccv6st5qk" ><input name="q" type="text" size="20" >&#160;&#160;<input type="submit" name="sa" value="Search" ><input type="hidden" name="cof" value="FORID:9" ></form>
</li>
</ul>
</div>
</div> <!-- end action bar -->
          <div class='wrapper'>
  <div id="metadata" style='display:none'>
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../openssl/lib/openssl/cipher_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="openssl/lib/openssl/cipher.rb">openssl/lib/openssl/cipher.rb</a></li>
          
            <li><a href="../openssl/ossl_c.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="openssl/ossl.c">openssl/ossl.c</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">CLASS</span> <a href="Cipher/Cipher.html">OpenSSL::Cipher::Cipher</a></li>
          
          <li><span class="type">CLASS</span> <a href="Cipher/CipherError.html">OpenSSL::Cipher::CipherError</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-ciphers">::ciphers</a></li>
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-block_size">#block_size</a></li>
          
          <li><a href="#method-i-decrypt">#decrypt</a></li>
          
          <li><a href="#method-i-encrypt">#encrypt</a></li>
          
          <li><a href="#method-i-final">#final</a></li>
          
          <li><a href="#method-i-iv-3D">#iv=</a></li>
          
          <li><a href="#method-i-iv_len">#iv_len</a></li>
          
          <li><a href="#method-i-key-3D">#key=</a></li>
          
          <li><a href="#method-i-key_len">#key_len</a></li>
          
          <li><a href="#method-i-key_len-3D">#key_len=</a></li>
          
          <li><a href="#method-i-name">#name</a></li>
          
          <li><a href="#method-i-padding-3D">#padding=</a></li>
          
          <li><a href="#method-i-pkcs5_keyivgen">#pkcs5_keyivgen</a></li>
          
          <li><a href="#method-i-random_iv">#random_iv</a></li>
          
          <li><a href="#method-i-random_key">#random_key</a></li>
          
          <li><a href="#method-i-reset">#reset</a></li>
          
          <li><a href="#method-i-update">#update</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../OpenSSL.html">OpenSSL</a></li>
        
          <li><a href="../OpenSSL/ASN1.html">OpenSSL::ASN1</a></li>
        
          <li><a href="../OpenSSL/ASN1/ASN1Data.html">OpenSSL::ASN1::ASN1Data</a></li>
        
          <li><a href="../OpenSSL/ASN1/ASN1Error.html">OpenSSL::ASN1::ASN1Error</a></li>
        
          <li><a href="../OpenSSL/ASN1/Constructive.html">OpenSSL::ASN1::Constructive</a></li>
        
          <li><a href="../OpenSSL/ASN1/Primitive.html">OpenSSL::ASN1::Primitive</a></li>
        
          <li><a href="../OpenSSL/BN.html">OpenSSL::BN</a></li>
        
          <li><a href="../OpenSSL/BNError.html">OpenSSL::BNError</a></li>
        
          <li><a href="../OpenSSL/Buffering.html">OpenSSL::Buffering</a></li>
        
          <li><a href="../OpenSSL/Cipher.html">OpenSSL::Cipher</a></li>
        
          <li><a href="../OpenSSL/Cipher/Cipher.html">OpenSSL::Cipher::Cipher</a></li>
        
          <li><a href="../OpenSSL/Cipher/CipherError.html">OpenSSL::Cipher::CipherError</a></li>
        
          <li><a href="../OpenSSL/Config.html">OpenSSL::Config</a></li>
        
          <li><a href="../OpenSSL/ConfigError.html">OpenSSL::ConfigError</a></li>
        
          <li><a href="../OpenSSL/Digest.html">OpenSSL::Digest</a></li>
        
          <li><a href="../OpenSSL/Digest/Digest.html">OpenSSL::Digest::Digest</a></li>
        
          <li><a href="../OpenSSL/Digest/DigestError.html">OpenSSL::Digest::DigestError</a></li>
        
          <li><a href="../OpenSSL/Engine.html">OpenSSL::Engine</a></li>
        
          <li><a href="../OpenSSL/Engine/EngineError.html">OpenSSL::Engine::EngineError</a></li>
        
          <li><a href="../OpenSSL/HMAC.html">OpenSSL::HMAC</a></li>
        
          <li><a href="../OpenSSL/HMACError.html">OpenSSL::HMACError</a></li>
        
          <li><a href="../OpenSSL/Netscape.html">OpenSSL::Netscape</a></li>
        
          <li><a href="../OpenSSL/Netscape/SPKI.html">OpenSSL::Netscape::SPKI</a></li>
        
          <li><a href="../OpenSSL/Netscape/SPKIError.html">OpenSSL::Netscape::SPKIError</a></li>
        
          <li><a href="../OpenSSL/OCSP.html">OpenSSL::OCSP</a></li>
        
          <li><a href="../OpenSSL/OCSP/BasicResponse.html">OpenSSL::OCSP::BasicResponse</a></li>
        
          <li><a href="../OpenSSL/OCSP/CertificateId.html">OpenSSL::OCSP::CertificateId</a></li>
        
          <li><a href="../OpenSSL/OCSP/OCSPError.html">OpenSSL::OCSP::OCSPError</a></li>
        
          <li><a href="../OpenSSL/OCSP/Request.html">OpenSSL::OCSP::Request</a></li>
        
          <li><a href="../OpenSSL/OCSP/Response.html">OpenSSL::OCSP::Response</a></li>
        
          <li><a href="../OpenSSL/OpenSSLError.html">OpenSSL::OpenSSLError</a></li>
        
          <li><a href="../OpenSSL/PKCS12.html">OpenSSL::PKCS12</a></li>
        
          <li><a href="../OpenSSL/PKCS12/PKCS12Error.html">OpenSSL::PKCS12::PKCS12Error</a></li>
        
          <li><a href="../OpenSSL/PKCS5.html">OpenSSL::PKCS5</a></li>
        
          <li><a href="../OpenSSL/PKCS5/PKCS5Error.html">OpenSSL::PKCS5::PKCS5Error</a></li>
        
          <li><a href="../OpenSSL/PKCS7.html">OpenSSL::PKCS7</a></li>
        
          <li><a href="../OpenSSL/PKCS7/PKCS7Error.html">OpenSSL::PKCS7::PKCS7Error</a></li>
        
          <li><a href="../OpenSSL/PKCS7/RecipientInfo.html">OpenSSL::PKCS7::RecipientInfo</a></li>
        
          <li><a href="../OpenSSL/PKCS7/SignerInfo.html">OpenSSL::PKCS7::SignerInfo</a></li>
        
          <li><a href="../OpenSSL/PKey.html">OpenSSL::PKey</a></li>
        
          <li><a href="../OpenSSL/PKey/DH.html">OpenSSL::PKey::DH</a></li>
        
          <li><a href="../OpenSSL/PKey/DHError.html">OpenSSL::PKey::DHError</a></li>
        
          <li><a href="../OpenSSL/PKey/DSA.html">OpenSSL::PKey::DSA</a></li>
        
          <li><a href="../OpenSSL/PKey/DSAError.html">OpenSSL::PKey::DSAError</a></li>
        
          <li><a href="../OpenSSL/PKey/EC.html">OpenSSL::PKey::EC</a></li>
        
          <li><a href="../OpenSSL/PKey/EC/Group.html">OpenSSL::PKey::EC::Group</a></li>
        
          <li><a href="../OpenSSL/PKey/EC/Group/Error.html">OpenSSL::PKey::EC::Group::Error</a></li>
        
          <li><a href="../OpenSSL/PKey/EC/Point.html">OpenSSL::PKey::EC::Point</a></li>
        
          <li><a href="../OpenSSL/PKey/EC/Point/Error.html">OpenSSL::PKey::EC::Point::Error</a></li>
        
          <li><a href="../OpenSSL/PKey/ECError.html">OpenSSL::PKey::ECError</a></li>
        
          <li><a href="../OpenSSL/PKey/PKey.html">OpenSSL::PKey::PKey</a></li>
        
          <li><a href="../OpenSSL/PKey/PKeyError.html">OpenSSL::PKey::PKeyError</a></li>
        
          <li><a href="../OpenSSL/PKey/RSA.html">OpenSSL::PKey::RSA</a></li>
        
          <li><a href="../OpenSSL/PKey/RSAError.html">OpenSSL::PKey::RSAError</a></li>
        
          <li><a href="../OpenSSL/Random.html">OpenSSL::Random</a></li>
        
          <li><a href="../OpenSSL/Random/RandomError.html">OpenSSL::Random::RandomError</a></li>
        
          <li><a href="../OpenSSL/SSL.html">OpenSSL::SSL</a></li>
        
          <li><a href="../OpenSSL/SSL/Nonblock.html">OpenSSL::SSL::Nonblock</a></li>
        
          <li><a href="../OpenSSL/SSL/SSLContext.html">OpenSSL::SSL::SSLContext</a></li>
        
          <li><a href="../OpenSSL/SSL/SSLError.html">OpenSSL::SSL::SSLError</a></li>
        
          <li><a href="../OpenSSL/SSL/SSLServer.html">OpenSSL::SSL::SSLServer</a></li>
        
          <li><a href="../OpenSSL/SSL/SSLSocket.html">OpenSSL::SSL::SSLSocket</a></li>
        
          <li><a href="../OpenSSL/SSL/Session.html">OpenSSL::SSL::Session</a></li>
        
          <li><a href="../OpenSSL/SSL/Session/SessionError.html">OpenSSL::SSL::Session::SessionError</a></li>
        
          <li><a href="../OpenSSL/SSL/SocketForwarder.html">OpenSSL::SSL::SocketForwarder</a></li>
        
          <li><a href="../OpenSSL/X509.html">OpenSSL::X509</a></li>
        
          <li><a href="../OpenSSL/X509/Attribute.html">OpenSSL::X509::Attribute</a></li>
        
          <li><a href="../OpenSSL/X509/AttributeError.html">OpenSSL::X509::AttributeError</a></li>
        
          <li><a href="../OpenSSL/X509/CRL.html">OpenSSL::X509::CRL</a></li>
        
          <li><a href="../OpenSSL/X509/CRLError.html">OpenSSL::X509::CRLError</a></li>
        
          <li><a href="../OpenSSL/X509/Certificate.html">OpenSSL::X509::Certificate</a></li>
        
          <li><a href="../OpenSSL/X509/CertificateError.html">OpenSSL::X509::CertificateError</a></li>
        
          <li><a href="../OpenSSL/X509/Extension.html">OpenSSL::X509::Extension</a></li>
        
          <li><a href="../OpenSSL/X509/ExtensionError.html">OpenSSL::X509::ExtensionError</a></li>
        
          <li><a href="../OpenSSL/X509/ExtensionFactory.html">OpenSSL::X509::ExtensionFactory</a></li>
        
          <li><a href="../OpenSSL/X509/Name.html">OpenSSL::X509::Name</a></li>
        
          <li><a href="../OpenSSL/X509/Name/RFC2253DN.html">OpenSSL::X509::Name::RFC2253DN</a></li>
        
          <li><a href="../OpenSSL/X509/NameError.html">OpenSSL::X509::NameError</a></li>
        
          <li><a href="../OpenSSL/X509/Request.html">OpenSSL::X509::Request</a></li>
        
          <li><a href="../OpenSSL/X509/RequestError.html">OpenSSL::X509::RequestError</a></li>
        
          <li><a href="../OpenSSL/X509/Revoked.html">OpenSSL::X509::Revoked</a></li>
        
          <li><a href="../OpenSSL/X509/RevokedError.html">OpenSSL::X509::RevokedError</a></li>
        
          <li><a href="../OpenSSL/X509/Store.html">OpenSSL::X509::Store</a></li>
        
          <li><a href="../OpenSSL/X509/StoreContext.html">OpenSSL::X509::StoreContext</a></li>
        
          <li><a href="../OpenSSL/X509/StoreError.html">OpenSSL::X509::StoreError</a></li>
        
          <li><a href="../Integer.html">Integer</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation" style='margin: 10px 10px 10px 10px'>
    <h1 class="class">OpenSSL::Cipher</h1>

    <div id="description" class="description">
      
    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="ciphers-method" class="method-detail ">
          <a name="method-c-ciphers"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">ciphers &rarr; array[string...]</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Returns the names of all available ciphers in an array.</p>
            

            
            <div class="method-source-code" id="ciphers-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_s_ciphers(VALUE self)
{
    VALUE ary;

    ary = rb_ary_new();
    OBJ_NAME_do_all_sorted(OBJ_NAME_TYPE_CIPHER_METH,
                    (void(*)(const OBJ_NAME*,void*))add_cipher_name_to_ary,
                    (void*)ary);

    return ary;
}</code>
</pre> 
            </div><!-- ciphers-source -->
            
          </div>

          

          
        </div><!-- ciphers-method -->

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">new(string) &rarr; cipher</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>The string must contain a valid cipher name like “AES-128-CBC” or “3DES”.</p>

<p>A list of cipher names is available by calling <a
href="Cipher.html#method-c-ciphers">OpenSSL::Cipher.ciphers</a>.</p>
            

            
            <div class="method-source-code" id="new-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_initialize(VALUE self, VALUE str)
{
    EVP_CIPHER_CTX *ctx;
    const EVP_CIPHER *cipher;
    char *name;

    name = StringValuePtr(str);
    GetCipher(self, ctx);
    if (!(cipher = EVP_get_cipherbyname(name))) {
        ossl_raise(rb_eRuntimeError, &quot;unsupported cipher algorithm (%s)&quot;, name);
    }
    if (EVP_CipherInit_ex(ctx, cipher, NULL, NULL, NULL, -1) != 1)
        ossl_raise(eCipherError, NULL);

    return self;
}</code>
</pre> 
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="block_size-method" class="method-detail ">
          <a name="method-i-block_size"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">block_size &rarr; integer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="block_size-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE ossl_cipher_block_size() { }
#endif

/*
 * INIT
 */
void
Init_ossl_cipher(void)
{
#if 0 /* let rdoc know about mOSSL */
    mOSSL = rb_define_module(&quot;OpenSSL&quot;);
#endif
    cCipher = rb_define_class_under(mOSSL, &quot;Cipher&quot;, rb_cObject);
    eCipherError = rb_define_class_under(cCipher, &quot;CipherError&quot;, eOSSLError);

    rb_define_alloc_func(cCipher, ossl_cipher_alloc);
    rb_define_copy_func(cCipher, ossl_cipher_copy);
    rb_define_module_function(cCipher, &quot;ciphers&quot;, ossl_s_ciphers, 0);
    rb_define_method(cCipher, &quot;initialize&quot;, ossl_cipher_initialize, 1);
    rb_define_method(cCipher, &quot;reset&quot;, ossl_cipher_reset, 0);
    rb_define_method(cCipher, &quot;encrypt&quot;, ossl_cipher_encrypt, -1);
    rb_define_method(cCipher, &quot;decrypt&quot;, ossl_cipher_decrypt, -1);
    rb_define_method(cCipher, &quot;pkcs5_keyivgen&quot;, ossl_cipher_pkcs5_keyivgen, -1);
    rb_define_method(cCipher, &quot;update&quot;, ossl_cipher_update, -1);
    rb_define_method(cCipher, &quot;final&quot;, ossl_cipher_final, 0);
    rb_define_method(cCipher, &quot;name&quot;, ossl_cipher_name, 0);
    rb_define_method(cCipher, &quot;key=&quot;, ossl_cipher_set_key, 1);
    rb_define_method(cCipher, &quot;key_len=&quot;, ossl_cipher_set_key_length, 1);
    rb_define_method(cCipher, &quot;key_len&quot;, ossl_cipher_key_length, 0);
    rb_define_method(cCipher, &quot;iv=&quot;, ossl_cipher_set_iv, 1);
    rb_define_method(cCipher, &quot;iv_len&quot;, ossl_cipher_iv_length, 0);
    rb_define_method(cCipher, &quot;block_size&quot;, ossl_cipher_block_size, 0);
    rb_define_method(cCipher, &quot;padding=&quot;, ossl_cipher_set_padding, 1);
}</code>
</pre> 
            </div><!-- block_size-source -->
            
          </div>

          

          
        </div><!-- block_size-method -->

      
        <div id="decrypt-method" class="method-detail ">
          <a name="method-i-decrypt"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">decrypt &rarr; self</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Make sure to call .encrypt or .decrypt before using any of the following
methods:</p>
<ul><li><dl class="rdoc-list"><dt>key=, iv=, <a href="Cipher.html#method-i-random_key">random_key</a>, <a href="Cipher.html#method-i-random_iv">random_iv</a>, <a href="Cipher.html#method-i-pkcs5_keyivgen">pkcs5_keyivgen</a></dt>
<dd></dd></dl>
</li></ul>

<p>Internally calls EVP_CipherInit_ex(ctx, NULL, NULL, NULL, NULL, 0).</p>
            

            
            <div class="method-source-code" id="decrypt-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_decrypt(int argc, VALUE *argv, VALUE self)
{
    return ossl_cipher_init(argc, argv, self, 0);
}</code>
</pre> 
            </div><!-- decrypt-source -->
            
          </div>

          

          
        </div><!-- decrypt-method -->

      
        <div id="encrypt-method" class="method-detail ">
          <a name="method-i-encrypt"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">encrypt &rarr; self</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Make sure to call .encrypt or .decrypt before using any of the following
methods:</p>
<ul><li><dl class="rdoc-list"><dt>key=, iv=, <a href="Cipher.html#method-i-random_key">random_key</a>, <a href="Cipher.html#method-i-random_iv">random_iv</a>, <a href="Cipher.html#method-i-pkcs5_keyivgen">pkcs5_keyivgen</a></dt>
<dd></dd></dl>
</li></ul>

<p>Internally calls EVP_CipherInit_ex(ctx, NULL, NULL, NULL, NULL, 1).</p>
            

            
            <div class="method-source-code" id="encrypt-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_encrypt(int argc, VALUE *argv, VALUE self)
{
    return ossl_cipher_init(argc, argv, self, 1);
}</code>
</pre> 
            </div><!-- encrypt-source -->
            
          </div>

          

          
        </div><!-- encrypt-method -->

      
        <div id="final-method" class="method-detail ">
          <a name="method-i-final"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">final &rarr; aString</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Returns the remaining data held in the cipher object.  Further calls to
update() or final() will return garbage.</p>

<p>See EVP_CipherFinal_ex for further information.</p>
            

            
            <div class="method-source-code" id="final-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_final(VALUE self)
{
    EVP_CIPHER_CTX *ctx;
    int out_len;
    VALUE str;

    GetCipher(self, ctx);
    str = rb_str_new(0, EVP_CIPHER_CTX_block_size(ctx));
    if (!EVP_CipherFinal_ex(ctx, (unsigned char *)RSTRING_PTR(str), &amp;out_len))
        ossl_raise(eCipherError, NULL);
    assert(out_len &lt;= RSTRING_LEN(str));
    rb_str_set_len(str, out_len);

    return str;
}</code>
</pre> 
            </div><!-- final-source -->
            
          </div>

          

          
        </div><!-- final-method -->

      
        <div id="iv-3D-method" class="method-detail ">
          <a name="method-i-iv-3D"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">iv = string &rarr; string</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Sets the cipher iv.</p>

<p>Only call this method after calling cipher.encrypt or cipher.decrypt.</p>
            

            
            <div class="method-source-code" id="iv-3D-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_set_iv(VALUE self, VALUE iv)
{
    EVP_CIPHER_CTX *ctx;

    StringValue(iv);
    GetCipher(self, ctx);

    if (RSTRING_LEN(iv) &lt; EVP_CIPHER_CTX_iv_length(ctx))
        ossl_raise(eCipherError, &quot;iv length too short&quot;);

    if (EVP_CipherInit_ex(ctx, NULL, NULL, NULL, (unsigned char *)RSTRING_PTR(iv), -1) != 1)
        ossl_raise(eCipherError, NULL);

    return iv;
}</code>
</pre> 
            </div><!-- iv-3D-source -->
            
          </div>

          

          
        </div><!-- iv-3D-method -->

      
        <div id="iv_len-method" class="method-detail ">
          <a name="method-i-iv_len"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">iv_length &rarr; integer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="iv_len-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE ossl_cipher_iv_length() { }
/*
 *  call-seq:
 *     cipher.block_size -&gt; integer
 *
 */
static VALUE ossl_cipher_block_size() { }
#endif

/*
 * INIT
 */
void
Init_ossl_cipher(void)
{
#if 0 /* let rdoc know about mOSSL */
    mOSSL = rb_define_module(&quot;OpenSSL&quot;);
#endif
    cCipher = rb_define_class_under(mOSSL, &quot;Cipher&quot;, rb_cObject);
    eCipherError = rb_define_class_under(cCipher, &quot;CipherError&quot;, eOSSLError);

    rb_define_alloc_func(cCipher, ossl_cipher_alloc);
    rb_define_copy_func(cCipher, ossl_cipher_copy);
    rb_define_module_function(cCipher, &quot;ciphers&quot;, ossl_s_ciphers, 0);
    rb_define_method(cCipher, &quot;initialize&quot;, ossl_cipher_initialize, 1);
    rb_define_method(cCipher, &quot;reset&quot;, ossl_cipher_reset, 0);
    rb_define_method(cCipher, &quot;encrypt&quot;, ossl_cipher_encrypt, -1);
    rb_define_method(cCipher, &quot;decrypt&quot;, ossl_cipher_decrypt, -1);
    rb_define_method(cCipher, &quot;pkcs5_keyivgen&quot;, ossl_cipher_pkcs5_keyivgen, -1);
    rb_define_method(cCipher, &quot;update&quot;, ossl_cipher_update, -1);
    rb_define_method(cCipher, &quot;final&quot;, ossl_cipher_final, 0);
    rb_define_method(cCipher, &quot;name&quot;, ossl_cipher_name, 0);
    rb_define_method(cCipher, &quot;key=&quot;, ossl_cipher_set_key, 1);
    rb_define_method(cCipher, &quot;key_len=&quot;, ossl_cipher_set_key_length, 1);
    rb_define_method(cCipher, &quot;key_len&quot;, ossl_cipher_key_length, 0);
    rb_define_method(cCipher, &quot;iv=&quot;, ossl_cipher_set_iv, 1);
    rb_define_method(cCipher, &quot;iv_len&quot;, ossl_cipher_iv_length, 0);
    rb_define_method(cCipher, &quot;block_size&quot;, ossl_cipher_block_size, 0);
    rb_define_method(cCipher, &quot;padding=&quot;, ossl_cipher_set_padding, 1);
}</code>
</pre> 
            </div><!-- iv_len-source -->
            
          </div>

          

          
        </div><!-- iv_len-method -->

      
        <div id="key-3D-method" class="method-detail ">
          <a name="method-i-key-3D"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">key = string &rarr; string</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Sets the cipher key.</p>

<p>Only call this method after calling cipher.encrypt or cipher.decrypt.</p>
            

            
            <div class="method-source-code" id="key-3D-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_set_key(VALUE self, VALUE key)
{
    EVP_CIPHER_CTX *ctx;

    StringValue(key);
    GetCipher(self, ctx);

    if (RSTRING_LEN(key) &lt; EVP_CIPHER_CTX_key_length(ctx))
        ossl_raise(eCipherError, &quot;key length too short&quot;);

    if (EVP_CipherInit_ex(ctx, NULL, NULL, (unsigned char *)RSTRING_PTR(key), NULL, -1) != 1)
        ossl_raise(eCipherError, NULL);

    return key;
}</code>
</pre> 
            </div><!-- key-3D-source -->
            
          </div>

          

          
        </div><!-- key-3D-method -->

      
        <div id="key_len-method" class="method-detail ">
          <a name="method-i-key_len"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">key_length &rarr; integer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="key_len-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE ossl_cipher_key_length() { }
/*
 *  call-seq:
 *     cipher.iv_length -&gt; integer
 *
 */
static VALUE ossl_cipher_iv_length() { }
/*
 *  call-seq:
 *     cipher.block_size -&gt; integer
 *
 */
static VALUE ossl_cipher_block_size() { }
#endif

/*
 * INIT
 */
void
Init_ossl_cipher(void)
{
#if 0 /* let rdoc know about mOSSL */
    mOSSL = rb_define_module(&quot;OpenSSL&quot;);
#endif
    cCipher = rb_define_class_under(mOSSL, &quot;Cipher&quot;, rb_cObject);
    eCipherError = rb_define_class_under(cCipher, &quot;CipherError&quot;, eOSSLError);

    rb_define_alloc_func(cCipher, ossl_cipher_alloc);
    rb_define_copy_func(cCipher, ossl_cipher_copy);
    rb_define_module_function(cCipher, &quot;ciphers&quot;, ossl_s_ciphers, 0);
    rb_define_method(cCipher, &quot;initialize&quot;, ossl_cipher_initialize, 1);
    rb_define_method(cCipher, &quot;reset&quot;, ossl_cipher_reset, 0);
    rb_define_method(cCipher, &quot;encrypt&quot;, ossl_cipher_encrypt, -1);
    rb_define_method(cCipher, &quot;decrypt&quot;, ossl_cipher_decrypt, -1);
    rb_define_method(cCipher, &quot;pkcs5_keyivgen&quot;, ossl_cipher_pkcs5_keyivgen, -1);
    rb_define_method(cCipher, &quot;update&quot;, ossl_cipher_update, -1);
    rb_define_method(cCipher, &quot;final&quot;, ossl_cipher_final, 0);
    rb_define_method(cCipher, &quot;name&quot;, ossl_cipher_name, 0);
    rb_define_method(cCipher, &quot;key=&quot;, ossl_cipher_set_key, 1);
    rb_define_method(cCipher, &quot;key_len=&quot;, ossl_cipher_set_key_length, 1);
    rb_define_method(cCipher, &quot;key_len&quot;, ossl_cipher_key_length, 0);
    rb_define_method(cCipher, &quot;iv=&quot;, ossl_cipher_set_iv, 1);
    rb_define_method(cCipher, &quot;iv_len&quot;, ossl_cipher_iv_length, 0);
    rb_define_method(cCipher, &quot;block_size&quot;, ossl_cipher_block_size, 0);
    rb_define_method(cCipher, &quot;padding=&quot;, ossl_cipher_set_padding, 1);
}</code>
</pre> 
            </div><!-- key_len-source -->
            
          </div>

          

          
        </div><!-- key_len-method -->

      
        <div id="key_len-3D-method" class="method-detail ">
          <a name="method-i-key_len-3D"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">key_length = integer &rarr; integer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Sets the key length of the cipher.  If the cipher is a fixed length cipher
then attempting to set the key length to any value other than the fixed
value is an error.</p>

<p>Under normal circumstances you do not need to call this method (and
probably shouldn’t).</p>

<p>See EVP_CIPHER_CTX_set_key_length for further information.</p>
            

            
            <div class="method-source-code" id="key_len-3D-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_set_key_length(VALUE self, VALUE key_length)
{
    int len = NUM2INT(key_length);
    EVP_CIPHER_CTX *ctx;

    GetCipher(self, ctx);
    if (EVP_CIPHER_CTX_set_key_length(ctx, len) != 1)
        ossl_raise(eCipherError, NULL);

    return key_length;
}</code>
</pre> 
            </div><!-- key_len-3D-source -->
            
          </div>

          

          
        </div><!-- key_len-3D-method -->

      
        <div id="name-method" class="method-detail ">
          <a name="method-i-name"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">name &rarr; string</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Returns the name of the cipher which may differ slightly from the original
name provided.</p>
            

            
            <div class="method-source-code" id="name-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_name(VALUE self)
{
    EVP_CIPHER_CTX *ctx;

    GetCipher(self, ctx);

    return rb_str_new2(EVP_CIPHER_name(EVP_CIPHER_CTX_cipher(ctx)));
}</code>
</pre> 
            </div><!-- name-source -->
            
          </div>

          

          
        </div><!-- name-method -->

      
        <div id="padding-3D-method" class="method-detail ">
          <a name="method-i-padding-3D"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">padding = integer &rarr; integer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Enables or disables padding. By default encryption operations are padded
using standard block padding and the padding is checked and removed when
decrypting. If the pad parameter is zero then no padding is performed, the
total amount of data encrypted or decrypted must then be a multiple of the
block size or an error will occur.</p>

<p>See EVP_CIPHER_CTX_set_padding for further information.</p>
            

            
            <div class="method-source-code" id="padding-3D-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_set_padding(VALUE self, VALUE padding)
{
    EVP_CIPHER_CTX *ctx;
    int pad = NUM2INT(padding);

    GetCipher(self, ctx);
    if (EVP_CIPHER_CTX_set_padding(ctx, pad) != 1)
        ossl_raise(eCipherError, NULL);
    return padding;
}</code>
</pre> 
            </div><!-- padding-3D-source -->
            
          </div>

          

          
        </div><!-- padding-3D-method -->

      
        <div id="pkcs5_keyivgen-method" class="method-detail ">
          <a name="method-i-pkcs5_keyivgen"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">pkcs5_keyivgen(pass [, salt [, iterations [, digest]]] ) &rarr; nil</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Generates and sets the key/iv based on a password.</p>

<p>WARNING: This method is only <a href="PKCS5.html">PKCS5</a> v1.5 compliant
when using RC2, RC4-40, or DES with MD5 or SHA1.  Using anything else (like
AES) will generate the key/iv using an <a
href="../OpenSSL.html">OpenSSL</a> specific method.  Use a <a
href="PKCS5.html">PKCS5</a> v2 key generation method instead.</p>

<h3>Parameters</h3>

<p><tt>salt</tt> must be an 8 byte string if provided. <tt>iterations</tt> is
a integer with a default of 2048. <tt>digest</tt> is a <a
href="Digest.html">Digest</a> object that defaults to 'MD5'</p>

<p>A minimum of 1000 iterations is recommended.</p>
            

            
            <div class="method-source-code" id="pkcs5_keyivgen-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_pkcs5_keyivgen(int argc, VALUE *argv, VALUE self)
{
    EVP_CIPHER_CTX *ctx;
    const EVP_MD *digest;
    VALUE vpass, vsalt, viter, vdigest;
    unsigned char key[EVP_MAX_KEY_LENGTH], iv[EVP_MAX_IV_LENGTH], *salt = NULL;
    int iter;

    rb_scan_args(argc, argv, &quot;13&quot;, &amp;vpass, &amp;vsalt, &amp;viter, &amp;vdigest);
    StringValue(vpass);
    if(!NIL_P(vsalt)){
        StringValue(vsalt);
        if(RSTRING_LEN(vsalt) != PKCS5_SALT_LEN)
            rb_raise(eCipherError, &quot;salt must be an 8-octet string&quot;);
        salt = (unsigned char *)RSTRING_PTR(vsalt);
    }
    iter = NIL_P(viter) ? 2048 : NUM2INT(viter);
    digest = NIL_P(vdigest) ? EVP_md5() : GetDigestPtr(vdigest);
    GetCipher(self, ctx);
    EVP_BytesToKey(EVP_CIPHER_CTX_cipher(ctx), digest, salt,
                   (unsigned char *)RSTRING_PTR(vpass), RSTRING_LEN(vpass), iter, key, iv);
    if (EVP_CipherInit_ex(ctx, NULL, NULL, key, iv, -1) != 1)
        ossl_raise(eCipherError, NULL);
    OPENSSL_cleanse(key, sizeof key);
    OPENSSL_cleanse(iv, sizeof iv);

    return Qnil;
}</code>
</pre> 
            </div><!-- pkcs5_keyivgen-source -->
            
          </div>

          

          
        </div><!-- pkcs5_keyivgen-method -->

      
        <div id="random_iv-method" class="method-detail ">
          <a name="method-i-random_iv"></a>

          
          <div class="method-heading">
            <span class="method-name">random_iv</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Generate, set, and return a random iv. You must call cipher.encrypt or
cipher.decrypt before calling this method.</p>
            

            
            <div class="method-source-code" id="random_iv-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
<span class="ruby-comment"># File openssl/lib/openssl/cipher.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">random_iv</span>
  <span class="ruby-identifier">str</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Random</span>.<span class="ruby-identifier">random_bytes</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">iv_len</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">iv</span> = <span class="ruby-identifier">str</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">str</span>
<span class="ruby-keyword">end</span></code>
</pre> 
            </div><!-- random_iv-source -->
            
          </div>

          

          
        </div><!-- random_iv-method -->

      
        <div id="random_key-method" class="method-detail ">
          <a name="method-i-random_key"></a>

          
          <div class="method-heading">
            <span class="method-name">random_key</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Generate, set, and return a random key. You must call cipher.encrypt or
cipher.decrypt before calling this method.</p>
            

            
            <div class="method-source-code" id="random_key-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
<span class="ruby-comment"># File openssl/lib/openssl/cipher.rb, line 46</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">random_key</span>
  <span class="ruby-identifier">str</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Random</span>.<span class="ruby-identifier">random_bytes</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">key_len</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">key</span> = <span class="ruby-identifier">str</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">str</span>
<span class="ruby-keyword">end</span></code>
</pre> 
            </div><!-- random_key-source -->
            
          </div>

          

          
        </div><!-- random_key-method -->

      
        <div id="reset-method" class="method-detail ">
          <a name="method-i-reset"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">reset &rarr; self</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Internally calls EVP_CipherInit_ex(ctx, NULL, NULL, NULL, NULL, -1).</p>
            

            
            <div class="method-source-code" id="reset-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_reset(VALUE self)
{
    EVP_CIPHER_CTX *ctx;

    GetCipher(self, ctx);
    if (EVP_CipherInit_ex(ctx, NULL, NULL, NULL, NULL, -1) != 1)
        ossl_raise(eCipherError, NULL);

    return self;
}</code>
</pre> 
            </div><!-- reset-source -->
            
          </div>

          

          
        </div><!-- reset-method -->

      
        <div id="update-method" class="method-detail ">
          <a name="method-i-update"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">update(data [, buffer]) &rarr; string or buffer</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <h3>Parameters</h3>

<p><tt>data</tt> is a nonempty string. <tt>buffer</tt> is an optional string
to store the result.</p>
            

            
            <div class="method-source-code" id="update-source">
              <pre>
              <code class='cpp'> <!-- How can we tell the language? Can we grab the file extension of the parsed source file? --> 
static VALUE
ossl_cipher_update(int argc, VALUE *argv, VALUE self)
{
    EVP_CIPHER_CTX *ctx;
    unsigned char *in;
    int in_len, out_len;
    VALUE data, str;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;data, &amp;str);

    StringValue(data);
    in = (unsigned char *)RSTRING_PTR(data);
    if ((in_len = RSTRING_LEN(data)) == 0)
        rb_raise(rb_eArgError, &quot;data must not be empty&quot;);
    GetCipher(self, ctx);
    out_len = in_len+EVP_CIPHER_CTX_block_size(ctx);

    if (NIL_P(str)) {
        str = rb_str_new(0, out_len);
    } else {
        StringValue(str);
        rb_str_resize(str, out_len);
    }

    if (!EVP_CipherUpdate(ctx, (unsigned char *)RSTRING_PTR(str), &amp;out_len, in, in_len))
        ossl_raise(eCipherError, NULL);
    assert(out_len &lt; RSTRING_LEN(str));
    rb_str_set_len(str, out_len);

    return str;
}</code>
</pre> 
            </div><!-- update-source -->
            
          </div>

          

          
        </div><!-- update-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->
<div id="disqus_thread" style='display:none'></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    // var disqus_shortname = 'rubydocbeta'; // required 
    var disqus_shortname = 'ruby-doc'; // required 
    
    var disqus_developer = true; // DEBUGGERY
    


    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink" style='display:none'>blog comments powered by <span class="logo-disqus">Disqus</span></a>

<div class='grids wrapper' id="footer">
  <p><small>This page was generated for Ruby 1.9.2</small></p> 
  
   <p> <a href="http://www.ruby-doc.org">Ruby-doc.org</a> is a service of <a href="http://www.jamesbritt.com">James Britt</a> and <a href="http://www.neurogami.com">Neurogami</a>, an <a href="http://www.neurogami.com"> avant garage application development company in Scottsdale, AZ</a>.  </p>
 
    <p><small>Generated with the <a href="http://neurogami.com/code/">Rubydoc Rdoc Generator</a> 0.9.4</small>.</p>
  </div>

</div>

<script type="text/javascript">
var _uacct = "UA-335317-2";
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{ 
var pageTracker = _gat._getTracker(_uacct);
pageTracker._trackPageview();
} catch(err) {} 
</script>
</body>
</html>

